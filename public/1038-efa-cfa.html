<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-01-13">
<meta name="description" content="使用 psych 和 lavaan 包进行 EFA 和 CFA，包括因子数确定、模型拟合与结果解读。">

<title>探索性与验证性因子分析完全指南 – R 语言学习笔记</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-374967827064a263f620006ef06629b3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R 语言学习笔记</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">主页</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-包" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">实用 R 包</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-包">    
        <li>
    <a class="dropdown-item" href="./sections/packages.html#表格制作">
 <span class="dropdown-text">📊 表格制作</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/packages.html#数据处理">
 <span class="dropdown-text">🔄 数据处理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/packages.html#模型整理">
 <span class="dropdown-text">📈 模型整理</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">可视化教程</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#图形基础">
 <span class="dropdown-text">🏗️ 图形基础</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#图形组合">
 <span class="dropdown-text">🔀 图形组合</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#统计图表">
 <span class="dropdown-text">📊 统计图表</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#专题图类">
 <span class="dropdown-text">🗺️ 专题图类</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#进阶美化">
 <span class="dropdown-text">✨ 进阶美化</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-语言方法" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">R 语言方法</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-语言方法">    
        <li>
    <a class="dropdown-item" href="./sections/methods.html#回归分析">
 <span class="dropdown-text">🔢 回归分析</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/methods.html#生存分析">
 <span class="dropdown-text">⏱️ 生存分析</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/methods.html#因果推断">
 <span class="dropdown-text">🎯 因果推断</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/methods.html#高级建模">
 <span class="dropdown-text">📐 高级建模</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/methods.html#机器学习">
 <span class="dropdown-text">🤖 机器学习</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/methods.html#数据预处理">
 <span class="dropdown-text">📋 数据预处理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/methods.html#综述方法">
 <span class="dropdown-text">📚 综述方法</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/methods.html#特殊方法">
 <span class="dropdown-text">🔬 特殊方法</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">实用操作</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--1">    
        <li>
    <a class="dropdown-item" href="./sections/operation.html#数据输入输出">
 <span class="dropdown-text">📥 数据输入输出</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#文档写作">
 <span class="dropdown-text">📝 文档写作</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#开发环境">
 <span class="dropdown-text">💻 开发环境</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KangWang42/R_note_for_Epidemiology"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">R 语言方法</li><li class="breadcrumb-item"><a href="./1024-multilevel.html">📐 高级建模</a></li><li class="breadcrumb-item"><a href="./1038-efa-cfa.html">因子分析 (EFA/CFA)</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">实用 R 包</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 表格制作</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1011-rpac_brucer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">bruceR - 统计分析工具</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1012-comparegroups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">compareGroups - 描述性表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1013-scitb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scitb - 快速基线表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1053-gtsummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gtsummary - 发表级表格</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">🔄 数据处理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1014-purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">purrr - 函数式编程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1014-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">future - 并行计算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1045-rstatix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rstatix - 管道式统计</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">📈 模型整理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1043-broom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">broom - 模型整理</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">可视化教程</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">🏗️ 图形基础</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2032-ggplot2-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2 可视化入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2033-ggplot2-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2 样式设置详解</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2011-viscolor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">配色方案</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2013-legend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">图例自定义</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">🔀 图形组合</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2012-patchwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">patchwork - 图片拼接</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2021-cowplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">cowplot - 图形组合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2031-bindcomplex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">复杂组合图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 统计图表</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2025-bindboxplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">箱线图与小提琴图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2026-bindscatterplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">散点图与趋势线</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2027-bindhistogram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">直方图与密度图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2028-bindbarchart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">柱状图与饼图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2029-bindlineplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">折线图与时间序列</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2030-bindareaplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">面积图与堆叠图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">🗺️ 专题图类</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2015-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">地图绑制</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2014-sankey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">桑基图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2016-forestplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">森林图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2020-heatmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">热图绑制完全指南</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2024-venn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">韦恩图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2023-radar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">雷达图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">✨ 进阶美化</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2017-ggtext.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggtext - 中英文字体混合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2018-tidyplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidyplots - 极简可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2022-ggally.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GGally - 可视化扩展</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2019-dualaxis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双坐标轴</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2034-ggguides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggguides - 图例简化</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true">
 <span class="menu-text">R 语言方法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">🔢 回归分析</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1019-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic 回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1021-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多元线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1026-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson/负二项回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1036-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">方差分析 (ANOVA)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">⏱️ 生存分析</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1020-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">生存分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1050-competing-risks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">竞争风险分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1027-rcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">限制性立方样条 (RCS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1017-timeseries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时间序列分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1055-tx-effects-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">治疗效果分析 (TxEffects)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">🎯 因果推断</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1018-psm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">倾向性得分匹配</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1028-did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双重差分法 (DiD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1023-mediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">中介效应分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1054-subgroup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">亚组分析与交互作用</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true">
 <span class="menu-text">📐 高级建模</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1024-multilevel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多水平模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1025-gam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">广义加性模型 (GAM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1032-sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">结构方程模型 (SEM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1031-lca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">潜类别分析 (LCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1039-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">主成分分析 (PCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1038-efa-cfa.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">因子分析 (EFA/CFA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1037-plspm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PLS-PM 路径模型</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">🤖 机器学习</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1016-mlr3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mlr3 机器学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1042-tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidymodels 机器学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1044-lstm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LSTM 深度学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1052-bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bootstrap与置换检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1051-bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">贝叶斯统计入门</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false">
 <span class="menu-text">📋 数据预处理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1046-missing-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">缺失值处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1047-roc-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROC 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1048-power-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">样本量计算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1049-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">探索性数据分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false">
 <span class="menu-text">📚 综述方法</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1022-meta-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meta 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1041-network-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网状 Meta 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1029-umbrella-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">伞状综述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1040-scoping-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">范围综述</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false">
 <span class="menu-text">🔬 特殊方法</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1015-health-economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">卫生经济学分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1030-qualitative-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">质性研究与文本挖掘</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1033-dlnm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">分布滞后非线性模型 (DLNM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1034-nvmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">变分模态分解 (VMD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1035-fft-nvmd-gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FFT + VMD + GMM</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="true">
 <span class="menu-text">实用操作</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false">
 <span class="menu-text">📥 数据输入输出</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3001-imports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数据导入导出</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3002-datatable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">data.table 完全指南</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3003-dplyr-tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">dplyr/tidyr 数据处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3004-web-scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网络爬虫入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3005-pdf-reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PDF文件读取</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="false">
 <span class="menu-text">📝 文档写作</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-22" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMarkdown 入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012-quarto-vs-rmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto vs RMarkdown</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false">
 <span class="menu-text">💻 开发环境</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-23" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013-positron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positron IDE 教程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4001-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shiny Web 应用</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#简介" id="toc-简介" class="nav-link active" data-scroll-target="#简介">简介</a>
  <ul class="collapse">
  <li><a href="#efa-vs-cfa" id="toc-efa-vs-cfa" class="nav-link" data-scroll-target="#efa-vs-cfa">EFA vs CFA</a></li>
  <li><a href="#分析流程" id="toc-分析流程" class="nav-link" data-scroll-target="#分析流程">分析流程</a></li>
  </ul></li>
  <li><a href="#安装与加载" id="toc-安装与加载" class="nav-link" data-scroll-target="#安装与加载">安装与加载</a></li>
  <li><a href="#示例数据" id="toc-示例数据" class="nav-link" data-scroll-target="#示例数据">示例数据</a></li>
  <li><a href="#数据预处理" id="toc-数据预处理" class="nav-link" data-scroll-target="#数据预处理">数据预处理</a>
  <ul class="collapse">
  <li><a href="#缺失值处理" id="toc-缺失值处理" class="nav-link" data-scroll-target="#缺失值处理">缺失值处理</a></li>
  <li><a href="#描述统计" id="toc-描述统计" class="nav-link" data-scroll-target="#描述统计">描述统计</a></li>
  </ul></li>
  <li><a href="#探索性因子分析-efa" id="toc-探索性因子分析-efa" class="nav-link" data-scroll-target="#探索性因子分析-efa">探索性因子分析 (EFA)</a></li>
  <li><a href="#适用性检验" id="toc-适用性检验" class="nav-link" data-scroll-target="#适用性检验">适用性检验</a>
  <ul class="collapse">
  <li><a href="#kmo-检验" id="toc-kmo-检验" class="nav-link" data-scroll-target="#kmo-检验">KMO 检验</a></li>
  <li><a href="#bartlett-球形检验" id="toc-bartlett-球形检验" class="nav-link" data-scroll-target="#bartlett-球形检验">Bartlett 球形检验</a></li>
  </ul></li>
  <li><a href="#因子数确定" id="toc-因子数确定" class="nav-link" data-scroll-target="#因子数确定">因子数确定</a>
  <ul class="collapse">
  <li><a href="#方法1特征值-1-准则-kaiser-准则" id="toc-方法1特征值-1-准则-kaiser-准则" class="nav-link" data-scroll-target="#方法1特征值-1-准则-kaiser-准则">方法1：特征值 &gt; 1 准则 (Kaiser 准则)</a></li>
  <li><a href="#方法2碎石图-scree-plot" id="toc-方法2碎石图-scree-plot" class="nav-link" data-scroll-target="#方法2碎石图-scree-plot">方法2：碎石图 (Scree Plot)</a></li>
  <li><a href="#方法3平行分析-推荐" id="toc-方法3平行分析-推荐" class="nav-link" data-scroll-target="#方法3平行分析-推荐">方法3：平行分析 (推荐)</a></li>
  <li><a href="#方法4map-检验" id="toc-方法4map-检验" class="nav-link" data-scroll-target="#方法4map-检验">方法4：MAP 检验</a></li>
  </ul></li>
  <li><a href="#因子提取" id="toc-因子提取" class="nav-link" data-scroll-target="#因子提取">因子提取</a>
  <ul class="collapse">
  <li><a href="#主轴因子法-推荐" id="toc-主轴因子法-推荐" class="nav-link" data-scroll-target="#主轴因子法-推荐">主轴因子法 (推荐)</a></li>
  <li><a href="#最大似然法" id="toc-最大似然法" class="nav-link" data-scroll-target="#最大似然法">最大似然法</a></li>
  </ul></li>
  <li><a href="#旋转方法" id="toc-旋转方法" class="nav-link" data-scroll-target="#旋转方法">旋转方法</a>
  <ul class="collapse">
  <li><a href="#正交旋转-vs-斜交旋转" id="toc-正交旋转-vs-斜交旋转" class="nav-link" data-scroll-target="#正交旋转-vs-斜交旋转">正交旋转 vs 斜交旋转</a></li>
  </ul></li>
  <li><a href="#结果解读" id="toc-结果解读" class="nav-link" data-scroll-target="#结果解读">结果解读</a>
  <ul class="collapse">
  <li><a href="#因子载荷矩阵" id="toc-因子载荷矩阵" class="nav-link" data-scroll-target="#因子载荷矩阵">因子载荷矩阵</a></li>
  <li><a href="#共同度" id="toc-共同度" class="nav-link" data-scroll-target="#共同度">共同度</a></li>
  <li><a href="#因子得分" id="toc-因子得分" class="nav-link" data-scroll-target="#因子得分">因子得分</a></li>
  </ul></li>
  <li><a href="#efa-可视化" id="toc-efa-可视化" class="nav-link" data-scroll-target="#efa-可视化">EFA 可视化</a>
  <ul class="collapse">
  <li><a href="#因子载荷图" id="toc-因子载荷图" class="nav-link" data-scroll-target="#因子载荷图">因子载荷图</a></li>
  <li><a href="#热图展示" id="toc-热图展示" class="nav-link" data-scroll-target="#热图展示">热图展示</a></li>
  </ul></li>
  <li><a href="#验证性因子分析-cfa" id="toc-验证性因子分析-cfa" class="nav-link" data-scroll-target="#验证性因子分析-cfa">验证性因子分析 (CFA)</a></li>
  <li><a href="#模型设定" id="toc-模型设定" class="nav-link" data-scroll-target="#模型设定">模型设定</a></li>
  <li><a href="#模型拟合" id="toc-模型拟合" class="nav-link" data-scroll-target="#模型拟合">模型拟合</a></li>
  <li><a href="#拟合指数解读" id="toc-拟合指数解读" class="nav-link" data-scroll-target="#拟合指数解读">拟合指数解读</a>
  <ul class="collapse">
  <li><a href="#提取拟合指数" id="toc-提取拟合指数" class="nav-link" data-scroll-target="#提取拟合指数">提取拟合指数</a></li>
  <li><a href="#拟合标准" id="toc-拟合标准" class="nav-link" data-scroll-target="#拟合标准">拟合标准</a></li>
  </ul></li>
  <li><a href="#因子载荷" id="toc-因子载荷" class="nav-link" data-scroll-target="#因子载荷">因子载荷</a></li>
  <li><a href="#信效度评估" id="toc-信效度评估" class="nav-link" data-scroll-target="#信效度评估">信效度评估</a>
  <ul class="collapse">
  <li><a href="#组合信度-cr" id="toc-组合信度-cr" class="nav-link" data-scroll-target="#组合信度-cr">组合信度 (CR)</a></li>
  <li><a href="#平均方差萃取量-ave" id="toc-平均方差萃取量-ave" class="nav-link" data-scroll-target="#平均方差萃取量-ave">平均方差萃取量 (AVE)</a></li>
  <li><a href="#因子相关矩阵" id="toc-因子相关矩阵" class="nav-link" data-scroll-target="#因子相关矩阵">因子相关矩阵</a></li>
  <li><a href="#区分效度检验" id="toc-区分效度检验" class="nav-link" data-scroll-target="#区分效度检验">区分效度检验</a></li>
  </ul></li>
  <li><a href="#cfa-可视化" id="toc-cfa-可视化" class="nav-link" data-scroll-target="#cfa-可视化">CFA 可视化</a>
  <ul class="collapse">
  <li><a href="#路径图" id="toc-路径图" class="nav-link" data-scroll-target="#路径图">路径图</a></li>
  </ul></li>
  <li><a href="#模型修正" id="toc-模型修正" class="nav-link" data-scroll-target="#模型修正">模型修正</a>
  <ul class="collapse">
  <li><a href="#修正指数" id="toc-修正指数" class="nav-link" data-scroll-target="#修正指数">修正指数</a></li>
  <li><a href="#添加残差相关" id="toc-添加残差相关" class="nav-link" data-scroll-target="#添加残差相关">添加残差相关</a></li>
  <li><a href="#模型比较" id="toc-模型比较" class="nav-link" data-scroll-target="#模型比较">模型比较</a></li>
  </ul></li>
  <li><a href="#多组-cfa" id="toc-多组-cfa" class="nav-link" data-scroll-target="#多组-cfa">多组 CFA</a></li>
  <li><a href="#报告模板" id="toc-报告模板" class="nav-link" data-scroll-target="#报告模板">报告模板</a></li>
  <li><a href="#efa-vs-cfa-选择指南" id="toc-efa-vs-cfa-选择指南" class="nav-link" data-scroll-target="#efa-vs-cfa-选择指南">EFA vs CFA 选择指南</a></li>
  <li><a href="#总结" id="toc-总结" class="nav-link" data-scroll-target="#总结">总结</a></li>
  <li><a href="#参考文献" id="toc-参考文献" class="nav-link" data-scroll-target="#参考文献">参考文献</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">R 语言方法</li><li class="breadcrumb-item"><a href="./1024-multilevel.html">📐 高级建模</a></li><li class="breadcrumb-item"><a href="./1038-efa-cfa.html">因子分析 (EFA/CFA)</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">探索性与验证性因子分析完全指南</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R包</div>
    <div class="quarto-category">统计模型</div>
    <div class="quarto-category">因子分析</div>
  </div>
  </div>

<div>
  <div class="description">
    使用 psych 和 lavaan 包进行 EFA 和 CFA，包括因子数确定、模型拟合与结果解读。
  </div>
</div>


<div class="quarto-title-meta column-body">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 13, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="简介" class="level2">
<h2 class="anchored" data-anchor-id="简介">简介</h2>
<p>因子分析是心理学、教育学和社会科学中最常用的统计方法之一，用于揭示观测变量背后的潜在结构。</p>
<section id="efa-vs-cfa" class="level3">
<h3 class="anchored" data-anchor-id="efa-vs-cfa">EFA vs CFA</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>特性</th>
<th>EFA (探索性因子分析)</th>
<th>CFA (验证性因子分析)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>目的</strong></td>
<td>探索潜在结构</td>
<td>验证理论假设</td>
</tr>
<tr class="even">
<td><strong>假设</strong></td>
<td>不预设因子结构</td>
<td>预设因子结构</td>
</tr>
<tr class="odd">
<td><strong>适用阶段</strong></td>
<td>量表开发初期</td>
<td>量表验证、理论检验</td>
</tr>
<tr class="even">
<td><strong>因子数</strong></td>
<td>数据驱动确定</td>
<td>理论预先确定</td>
</tr>
<tr class="odd">
<td><strong>交叉载荷</strong></td>
<td>允许所有载荷自由估计</td>
<td>限制交叉载荷为0</td>
</tr>
<tr class="even">
<td><strong>拟合指数</strong></td>
<td>较少关注</td>
<td>核心评估指标</td>
</tr>
</tbody>
</table>
</section>
<section id="分析流程" class="level3">
<h3 class="anchored" data-anchor-id="分析流程">分析流程</h3>
<pre class="mermaid"><code>graph LR
    A[理论构建] --&gt; B[量表开发]
    B --&gt; C[样本1: EFA]
    C --&gt; D[确定因子结构]
    D --&gt; E[样本2: CFA]
    E --&gt; F[验证因子结构]
    F --&gt; G[修正/发表]</code></pre>
</section>
</section>
<section id="安装与加载" class="level2">
<h2 class="anchored" data-anchor-id="安装与加载">安装与加载</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("psych")      # EFA</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("lavaan")     # CFA</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("semPlot")    # 路径图</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="示例数据" class="level2">
<h2 class="anchored" data-anchor-id="示例数据">示例数据</h2>
<p>使用 <code>psych</code> 包自带的 <code>bfi</code> 数据集（大五人格问卷）。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(bfi)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 选取 25 个题目（5 个因子，每个 5 题）</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>items <span class="ot">&lt;-</span> bfi[, <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(items)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4
61617  2  4  3  4  4  2  3  3  4  4  3  3  3  4  4  3  4  2  2  3  3  6  3  4
61618  2  4  5  2  5  5  4  4  3  4  1  1  6  4  3  3  3  3  5  5  4  2  4  3
61620  5  4  5  4  4  4  5  4  2  5  2  4  4  4  5  4  5  4  2  3  4  2  5  5
61621  4  4  6  5  5  4  4  3  5  5  5  3  4  4  4  2  5  2  4  1  3  3  4  3
61622  2  3  3  4  5  4  4  5  3  2  2  2  5  4  5  2  3  4  4  3  3  3  4  3
61623  6  6  5  6  5  6  6  6  1  3  2  1  6  5  6  3  5  2  2  3  4  3  5  6
      O5
61617  3
61618  3
61620  2
61621  5
61622  3
61623  1</code></pre>
</div>
</div>
<p><strong>变量说明</strong>： - A1-A5: 宜人性 (Agreeableness) - C1-C5: 尽责性 (Conscientiousness) - E1-E5: 外向性 (Extraversion) - N1-N5: 神经质 (Neuroticism) - O1-O5: 开放性 (Openness)</p>
</section>
<section id="数据预处理" class="level2">
<h2 class="anchored" data-anchor-id="数据预处理">数据预处理</h2>
<section id="缺失值处理" class="level3">
<h3 class="anchored" data-anchor-id="缺失值处理">缺失值处理</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查缺失值</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(items))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A1 A2 A3 A4 A5 C1 C2 C3 C4 C5 E1 E2 E3 E4 E5 N1 N2 N3 N4 N5 O1 O2 O3 O4 O5 
16 27 26 19 16 21 24 20 26 16 23 16 25  9 21 22 21 11 36 29 22  0 28 14 20 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 删除含缺失的行（简单处理）</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>items_complete <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(items)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"完整案例数:"</span>, <span class="fu">nrow</span>(items_complete), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>完整案例数: 2436 </code></pre>
</div>
</div>
</section>
<section id="描述统计" class="level3">
<h3 class="anchored" data-anchor-id="描述统计">描述统计</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(items_complete)[, <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      n mean   sd min max
A1 2436 2.41 1.41   1   6
A2 2436 4.80 1.18   1   6
A3 2436 4.60 1.31   1   6
A4 2436 4.69 1.49   1   6
A5 2436 4.54 1.27   1   6
C1 2436 4.53 1.24   1   6
C2 2436 4.37 1.32   1   6
C3 2436 4.30 1.29   1   6
C4 2436 2.55 1.38   1   6
C5 2436 3.31 1.63   1   6
E1 2436 2.98 1.63   1   6
E2 2436 3.15 1.61   1   6
E3 2436 3.98 1.35   1   6
E4 2436 4.41 1.47   1   6
E5 2436 4.39 1.34   1   6
N1 2436 2.94 1.58   1   6
N2 2436 3.52 1.53   1   6
N3 2436 3.22 1.59   1   6
N4 2436 3.20 1.57   1   6
N5 2436 2.97 1.62   1   6
O1 2436 4.81 1.13   1   6
O2 2436 2.68 1.55   1   6
O3 2436 4.45 1.21   1   6
O4 2436 4.93 1.19   1   6
O5 2436 2.47 1.32   1   6</code></pre>
</div>
</div>
<hr>
<hr>
</section>
</section>
<section id="探索性因子分析-efa" class="level2">
<h2 class="anchored" data-anchor-id="探索性因子分析-efa">探索性因子分析 (EFA)</h2>
</section>
<section id="适用性检验" class="level2">
<h2 class="anchored" data-anchor-id="适用性检验">适用性检验</h2>
<section id="kmo-检验" class="level3">
<h3 class="anchored" data-anchor-id="kmo-检验">KMO 检验</h3>
<p>Kaiser-Meyer-Olkin 检验评估数据是否适合因子分析。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(items_complete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = items_complete)
Overall MSA =  0.85
MSA for each item = 
  A1   A2   A3   A4   A5   C1   C2   C3   C4   C5   E1   E2   E3   E4   E5   N1 
0.75 0.84 0.87 0.88 0.90 0.84 0.80 0.85 0.83 0.86 0.84 0.88 0.90 0.88 0.89 0.78 
  N2   N3   N4   N5   O1   O2   O3   O4   O5 
0.78 0.86 0.89 0.86 0.86 0.78 0.84 0.77 0.76 </code></pre>
</div>
</div>
<p><strong>KMO 解释</strong>： - &gt; 0.9：极好 - 0.8-0.9：好 - 0.7-0.8：中等 - 0.6-0.7：一般 - &lt; 0.6：不适合因子分析</p>
</section>
<section id="bartlett-球形检验" class="level3">
<h3 class="anchored" data-anchor-id="bartlett-球形检验">Bartlett 球形检验</h3>
<p>检验相关矩阵是否为单位矩阵。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(items_complete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 18146.07

$p.value
[1] 0

$df
[1] 300</code></pre>
</div>
</div>
<p><strong>解释</strong>：p &lt; 0.05 表示相关矩阵不是单位矩阵，适合因子分析。</p>
</section>
</section>
<section id="因子数确定" class="level2">
<h2 class="anchored" data-anchor-id="因子数确定">因子数确定</h2>
<section id="方法1特征值-1-准则-kaiser-准则" class="level3">
<h3 class="anchored" data-anchor-id="方法1特征值-1-准则-kaiser-准则">方法1：特征值 &gt; 1 准则 (Kaiser 准则)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算相关矩阵</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(items_complete)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 特征值分解</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>eigen_values <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cor_matrix)<span class="sc">$</span>values</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(eigen_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 5.1343112 2.7518867 2.1427020 1.8523276 1.5481628 1.0735825 0.8395389
 [8] 0.7992062 0.7189892 0.6880888 0.6763734 0.6517998 0.6232530 0.5965628
[15] 0.5630908 0.5433053 0.5145175 0.4945031 0.4826395 0.4489210 0.4233661
[22] 0.4006715 0.3878045 0.3818568 0.2625390</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 特征值 &gt; 1 的因子数</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(eigen_values <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
</section>
<section id="方法2碎石图-scree-plot" class="level3">
<h3 class="anchored" data-anchor-id="方法2碎石图-scree-plot">方法2：碎石图 (Scree Plot)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scree</span>(items_complete, <span class="at">factors =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1038-efa-cfa_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="1200"></p>
</figure>
</div>
</div>
</div>
<p><strong>解释</strong>：找到”拐点”，即曲线变平的位置。</p>
</section>
<section id="方法3平行分析-推荐" class="level3">
<h3 class="anchored" data-anchor-id="方法3平行分析-推荐">方法3：平行分析 (推荐)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(items_complete, <span class="at">fa =</span> <span class="st">"fa"</span>, <span class="at">n.iter =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1038-efa-cfa_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="1200"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  6  and the number of components =  NA </code></pre>
</div>
</div>
<p><strong>解释</strong>：实际特征值超过随机模拟特征值的因子数。</p>
</section>
<section id="方法4map-检验" class="level3">
<h3 class="anchored" data-anchor-id="方法4map-检验">方法4：MAP 检验</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VSS</span>(items_complete, <span class="at">n =</span> <span class="dv">8</span>, <span class="at">rotate =</span> <span class="st">"promax"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1038-efa-cfa_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="1200"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Very Simple Structure
Call: vss(x = x, n = n, rotate = rotate, diagonal = diagonal, fm = fm, 
    n.obs = n.obs, plot = plot, title = title, use = use, cor = cor)
VSS complexity 1 achieves a maximimum of 0.6  with  4  factors
VSS complexity 2 achieves a maximimum of 0.7  with  5  factors

The Velicer MAP achieves a minimum of 0.01  with  5  factors 
BIC achieves a minimum of  -550.01  with  8  factors
Sample Size adjusted BIC achieves a minimum of  -143.33  with  8  factors

Statistics by number of factors 
  vss1 vss2   map dof chisq     prob sqresid  fit RMSEA  BIC SABIC complex
1 0.50 0.00 0.025 275 10656  0.0e+00      26 0.50 0.124 8512  9386     1.0
2 0.55 0.58 0.019 251  6669  0.0e+00      22 0.58 0.102 4712  5509     1.2
3 0.57 0.65 0.018 228  4585  0.0e+00      18 0.65 0.089 2807  3531     1.2
4 0.60 0.69 0.016 206  3033  0.0e+00      16 0.69 0.075 1426  2081     1.3
5 0.54 0.70 0.015 185  1539 8.6e-212      15 0.71 0.055   96   684     1.4
6 0.53 0.61 0.016 165   917 1.6e-104      16 0.69 0.043 -370   154     1.7
7 0.51 0.59 0.019 146   631  1.8e-61      17 0.68 0.037 -508   -44     1.7
8 0.47 0.61 0.022 128   448  4.0e-37      17 0.68 0.032 -550  -143     1.7
  eChisq  SRMR eCRMS  eBIC
1  21181 0.120 0.126 19037
2  11015 0.087 0.095  9058
3   6268 0.065 0.075  4490
4   3129 0.046 0.056  1523
5   1132 0.028 0.035  -311
6    553 0.019 0.026  -734
7    372 0.016 0.023  -767
8    238 0.013 0.020  -760</code></pre>
</div>
</div>
<p><strong>综合判断</strong>：多种方法的结果应该综合考虑，选择最合理的因子数。</p>
</section>
</section>
<section id="因子提取" class="level2">
<h2 class="anchored" data-anchor-id="因子提取">因子提取</h2>
<section id="主轴因子法-推荐" class="level3">
<h3 class="anchored" data-anchor-id="主轴因子法-推荐">主轴因子法 (推荐)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取 5 个因子，使用 promax 斜交旋转</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fa_result <span class="ot">&lt;-</span> <span class="fu">fa</span>(items_complete,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">nfactors =</span> <span class="dv">5</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">rotate =</span> <span class="st">"promax"</span>, <span class="co"># 斜交旋转</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fm =</span> <span class="st">"pa"</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>) <span class="co"># 主轴因子法</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_result, <span class="at">cut =</span> <span class="fl">0.3</span>) <span class="co"># 只显示 &gt; 0.3 的载荷</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  pa
Call: fa(r = items_complete, nfactors = 5, rotate = "promax", fm = "pa")
Standardized loadings (pattern matrix) based upon correlation matrix
     PA2   PA1   PA3   PA5   PA4   h2   u2 com
A1                   -0.46       0.20 0.80 1.4
A2                    0.61       0.46 0.54 1.1
A3                    0.62       0.54 0.46 1.3
A4                    0.41       0.30 0.70 2.0
A5        0.33        0.49       0.47 0.53 1.8
C1              0.57             0.35 0.65 1.2
C2              0.70             0.45 0.55 1.2
C3              0.60             0.32 0.68 1.1
C4             -0.65             0.48 0.52 1.2
C5             -0.56             0.44 0.56 1.4
E1       -0.64                   0.35 0.65 1.1
E2       -0.71                   0.55 0.45 1.1
E3        0.55                   0.44 0.56 1.6
E4        0.66                   0.54 0.46 1.3
E5        0.50                   0.41 0.59 1.8
N1  0.84                         0.68 0.32 1.3
N2  0.79                         0.61 0.39 1.2
N3  0.74                         0.54 0.46 1.0
N4  0.53 -0.31                   0.51 0.49 1.8
N5  0.53                         0.35 0.65 1.5
O1                          0.49 0.32 0.68 1.3
O2                         -0.48 0.27 0.73 1.5
O3                          0.58 0.47 0.53 1.5
O4                          0.37 0.25 0.75 2.7
O5                         -0.54 0.30 0.70 1.1

                       PA2  PA1  PA3  PA5  PA4
SS loadings           2.69 2.59 2.02 1.79 1.50
Proportion Var        0.11 0.10 0.08 0.07 0.06
Cumulative Var        0.11 0.21 0.29 0.36 0.42
Proportion Explained  0.25 0.24 0.19 0.17 0.14
Cumulative Proportion 0.25 0.50 0.69 0.86 1.00

 With factor correlations of 
      PA2   PA1   PA3   PA5  PA4
PA2  1.00 -0.26 -0.22 -0.01 0.04
PA1 -0.26  1.00  0.40  0.35 0.14
PA3 -0.22  0.40  1.00  0.24 0.19
PA5 -0.01  0.35  0.24  1.00 0.16
PA4  0.04  0.14  0.19  0.16 1.00

Mean item complexity =  1.4
Test of the hypothesis that 5 factors are sufficient.

df null model =  300  with the objective function =  7.48 with Chi Square =  18146.07
df of  the model are 185  and the objective function was  0.64 

The root mean square of the residuals (RMSR) is  0.03 
The df corrected root mean square of the residuals is  0.04 

The harmonic n.obs is  2436 with the empirical chi square  1131.91  with prob &lt;  1.1e-135 
The total n.obs was  2436  with Likelihood Chi Square =  1538.69  with prob &lt;  8e-212 

Tucker Lewis Index of factoring reliability =  0.877
RMSEA index =  0.055  and the 90 % confidence intervals are  0.052 0.057
BIC =  96.03
Fit based upon off diagonal values = 0.98
Measures of factor score adequacy             
                                                   PA2  PA1  PA3  PA5  PA4
Correlation of (regression) scores with factors   0.93 0.91 0.89 0.87 0.84
Multiple R square of scores with factors          0.86 0.83 0.79 0.75 0.70
Minimum correlation of possible factor scores     0.72 0.66 0.58 0.51 0.40</code></pre>
</div>
</div>
</section>
<section id="最大似然法" class="level3">
<h3 class="anchored" data-anchor-id="最大似然法">最大似然法</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fa_ml <span class="ot">&lt;-</span> <span class="fu">fa</span>(items_complete,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">nfactors =</span> <span class="dv">5</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">rotate =</span> <span class="st">"promax"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fm =</span> <span class="st">"ml"</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>) <span class="co"># 最大似然法</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较拟合</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"PA 法 RMSEA:"</span>, fa_result<span class="sc">$</span>RMSEA[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PA 法 RMSEA: 0.05480526 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ML 法 RMSEA:"</span>, fa_ml<span class="sc">$</span>RMSEA[<span class="dv">1</span>], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ML 法 RMSEA: 0.05382273 </code></pre>
</div>
</div>
</section>
</section>
<section id="旋转方法" class="level2">
<h2 class="anchored" data-anchor-id="旋转方法">旋转方法</h2>
<section id="正交旋转-vs-斜交旋转" class="level3">
<h3 class="anchored" data-anchor-id="正交旋转-vs-斜交旋转">正交旋转 vs 斜交旋转</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 正交旋转（因子不相关）</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>fa_varimax <span class="ot">&lt;-</span> <span class="fu">fa</span>(items_complete, <span class="at">nfactors =</span> <span class="dv">5</span>, <span class="at">rotate =</span> <span class="st">"varimax"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 斜交旋转（因子可相关）</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>fa_promax <span class="ot">&lt;-</span> <span class="fu">fa</span>(items_complete, <span class="at">nfactors =</span> <span class="dv">5</span>, <span class="at">rotate =</span> <span class="st">"promax"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较因子相关</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Varimax 因子相关:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Varimax 因子相关:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fa_varimax<span class="sc">$</span>Phi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Promax 因子相关:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Promax 因子相关:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(fa_promax<span class="sc">$</span>Phi, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       MR2    MR1    MR3    MR5   MR4
MR2  1.000 -0.256 -0.224 -0.013 0.040
MR1 -0.256  1.000  0.399  0.345 0.142
MR3 -0.224  0.399  1.000  0.236 0.192
MR5 -0.013  0.345  0.236  1.000 0.155
MR4  0.040  0.142  0.192  0.155 1.000</code></pre>
</div>
</div>
<p><strong>选择建议</strong>： - 理论上因子应相关 → 斜交旋转 (promax, oblimin) - 需要因子正交 → 正交旋转 (varimax)</p>
</section>
</section>
<section id="结果解读" class="level2">
<h2 class="anchored" data-anchor-id="结果解读">结果解读</h2>
<section id="因子载荷矩阵" class="level3">
<h3 class="anchored" data-anchor-id="因子载荷矩阵">因子载荷矩阵</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看因子载荷</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> fa_result<span class="sc">$</span>loadings</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(loadings, <span class="at">cut =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
   PA2    PA1    PA3    PA5    PA4   
A1                      -0.463       
A2                       0.611       
A3                       0.620       
A4                       0.411       
A5         0.332         0.489       
C1                0.567              
C2                0.697              
C3                0.597              
C4               -0.652              
C5               -0.561              
E1        -0.636                     
E2        -0.711                     
E3         0.545                     
E4         0.660                     
E5         0.498                     
N1  0.835                            
N2  0.791                            
N3  0.741                            
N4  0.533 -0.311                     
N5  0.529                            
O1                              0.491
O2                             -0.484
O3                              0.576
O4                              0.370
O5                             -0.543

                 PA2   PA1   PA3   PA5   PA4
SS loadings    2.704 2.486 2.050 1.638 1.461
Proportion Var 0.108 0.099 0.082 0.066 0.058
Cumulative Var 0.108 0.208 0.290 0.355 0.414</code></pre>
</div>
</div>
<p><strong>载荷解释</strong>： - &gt; 0.7：优秀 - 0.6-0.7：良好 - 0.4-0.6：可接受 - &lt; 0.4：考虑删除</p>
</section>
<section id="共同度" class="level3">
<h3 class="anchored" data-anchor-id="共同度">共同度</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 每个变量被因子解释的方差比例</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>fa_result<span class="sc">$</span>communalities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.59006</code></pre>
</div>
</div>
<p><strong>标准</strong>：共同度 &lt; 0.2 的变量考虑删除。</p>
</section>
<section id="因子得分" class="level3">
<h3 class="anchored" data-anchor-id="因子得分">因子得分</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算因子得分</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>factor_scores <span class="ot">&lt;-</span> <span class="fu">factor.scores</span>(items_complete, fa_result)<span class="sc">$</span>scores</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(factor_scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              PA2        PA1         PA3        PA5        PA4
61617 -0.43958636 -0.2227535 -1.46918220 -1.0398564 -1.9486251
61618  0.07605077  0.4354195 -0.62143534 -0.2315558 -0.3297932
61620  0.52227907  0.1737052 -0.03530488 -0.7979095  0.2324926
61621 -0.16388898 -0.1413499 -1.17247939 -0.1013337 -1.3034475
61622 -0.42091443  0.3272949 -0.09403904 -0.9823147 -0.8739858
61623  0.03826001  1.3614244  1.62152869  0.1130949  0.4775330</code></pre>
</div>
</div>
</section>
</section>
<section id="efa-可视化" class="level2">
<h2 class="anchored" data-anchor-id="efa-可视化">EFA 可视化</h2>
<section id="因子载荷图" class="level3">
<h3 class="anchored" data-anchor-id="因子载荷图">因子载荷图</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.diagram</span>(fa_result, <span class="at">simple =</span> <span class="cn">FALSE</span>, <span class="at">cut =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1038-efa-cfa_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="1200"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="热图展示" class="level3">
<h3 class="anchored" data-anchor-id="热图展示">热图展示</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取载荷矩阵</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>load_mat <span class="ot">&lt;-</span> <span class="fu">unclass</span>(fa_result<span class="sc">$</span>loadings)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 ggplot2 绘制</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>load_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(load_mat) <span class="sc">%&gt;%</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">rownames</span>(load_mat)) <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>item, <span class="at">names_to =</span> <span class="st">"Factor"</span>, <span class="at">values_to =</span> <span class="st">"Loading"</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(load_df, <span class="fu">aes</span>(<span class="at">x =</span> Factor, <span class="at">y =</span> item, <span class="at">fill =</span> Loading)) <span class="sc">+</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Loading, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">low =</span> <span class="st">"#457b9d"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"#e63946"</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"因子载荷热图"</span>) <span class="sc">+</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1038-efa-cfa_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="1200"></p>
</figure>
</div>
</div>
</div>
<hr>
<hr>
</section>
</section>
<section id="验证性因子分析-cfa" class="level2">
<h2 class="anchored" data-anchor-id="验证性因子分析-cfa">验证性因子分析 (CFA)</h2>
</section>
<section id="模型设定" class="level2">
<h2 class="anchored" data-anchor-id="模型设定">模型设定</h2>
<p>基于 EFA 结果或理论假设，设定 CFA 模型。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义 CFA 模型</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>cfa_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="st">  # 测量模型</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Agreeableness =~ A1 + A2 + A3 + A4 + A5</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="st">  Conscientiousness =~ C1 + C2 + C3 + C4 + C5</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="st">  Extraversion =~ E1 + E2 + E3 + E4 + E5</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Neuroticism =~ N1 + N2 + N3 + N4 + N5</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="st">  Openness =~ O1 + O2 + O3 + O4 + O5</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="模型拟合" class="level2">
<h2 class="anchored" data-anchor-id="模型拟合">模型拟合</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 拟合 CFA 模型</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>cfa_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_model, <span class="at">data =</span> items_complete)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看结果摘要</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cfa_fit, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-21 ended normally after 55 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        60

  Number of observations                          2436

Model Test User Model:
                                                      
  Test statistic                              4165.467
  Degrees of freedom                               265
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                             18222.116
  Degrees of freedom                               300
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.782
  Tucker-Lewis Index (TLI)                       0.754

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -99840.238
  Loglikelihood unrestricted model (H1)     -97757.504
                                                      
  Akaike (AIC)                              199800.476
  Bayesian (BIC)                            200148.363
  Sample-size adjusted Bayesian (SABIC)     199957.729

Root Mean Square Error of Approximation:

  RMSEA                                          0.078
  90 Percent confidence interval - lower         0.076
  90 Percent confidence interval - upper         0.080
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.037

Standardized Root Mean Square Residual:

  SRMR                                           0.075

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                       Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Agreeableness =~                                                          
    A1                    1.000                               0.484    0.344
    A2                   -1.579    0.108  -14.650    0.000   -0.764   -0.648
    A3                   -2.030    0.134  -15.093    0.000   -0.983   -0.749
    A4                   -1.564    0.115  -13.616    0.000   -0.757   -0.510
    A5                   -1.804    0.121  -14.852    0.000   -0.873   -0.687
  Conscientiousness =~                                                      
    C1                    1.000                               0.680    0.551
    C2                    1.148    0.057   20.152    0.000    0.781    0.592
    C3                    1.036    0.054   19.172    0.000    0.705    0.546
    C4                   -1.421    0.065  -21.924    0.000   -0.967   -0.702
    C5                   -1.489    0.072  -20.694    0.000   -1.012   -0.620
  Extraversion =~                                                           
    E1                    1.000                               0.920    0.564
    E2                    1.226    0.051   23.899    0.000    1.128    0.699
    E3                   -0.921    0.041  -22.431    0.000   -0.847   -0.627
    E4                   -1.121    0.047  -23.977    0.000   -1.031   -0.703
    E5                   -0.808    0.039  -20.648    0.000   -0.743   -0.553
  Neuroticism =~                                                            
    N1                    1.000                               1.300    0.825
    N2                    0.947    0.024   39.899    0.000    1.230    0.803
    N3                    0.884    0.025   35.919    0.000    1.149    0.721
    N4                    0.692    0.025   27.753    0.000    0.899    0.573
    N5                    0.628    0.026   24.027    0.000    0.816    0.503
  Openness =~                                                               
    O1                    1.000                               0.635    0.564
    O2                   -1.020    0.068  -14.962    0.000   -0.648   -0.418
    O3                    1.373    0.072   18.942    0.000    0.872    0.724
    O4                    0.437    0.048    9.160    0.000    0.277    0.233
    O5                   -0.960    0.060  -16.056    0.000   -0.610   -0.461

Covariances:
                       Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Agreeableness ~~                                                          
    Conscientisnss       -0.110    0.012   -9.254    0.000   -0.334   -0.334
    Extraversion          0.304    0.025   12.293    0.000    0.683    0.683
    Neuroticism           0.141    0.018    7.712    0.000    0.223    0.223
    Openness             -0.093    0.011   -8.446    0.000   -0.303   -0.303
  Conscientiousness ~~                                                      
    Extraversion         -0.224    0.020  -11.121    0.000   -0.357   -0.357
    Neuroticism          -0.250    0.025  -10.117    0.000   -0.283   -0.283
    Openness              0.130    0.014    9.190    0.000    0.301    0.301
  Extraversion ~~                                                           
    Neuroticism           0.292    0.032    9.131    0.000    0.244    0.244
    Openness             -0.265    0.021  -12.347    0.000   -0.453   -0.453
  Neuroticism ~~                                                            
    Openness             -0.093    0.022   -4.138    0.000   -0.112   -0.112

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .A1                1.745    0.052   33.725    0.000    1.745    0.882
   .A2                0.807    0.028   28.396    0.000    0.807    0.580
   .A3                0.754    0.032   23.339    0.000    0.754    0.438
   .A4                1.632    0.051   31.796    0.000    1.632    0.740
   .A5                0.852    0.032   26.800    0.000    0.852    0.528
   .C1                1.063    0.035   30.073    0.000    1.063    0.697
   .C2                1.130    0.039   28.890    0.000    1.130    0.650
   .C3                1.170    0.039   30.194    0.000    1.170    0.702
   .C4                0.960    0.040   24.016    0.000    0.960    0.507
   .C5                1.640    0.059   27.907    0.000    1.640    0.615
   .E1                1.814    0.058   31.047    0.000    1.814    0.682
   .E2                1.332    0.049   26.928    0.000    1.332    0.512
   .E3                1.108    0.038   29.522    0.000    1.108    0.607
   .E4                1.088    0.041   26.732    0.000    1.088    0.506
   .E5                1.251    0.040   31.258    0.000    1.251    0.694
   .N1                0.793    0.037   21.575    0.000    0.793    0.320
   .N2                0.836    0.036   23.458    0.000    0.836    0.356
   .N3                1.222    0.043   28.271    0.000    1.222    0.481
   .N4                1.654    0.052   31.977    0.000    1.654    0.672
   .N5                1.969    0.060   32.889    0.000    1.969    0.747
   .O1                0.865    0.032   27.216    0.000    0.865    0.682
   .O2                1.990    0.063   31.618    0.000    1.990    0.826
   .O3                0.691    0.039   17.717    0.000    0.691    0.476
   .O4                1.346    0.040   34.036    0.000    1.346    0.946
   .O5                1.380    0.045   30.662    0.000    1.380    0.788
    Agreeableness     0.234    0.030    7.839    0.000    1.000    1.000
    Conscientisnss    0.463    0.036   12.810    0.000    1.000    1.000
    Extraversion      0.846    0.062   13.693    0.000    1.000    1.000
    Neuroticism       1.689    0.073   23.034    0.000    1.000    1.000
    Openness          0.404    0.033   12.156    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="拟合指数解读" class="level2">
<h2 class="anchored" data-anchor-id="拟合指数解读">拟合指数解读</h2>
<section id="提取拟合指数" class="level3">
<h3 class="anchored" data-anchor-id="提取拟合指数">提取拟合指数</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取常用拟合指数</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>fit_indices <span class="ot">&lt;-</span> <span class="fu">fitMeasures</span>(cfa_fit, <span class="fu">c</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"pvalue"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"rmsea"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rmsea.ci.lower"</span>, <span class="st">"rmsea.ci.upper"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"srmr"</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(fit_indices, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         chisq             df         pvalue            cfi            tli 
      4165.467        265.000          0.000          0.782          0.754 
         rmsea rmsea.ci.lower rmsea.ci.upper           srmr 
         0.078          0.076          0.080          0.075 </code></pre>
</div>
</div>
</section>
<section id="拟合标准" class="level3">
<h3 class="anchored" data-anchor-id="拟合标准">拟合标准</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>指标</th>
<th>优秀</th>
<th>可接受</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>χ²/df</strong></td>
<td>&lt; 2</td>
<td>&lt; 3</td>
<td>卡方/自由度比</td>
</tr>
<tr class="even">
<td><strong>CFI</strong></td>
<td>&gt; 0.95</td>
<td>&gt; 0.90</td>
<td>比较拟合指数</td>
</tr>
<tr class="odd">
<td><strong>TLI</strong></td>
<td>&gt; 0.95</td>
<td>&gt; 0.90</td>
<td>Tucker-Lewis 指数</td>
</tr>
<tr class="even">
<td><strong>RMSEA</strong></td>
<td>&lt; 0.05</td>
<td>&lt; 0.08</td>
<td>近似误差均方根</td>
</tr>
<tr class="odd">
<td><strong>SRMR</strong></td>
<td>&lt; 0.05</td>
<td>&lt; 0.08</td>
<td>标准化残差均方根</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="因子载荷" class="level2">
<h2 class="anchored" data-anchor-id="因子载荷">因子载荷</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 标准化因子载荷</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>std_loadings <span class="ot">&lt;-</span> <span class="fu">standardizedSolution</span>(cfa_fit)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>std_loadings[std_loadings<span class="sc">$</span>op <span class="sc">==</span> <span class="st">"=~"</span>, <span class="fu">c</span>(<span class="st">"lhs"</span>, <span class="st">"rhs"</span>, <span class="st">"est.std"</span>, <span class="st">"pvalue"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 lhs rhs est.std pvalue
1      Agreeableness  A1   0.344      0
2      Agreeableness  A2  -0.648      0
3      Agreeableness  A3  -0.749      0
4      Agreeableness  A4  -0.510      0
5      Agreeableness  A5  -0.687      0
6  Conscientiousness  C1   0.551      0
7  Conscientiousness  C2   0.592      0
8  Conscientiousness  C3   0.546      0
9  Conscientiousness  C4  -0.702      0
10 Conscientiousness  C5  -0.620      0
11      Extraversion  E1   0.564      0
12      Extraversion  E2   0.699      0
13      Extraversion  E3  -0.627      0
14      Extraversion  E4  -0.703      0
15      Extraversion  E5  -0.553      0
16       Neuroticism  N1   0.825      0
17       Neuroticism  N2   0.803      0
18       Neuroticism  N3   0.721      0
19       Neuroticism  N4   0.573      0
20       Neuroticism  N5   0.503      0
21          Openness  O1   0.564      0
22          Openness  O2  -0.418      0
23          Openness  O3   0.724      0
24          Openness  O4   0.233      0
25          Openness  O5  -0.461      0</code></pre>
</div>
</div>
<p><strong>标准</strong>：标准化载荷 &gt; 0.5（最低 0.4）。</p>
</section>
<section id="信效度评估" class="level2">
<h2 class="anchored" data-anchor-id="信效度评估">信效度评估</h2>
<section id="组合信度-cr" class="level3">
<h3 class="anchored" data-anchor-id="组合信度-cr">组合信度 (CR)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算组合信度</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>calc_CR <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, factor_name) {</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    loadings <span class="ot">&lt;-</span> params[params<span class="sc">$</span>op <span class="sc">==</span> <span class="st">"=~"</span> <span class="sc">&amp;</span> params<span class="sc">$</span>lhs <span class="sc">==</span> factor_name, <span class="st">"std.all"</span>]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    sum_loadings <span class="ot">&lt;-</span> <span class="fu">sum</span>(loadings)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    sum_errors <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="dv">1</span> <span class="sc">-</span> loadings<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    CR <span class="ot">&lt;-</span> sum_loadings<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (sum_loadings<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sum_errors)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(CR)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>factors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Agreeableness"</span>, <span class="st">"Conscientiousness"</span>, <span class="st">"Extraversion"</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Neuroticism"</span>, <span class="st">"Openness"</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>CR_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(factors, <span class="cf">function</span>(f) <span class="fu">calc_CR</span>(cfa_fit, f))</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(CR_values, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Agreeableness Conscientiousness      Extraversion       Neuroticism 
            0.615             0.041             0.114             0.820 
         Openness 
            0.100 </code></pre>
</div>
</div>
<p><strong>标准</strong>：CR &gt; 0.7</p>
</section>
<section id="平均方差萃取量-ave" class="level3">
<h3 class="anchored" data-anchor-id="平均方差萃取量-ave">平均方差萃取量 (AVE)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 AVE</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>calc_AVE <span class="ot">&lt;-</span> <span class="cf">function</span>(fit, factor_name) {</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    params <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    loadings <span class="ot">&lt;-</span> params[params<span class="sc">$</span>op <span class="sc">==</span> <span class="st">"=~"</span> <span class="sc">&amp;</span> params<span class="sc">$</span>lhs <span class="sc">==</span> factor_name, <span class="st">"std.all"</span>]</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    AVE <span class="ot">&lt;-</span> <span class="fu">mean</span>(loadings<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(AVE)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>AVE_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(factors, <span class="cf">function</span>(f) <span class="fu">calc_AVE</span>(cfa_fit, f))</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(AVE_values, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Agreeableness Conscientiousness      Extraversion       Neuroticism 
            0.367             0.366             0.400             0.485 
         Openness 
            0.257 </code></pre>
</div>
</div>
<p><strong>标准</strong>： - AVE &gt; 0.5：收敛效度良好 - AVE 的平方根 &gt; 因子间相关：区分效度良好</p>
</section>
<section id="因子相关矩阵" class="level3">
<h3 class="anchored" data-anchor-id="因子相关矩阵">因子相关矩阵</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 因子相关</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>factor_cor <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(cfa_fit, <span class="st">"cor.lv"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(factor_cor, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Agrbln Cnscnt Extrvr Nrtcsm Opnnss
Agreeableness      1.000                            
Conscientiousness -0.334  1.000                     
Extraversion       0.683 -0.357  1.000              
Neuroticism        0.223 -0.283  0.244  1.000       
Openness          -0.303  0.301 -0.453 -0.112  1.000</code></pre>
</div>
</div>
</section>
<section id="区分效度检验" class="level3">
<h3 class="anchored" data-anchor-id="区分效度检验">区分效度检验</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较 AVE 平方根与因子相关</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>AVE_sqrt <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(AVE_values)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AVE 平方根:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AVE 平方根:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(AVE_sqrt, <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Agreeableness Conscientiousness      Extraversion       Neuroticism 
            0.605             0.605             0.633             0.696 
         Openness 
            0.507 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">最大因子相关:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
最大因子相关:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取最大相关（排除对角线）</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>factor_cor_nodiag <span class="ot">&lt;-</span> factor_cor</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(factor_cor_nodiag) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">apply</span>(<span class="fu">abs</span>(factor_cor_nodiag), <span class="dv">1</span>, max), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Agreeableness Conscientiousness      Extraversion       Neuroticism 
            0.683             0.357             0.683             0.283 
         Openness 
            0.453 </code></pre>
</div>
</div>
</section>
</section>
<section id="cfa-可视化" class="level2">
<h2 class="anchored" data-anchor-id="cfa-可视化">CFA 可视化</h2>
<section id="路径图" class="level3">
<h3 class="anchored" data-anchor-id="路径图">路径图</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(cfa_fit,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">what =</span> <span class="st">"std"</span>, <span class="co"># 标准化系数</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">layout =</span> <span class="st">"tree2"</span>,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvePivot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">fade =</span> <span class="cn">FALSE</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"lisrel"</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sizeLat =</span> <span class="dv">8</span>,</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sizeMan =</span> <span class="dv">6</span>,</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">nCharNodes =</span> <span class="dv">0</span>,</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">residuals =</span> <span class="cn">FALSE</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1038-efa-cfa_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="1200"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="模型修正" class="level2">
<h2 class="anchored" data-anchor-id="模型修正">模型修正</h2>
<section id="修正指数" class="level3">
<h3 class="anchored" data-anchor-id="修正指数">修正指数</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看修正指数</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>mi <span class="ot">&lt;-</span> <span class="fu">modindices</span>(cfa_fit, <span class="at">sort =</span> <span class="cn">TRUE</span>, <span class="at">minimum.value =</span> <span class="dv">10</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mi, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  lhs op rhs      mi    epc sepc.lv sepc.all sepc.nox
421                N1 ~~  N2 418.812  0.841   0.841    1.033    1.033
119      Extraversion =~  N4 200.790  0.487   0.448    0.285    0.285
158          Openness =~  E3 153.715  0.672   0.427    0.316    0.316
438                N3 ~~  N4 134.104  0.403   0.403    0.283    0.283
159          Openness =~  E4 122.558 -0.636  -0.404   -0.276   -0.276
95  Conscientiousness =~  E5 121.499  0.504   0.343    0.255    0.255
123      Extraversion =~  O3 114.202 -0.429  -0.395   -0.328   -0.328
124      Extraversion =~  O4 113.863  0.372   0.343    0.287    0.287
135       Neuroticism =~  C5 108.754  0.271   0.352    0.216    0.216
110      Extraversion =~  A5 108.587 -0.488  -0.449   -0.354   -0.354</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>[!WARNING] 修正指数应谨慎使用！仅在有理论支持时添加路径，避免过度拟合。</p>
</blockquote>
</section>
<section id="添加残差相关" class="level3">
<h3 class="anchored" data-anchor-id="添加残差相关">添加残差相关</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 修正模型示例</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>cfa_model_modified <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Agreeableness =~ A1 + A2 + A3 + A4 + A5</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Conscientiousness =~ C1 + C2 + C3 + C4 + C5</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="st">  Extraversion =~ E1 + E2 + E3 + E4 + E5</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="st">  Neuroticism =~ N1 + N2 + N3 + N4 + N5</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Openness =~ O1 + O2 + O3 + O4 + O5</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="st">  # 根据理论添加残差相关</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="st">  # E1 ~~ E2</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>cfa_fit_mod <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_model_modified, <span class="at">data =</span> items_complete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="模型比较" class="level3">
<h3 class="anchored" data-anchor-id="模型比较">模型比较</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较原始模型和修正模型</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="co"># anova(cfa_fit, cfa_fit_mod)  # 若模型嵌套</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="多组-cfa" class="level2">
<h2 class="anchored" data-anchor-id="多组-cfa">多组 CFA</h2>
<p>检验因子结构在不同组别是否等值。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加性别变量</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>items_with_gender <span class="ot">&lt;-</span> <span class="fu">cbind</span>(items_complete, <span class="at">gender =</span> bfi<span class="sc">$</span>gender[<span class="fu">complete.cases</span>(bfi[, <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>])])</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>items_with_gender <span class="ot">&lt;-</span> items_with_gender[<span class="sc">!</span><span class="fu">is.na</span>(items_with_gender<span class="sc">$</span>gender), ]</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 型态等值（因子结构相同）</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>fit_config <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_model, <span class="at">data =</span> items_with_gender, <span class="at">group =</span> <span class="st">"gender"</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 弱等值（载荷相等）</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>fit_metric <span class="ot">&lt;-</span> <span class="fu">cfa</span>(cfa_model,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> items_with_gender, <span class="at">group =</span> <span class="st">"gender"</span>,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">group.equal =</span> <span class="st">"loadings"</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_config, fit_metric)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

            Df    AIC    BIC  Chisq Chisq diff RMSEA Df diff Pr(&gt;Chisq)
fit_config 530 199494 200479 4545.3                                    
fit_metric 550 199471 200341 4562.6     17.307     0      20     0.6329</code></pre>
</div>
</div>
</section>
<section id="报告模板" class="level2">
<h2 class="anchored" data-anchor-id="报告模板">报告模板</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
## CFA 结果报告

### 模型拟合
使用最大似然法估计五因子模型。模型拟合指数如下：
χ²( 265 ) =  4165.47 , p &lt; .001,
CFI =  0.782 ,
TLI =  0.754 ,
RMSEA =  0.078  (90% CI [ 0.076 ,  0.08 ]),
SRMR =  0.075 。

### 信效度
所有因子的组合信度 (CR) 均大于 0.7，AVE 均大于 0.4。</code></pre>
</div>
</div>
</section>
<section id="efa-vs-cfa-选择指南" class="level2">
<h2 class="anchored" data-anchor-id="efa-vs-cfa-选择指南">EFA vs CFA 选择指南</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
┌─────────────────────────────────────────────────┐
│                  选择决策树                      │
├─────────────────────────────────────────────────┤
│ 1. 是否有先验的因子结构假设？                    │
│    ├─ 否 → EFA（探索结构）                       │
│    └─ 是 → CFA（验证结构）                       │
│                                                 │
│ 2. 量表开发阶段？                               │
│    ├─ 初期开发 → EFA                            │
│    └─ 验证修订 → CFA                            │
│                                                 │
│ 3. 是否需要跨组比较？                           │
│    └─ 是 → 多组 CFA                              │
└─────────────────────────────────────────────────┘</code></pre>
</div>
</div>
</section>
<section id="总结" class="level2">
<h2 class="anchored" data-anchor-id="总结">总结</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>阶段</th>
<th>方法</th>
<th>目的</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>量表开发</td>
<td>EFA</td>
<td>探索因子结构</td>
</tr>
<tr class="even">
<td>量表验证</td>
<td>CFA</td>
<td>验证因子结构</td>
</tr>
<tr class="odd">
<td>跨文化研究</td>
<td>多组CFA</td>
<td>检验测量等值</td>
</tr>
<tr class="even">
<td>理论检验</td>
<td>CFA</td>
<td>验证测量模型</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p>[!TIP] <strong>最佳实践</strong>： 1. EFA 和 CFA 应使用<strong>不同样本</strong> 2. 因子数确定综合多种方法 3. 拟合不佳时先检查数据质量 4. 模型修正需有理论支持</p>
</blockquote>
</section>
<section id="参考文献" class="level2">
<h2 class="anchored" data-anchor-id="参考文献">参考文献</h2>
<ul>
<li>Brown, T. A. (2015). <em>Confirmatory Factor Analysis for Applied Research</em> (2nd ed.). Guilford Press.</li>
<li>Fabrigar, L. R., &amp; Wegener, D. T. (2012). <em>Exploratory Factor Analysis</em>. Oxford University Press.</li>
<li>Revelle, W. (2023). psych: Procedures for Psychological, Psychometric, and Personality Research. R package.</li>
</ul>


</section>

</main> <!-- /main -->
<!-- Back to Top Button -->

<button id="back-to-top" aria-label="Back to Top">

    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">

        <path d="M18 15l-6-6-6 6"></path>

    </svg>

</button>



<!-- Floating TOC Button (Mobile Only) -->

<button id="toc-floating-btn" aria-label="Table of Contents">

    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">

        <line x1="8" y1="6" x2="21" y2="6"></line>

        <line x1="8" y1="12" x2="21" y2="12"></line>

        <line x1="8" y1="18" x2="21" y2="18"></line>

        <line x1="3" y1="6" x2="3.01" y2="6"></line>

        <line x1="3" y1="12" x2="3.01" y2="12"></line>

        <line x1="3" y1="18" x2="3.01" y2="18"></line>

    </svg>

</button>



<!-- TOC Modal -->

<div class="toc-modal-overlay">

    <div class="toc-modal-content">

        <div class="toc-modal-header">

            <div class="toc-modal-title">目录</div>

            <button class="toc-modal-close" aria-label="Close">×</button>

        </div>

        <div class="toc-modal-body" id="toc-modal-body">

            <!-- TOC content will be injected here -->

        </div>

    </div>

</div>



<script>

    // Back to Top Logic

    const backToTopBtn = document.getElementById('back-to-top');



    window.addEventListener('scroll', () => {

        if (window.scrollY > 300) {

            backToTopBtn.classList.add('visible');

        } else {

            backToTopBtn.classList.remove('visible');

        }

    });



    backToTopBtn.addEventListener('click', () => {

        window.scrollTo({

            top: 0,

            behavior: 'smooth'

        });

    });



    // Mobile Table Scrolling Logic

    document.addEventListener("DOMContentLoaded", function () {

        const tables = document.querySelectorAll('table');

        tables.forEach(table => {

            if (!table.parentElement.classList.contains('table-responsive')) {

                const wrapper = document.createElement('div');

                wrapper.className = 'table-responsive';

                wrapper.style.overflowX = 'auto'; // Force scroll

                table.parentNode.insertBefore(wrapper, table);

                wrapper.appendChild(table);

            }

        });



        // Floating TOC Logic

        const tocBtn = document.getElementById('toc-floating-btn');

        const tocOverlay = document.querySelector('.toc-modal-overlay');

        const tocClose = document.querySelector('.toc-modal-close');

        const tocBody = document.getElementById('toc-modal-body');

        const originalToc = document.getElementById('TOC');



        if (originalToc && tocBtn) {

            // Check if TOC has content

            const tocLinks = originalToc.querySelectorAll('a');

            if (tocLinks.length > 0) {

                tocBtn.style.display = 'flex';



                // Function to populate modal

                const populateToc = () => {

                    tocBody.innerHTML = '';

                    const tocClone = originalToc.querySelector('ul').cloneNode(true);

                    tocBody.appendChild(tocClone);



                    // Add click listeners to close modal on link click

                    tocBody.querySelectorAll('a').forEach(link => {

                        link.addEventListener('click', () => {

                            tocOverlay.classList.remove('active');

                            // Smooth scroll to target (handled by browser usually, but ensure modal closes first)

                        });

                    });

                };



                tocBtn.addEventListener('click', () => {

                    populateToc();

                    tocOverlay.classList.add('active');

                });



                tocClose.addEventListener('click', () => {

                    tocOverlay.classList.remove('active');

                });



                tocOverlay.addEventListener('click', (e) => {

                    if (e.target === tocOverlay) {

                        tocOverlay.classList.remove('active');

                    }

                });

            } else {

                tocBtn.style.display = 'none';

            }

        } else if (tocBtn) {

            tocBtn.style.display = 'none';

        }



        // Article Footer Random Recommendation

        // Only run on article pages (has sidebar and main content)

        const sidebar = document.querySelector('#quarto-sidebar') || document.querySelector('.sidebar');

        const mainContent = document.querySelector('main');



        if (sidebar && mainContent) {

            const links = Array.from(sidebar.querySelectorAll('a.sidebar-item-text'));



            // If no links found with specific class, try generic anchor in sidebar

            const allLinks = links.length > 0 ? links : Array.from(sidebar.querySelectorAll('a'));



            // Filter out section headers if they are just toggles (usually href is # or empty)

            const validLinks = allLinks.filter(a => a.href && !a.href.endsWith('#') && !a.href.includes('javascript:'));



            // Article Footer Navigation (Prev/Next + Random)

            const currentUrl = window.location.href.split('#')[0];

            let currentIndex = -1;



            // Find current article index

            for (let i = 0; i < validLinks.length; i++) {

                if (validLinks[i].href.split('#')[0] === currentUrl) {

                    currentIndex = i;

                    break;

                }

            }



            // Create Container

            const footerNav = document.createElement('div');

            footerNav.className = 'article-footer-nav-container';

            footerNav.style.marginTop = '4rem';

            footerNav.style.paddingTop = '2rem';

            footerNav.style.borderTop = '1px solid #e5e7eb';



            // 1. Prev/Next Navigation

            if (currentIndex !== -1) {

                let navHtml = '<div class="article-footer-nav">';



                // Previous

                if (currentIndex > 0) {

                    const prevLink = validLinks[currentIndex - 1];

                    const prevTitle = prevLink.innerText.trim();

                    navHtml += `

                        <a href="${prevLink.href}" class="article-nav-link">

                            <span class="nav-label">上一篇</span>

                            <span class="nav-title">« ${prevTitle}</span>

                        </a>

                    `;

                } else {

                    navHtml += `<div></div>`;

                }



                // Next

                if (currentIndex < validLinks.length - 1) {

                    const nextLink = validLinks[currentIndex + 1];

                    const nextTitle = nextLink.innerText.trim();

                    navHtml += `

                        <a href="${nextLink.href}" class="article-nav-link" style="text-align: right;">

                            <span class="nav-label">下一篇</span>

                            <span class="nav-title">${nextTitle} »</span>

                        </a>

                    `;

                } else {

                    navHtml += `<div></div>`;

                }



                navHtml += '</div>';



                // Append Prev/Next HTML

                const navDiv = document.createElement('div');

                navDiv.innerHTML = navHtml;

                footerNav.appendChild(navDiv);

            }



            // 2. Random Recommendation

            const otherLinks = validLinks.filter((_, idx) => idx !== currentIndex);

            if (otherLinks.length > 0) {

                const randomIdx = Math.floor(Math.random() * otherLinks.length);

                const randomLink = otherLinks[randomIdx];

                const randomTitle = randomLink.innerText.trim(); // Use innerText for title



                if (randomTitle) {

                    const randomDiv = document.createElement('div');

                    randomDiv.innerHTML = `

                        <div class="random-recommendation">

                            <h4>👋 随便看看</h4>

                            <p>探索更多 R 语言精彩内容</p>

                            <a href="${randomLink.href}" class="random-btn">

                                🎲 ${randomTitle}

                            </a>

                        </div>

                    `;

                    footerNav.appendChild(randomDiv);

                }

            }



            mainContent.appendChild(footerNav);

        }

    });

</script>



<!-- Like Button Styles -->

<style>

    .article-like-container {

        display: flex;

        justify-content: flex-start;

        margin: 1.5rem 0 2rem 0;

        padding: 0;

    }



    .like-wrapper {

        display: flex;

        flex-direction: column;

        align-items: flex-start;

        gap: 0.4rem;

    }



    .like-btn {

        display: inline-flex;

        align-items: center;

        gap: 0.5rem;

        padding: 0.6rem 1.2rem;

        border: 2px solid #e5e7eb;

        border-radius: 50px;

        background: white;

        color: #6b7280;

        font-size: 0.95rem;

        font-weight: 500;

        cursor: pointer;

        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);

        user-select: none;

    }



    .like-btn:hover {

        border-color: #f472b6;

        color: #ec4899;

        background: #fdf2f8;

    }



    .like-btn.liked {

        border-color: #ec4899;

        color: #ec4899;

        background: #fdf2f8;

    }



    .like-btn.pop {

        animation: pop-animation 0.3s ease;

    }



    @keyframes pop-animation {

        0% {

            transform: scale(1);

        }



        50% {

            transform: scale(1.15);

        }



        100% {

            transform: scale(1);

        }

    }



    .like-icon {

        width: 20px;

        height: 20px;

        transition: transform 0.2s;

    }



    .like-btn:hover .like-icon {

        transform: scale(1.1);

    }



    .like-icon .heart-outline {

        fill: none;

        stroke: currentColor;

        stroke-width: 2;

    }



    .like-icon .heart-fill {

        fill: currentColor;

        opacity: 0;

        transition: opacity 0.2s;

    }



    .like-btn.liked .heart-fill {

        opacity: 1;

    }



    .like-btn.liked .heart-outline {

        stroke: none;

    }



    .like-text {

        font-size: 0.9rem;

    }



    .like-count {

        font-size: 0.85rem;

        min-width: 1rem;

        text-align: center;

    }



    .like-hint {

        font-size: 0.75rem;

        color: #9ca3af;

        padding-left: 0.25rem;

    }



    /* Mobile optimization */

    @media (max-width: 768px) {

        .article-like-container {

            margin: 1rem 0 1.5rem 0;

        }



        .like-btn {

            padding: 0.5rem 1rem;

            font-size: 0.9rem;

        }



        .like-icon {

            width: 18px;

            height: 18px;

        }

    }

</style>



<!-- Like Section Script with Supabase Backend -->

<script>

    // Supabase Configuration

    const SUPABASE_URL = 'https://zyfdzyifhvglibpganxt.supabase.co';

    const SUPABASE_ANON_KEY = 'sb_publishable_XhaP4hFZ30sHZybEjVRQxg_iwlPTxz8';



    document.addEventListener('DOMContentLoaded', async function () {

        const mainContent = document.querySelector('main');



        // Only show on article pages (not index, not sections)

        const isArticlePage = !window.location.pathname.includes('index.html') &&

            !window.location.pathname.includes('sections/') &&

            !window.location.pathname.endsWith('/');



        if (!isArticlePage || !mainContent) return;



        const articleId = window.location.pathname.replace(/[^a-zA-Z0-9]/g, '_');

        const likeKey = `article_like_${articleId}`; // localStorage key for current user's like state



        // Create Like Section (at page bottom)

        const likeSection = document.createElement('div');

        likeSection.className = 'article-like-section';



        // Initial state from localStorage (for immediate UI feedback)

        const isLiked = localStorage.getItem(likeKey) === 'true';

        let likeCount = 0;



        likeSection.innerHTML = `

            <div class="like-section-inner">

                <p class="like-prompt">觉得有帮助？点赞支持一下 👇</p>

                <button class="like-btn ${isLiked ? 'liked' : ''}" id="article-like-btn" aria-label="点赞">

                    <svg class="like-icon" viewBox="0 0 24 24" width="24" height="24">

                        <path class="heart-outline" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>

                        <path class="heart-fill" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>

                    </svg>

                    <span class="like-text">${isLiked ? '已喜欢' : '喜欢这篇文章'}</span>

                    <span class="like-count" id="like-count"><span class="loading-dots">...</span></span>

                </button>

            </div>

        `;



        mainContent.appendChild(likeSection);



        const likeBtn = document.getElementById('article-like-btn');

        const likeCountSpan = document.getElementById('like-count');

        const likeText = likeBtn.querySelector('.like-text');



        // Supabase API helper

        async function supabaseRequest(method, endpoint, body = null) {

            const options = {

                method: method,

                headers: {

                    'apikey': SUPABASE_ANON_KEY,

                    'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,

                    'Content-Type': 'application/json',

                    'Prefer': method === 'POST' ? 'return=representation' : 'return=minimal'

                }

            };

            if (body) options.body = JSON.stringify(body);



            try {

                const response = await fetch(`${SUPABASE_URL}/rest/v1/${endpoint}`, options);

                if (!response.ok) throw new Error(`HTTP ${response.status}`);

                const text = await response.text();

                return text ? JSON.parse(text) : null;

            } catch (error) {

                console.error('Supabase error:', error);

                return null;

            }

        }



        // Fetch current like count from Supabase

        async function fetchLikeCount() {

            const data = await supabaseRequest('GET', `article_likes?article_id=eq.${articleId}&select=like_count`);

            if (data && data.length > 0) {

                return data[0].like_count;

            }

            return 0;

        }



        // Update like count in Supabase

        async function updateLikeCount(newCount) {

            // Try to update existing record

            const existing = await supabaseRequest('GET', `article_likes?article_id=eq.${articleId}&select=id`);



            if (existing && existing.length > 0) {

                // Update existing

                await supabaseRequest('PATCH', `article_likes?article_id=eq.${articleId}`, {

                    like_count: newCount

                });

            } else {

                // Insert new record

                await supabaseRequest('POST', 'article_likes', {

                    article_id: articleId,

                    like_count: newCount

                });

            }

        }



        // Load initial like count

        try {

            likeCount = await fetchLikeCount();

            likeCountSpan.textContent = likeCount > 0 ? likeCount : '';

        } catch (e) {

            console.error('Failed to fetch likes:', e);

            likeCountSpan.textContent = '';

        }



        // Like button click handler

        likeBtn.addEventListener('click', async function () {

            const currentlyLiked = this.classList.contains('liked');



            // Optimistic UI update

            if (currentlyLiked) {

                this.classList.remove('liked');

                likeCount = Math.max(0, likeCount - 1);

                likeText.textContent = '喜欢这篇文章';

                localStorage.setItem(likeKey, 'false');

            } else {

                this.classList.add('liked');

                likeCount++;

                likeText.textContent = '已喜欢';

                localStorage.setItem(likeKey, 'true');



                this.classList.add('pop');

                setTimeout(() => this.classList.remove('pop'), 300);

            }



            likeCountSpan.textContent = likeCount > 0 ? likeCount : '';



            // Sync with Supabase in background

            try {

                await updateLikeCount(likeCount);

            } catch (e) {

                console.error('Failed to sync like:', e);

            }

        });



        // ============================================

        // Comment Section with Supabase

        // ============================================



        // Create comment section HTML

        const commentSection = document.createElement('div');

        commentSection.className = 'comment-section';

        commentSection.innerHTML = `

            <h4 class="comment-title">💬 评论区</h4>

            <div class="comment-form">

                <input type="text" id="comment-nickname" class="comment-nickname" placeholder="昵称（可选）" maxlength="20">

                <textarea id="comment-content" class="comment-textarea" placeholder="写下你的想法..." maxlength="500" rows="3"></textarea>

                <div class="comment-form-footer">

                    <span class="char-count"><span id="char-count">0</span>/500</span>

                    <button id="submit-comment" class="comment-submit-btn">发表评论</button>

                </div>

            </div>

            <div id="comment-list" class="comment-list">

                <div class="loading-comments">加载评论中...</div>

            </div>

        `;



        // Append comment section after like section

        const likeSectionEl = document.querySelector('.article-like-section');

        if (likeSectionEl) {

            likeSectionEl.after(commentSection);

        } else {

            mainContent.appendChild(commentSection);

        }



        const commentNickname = document.getElementById('comment-nickname');

        const commentContent = document.getElementById('comment-content');

        const submitBtn = document.getElementById('submit-comment');

        const commentList = document.getElementById('comment-list');

        const charCount = document.getElementById('char-count');



        // Visitor ID for identifying own comments

        let visitorId = localStorage.getItem('visitor_id');

        if (!visitorId) {

            visitorId = 'v_' + Math.random().toString(36).substr(2, 9) + Date.now().toString(36);

            localStorage.setItem('visitor_id', visitorId);

        }



        // Character counter

        commentContent.addEventListener('input', () => {

            charCount.textContent = commentContent.value.length;

        });



        // Format time helper

        function formatTime(timestamp) {

            const date = new Date(timestamp);

            const now = new Date();

            const diff = now - date;



            if (diff < 60000) return '刚刚';

            if (diff < 3600000) return Math.floor(diff / 60000) + ' 分钟前';

            if (diff < 86400000) return Math.floor(diff / 3600000) + ' 小时前';

            if (diff < 604800000) return Math.floor(diff / 86400000) + ' 天前';



            return date.toLocaleDateString('zh-CN');

        }



        // Escape HTML to prevent XSS

        function escapeHtml(text) {

            const div = document.createElement('div');

            div.textContent = text;

            return div.innerHTML;

        }



        // Fetch comments from Supabase

        async function fetchComments() {

            const data = await supabaseRequest('GET', `article_comments?article_id=eq.${articleId}&order=created_at.desc`);

            return data || [];

        }



        // Post new comment

        async function postComment(nickname, content) {

            return await supabaseRequest('POST', 'article_comments', {

                article_id: articleId,

                nickname: nickname || '匿名用户',

                content: content,

                visitor_id: visitorId

            });

        }



        // Delete comment

        async function deleteComment(commentId) {

            await supabaseRequest('DELETE', `article_comments?id=eq.${commentId}&visitor_id=eq.${visitorId}`);

        }



        // Render comments

        function renderComments(comments) {

            if (!comments || comments.length === 0) {

                commentList.innerHTML = '<div class="no-comments">暂无评论，来做第一个留言的人吧 🎉</div>';

                return;

            }



            commentList.innerHTML = comments.map(c => `

                <div class="comment-item" data-id="${c.id}">

                    <div class="comment-header">

                        <span class="comment-author">${escapeHtml(c.nickname || '匿名用户')}</span>

                        <span class="comment-time">${formatTime(c.created_at)}</span>

                        ${c.visitor_id === visitorId ? `<button class="comment-delete" data-id="${c.id}">删除</button>` : ''}

                    </div>

                    <div class="comment-body">${escapeHtml(c.content)}</div>

                </div>

            `).join('');



            // Add delete handlers

            commentList.querySelectorAll('.comment-delete').forEach(btn => {

                btn.addEventListener('click', async function () {

                    const id = this.dataset.id;

                    await deleteComment(id);

                    loadComments();

                });

            });

        }



        // Load and display comments

        async function loadComments() {

            try {

                const comments = await fetchComments();

                renderComments(comments);

            } catch (e) {

                console.error('Failed to load comments:', e);

                commentList.innerHTML = '<div class="no-comments">加载评论失败</div>';

            }

        }



        // Submit comment handler

        submitBtn.addEventListener('click', async function () {

            const content = commentContent.value.trim();

            if (!content) {

                alert('请输入评论内容');

                return;

            }



            submitBtn.disabled = true;

            submitBtn.textContent = '发送中...';



            try {

                await postComment(commentNickname.value.trim(), content);

                commentContent.value = '';

                charCount.textContent = '0';

                await loadComments();

            } catch (e) {

                console.error('Failed to post comment:', e);

                alert('评论发送失败，请重试');

            }



            submitBtn.disabled = false;

            submitBtn.textContent = '发表评论';

        });



        // Initial load

        loadComments();

    });

</script>



<!-- Interaction Section Styles -->

<style>

    .article-interaction-section {

        margin-top: 3rem;

        padding-top: 2rem;

        border-top: 2px solid #e5e7eb;

    }



    .interaction-header {

        text-align: center;

        margin-bottom: 2rem;

    }



    .interaction-header h3 {

        font-size: 1.4rem;

        color: #1f2937;

        margin: 0 0 0.5rem 0;

    }



    .interaction-header p {

        color: #6b7280;

        font-size: 0.95rem;

        margin: 0;

    }



    /* Like Section at Bottom */

    .article-like-section {

        margin-top: 3rem;

        padding: 2rem 0;

        border-top: 2px solid #e5e7eb;

        text-align: center;

    }



    .like-section-inner {

        display: flex;

        flex-direction: column;

        align-items: center;

        gap: 1rem;

    }



    .like-prompt {

        color: #6b7280;

        font-size: 0.95rem;

        margin: 0;

    }



    .article-like-section .like-btn {

        padding: 0.75rem 2rem;

        font-size: 1rem;

    }



    .article-like-section .like-icon {

        width: 22px;

        height: 22px;

    }



    /* Mobile */

    @media (max-width: 768px) {

        .article-like-section {

            margin-top: 2rem;

            padding: 1.5rem 0;

        }



        .like-prompt {

            font-size: 0.9rem;

        }

    }



    /* Comment Section */

    .comment-section {

        margin-top: 2rem;

        padding: 1.5rem;

        background: #f9fafb;

        border-radius: 12px;

    }



    .comment-title {

        font-size: 1.1rem;

        color: #1f2937;

        margin: 0 0 1rem 0;

    }



    .comment-form {

        margin-bottom: 1.5rem;

    }



    .comment-nickname {

        width: 200px;

        padding: 0.5rem 0.75rem;

        border: 1px solid #e5e7eb;

        border-radius: 8px;

        font-size: 0.9rem;

        margin-bottom: 0.75rem;

        background: white;

    }



    .comment-textarea {

        width: 100%;

        padding: 0.75rem;

        border: 1px solid #e5e7eb;

        border-radius: 8px;

        font-size: 0.95rem;

        resize: vertical;

        min-height: 80px;

        background: white;

        font-family: inherit;

        box-sizing: border-box;

        margin-bottom: 0.5rem;

    }



    .comment-nickname:focus,

    .comment-textarea:focus {

        outline: none;

        border-color: #4f46e5;

        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);

    }



    .comment-form-footer {

        display: flex;

        justify-content: space-between;

        align-items: center;

    }



    .char-count {

        font-size: 0.8rem;

        color: #9ca3af;

    }



    .comment-submit-btn {

        padding: 0.6rem 1.5rem;

        background: #4f46e5;

        color: white;

        border: none;

        border-radius: 8px;

        font-size: 0.9rem;

        font-weight: 500;

        cursor: pointer;

        transition: all 0.2s;

    }



    .comment-submit-btn:hover:not(:disabled) {

        background: #4338ca;

        transform: translateY(-1px);

    }



    .comment-submit-btn:disabled {

        opacity: 0.6;

        cursor: not-allowed;

    }



    .comment-list {

        margin-top: 1rem;

    }



    .loading-comments,

    .no-comments {

        text-align: center;

        color: #9ca3af;

        padding: 1.5rem;

        font-size: 0.95rem;

    }



    .comment-item {

        background: white;

        border-radius: 8px;

        padding: 1rem;

        margin-bottom: 0.75rem;

        border: 1px solid #e5e7eb;

    }



    .comment-header {

        display: flex;

        align-items: center;

        gap: 0.75rem;

        margin-bottom: 0.5rem;

    }



    .comment-author {

        font-weight: 600;

        color: #1f2937;

        font-size: 0.9rem;

    }



    .comment-time {

        font-size: 0.8rem;

        color: #9ca3af;

    }



    .comment-delete {

        margin-left: auto;

        background: none;

        border: none;

        color: #ef4444;

        font-size: 0.8rem;

        cursor: pointer;

        padding: 0.2rem 0.5rem;

        border-radius: 4px;

    }



    .comment-delete:hover {

        background: #fef2f2;

    }



    .comment-body {

        color: #374151;

        font-size: 0.95rem;

        line-height: 1.6;

        white-space: pre-wrap;

        word-break: break-word;

    }



    /* Mobile Comment Styles */

    @media (max-width: 768px) {

        .comment-section {

            padding: 1rem;

        }



        .comment-nickname {

            width: 100%;

        }



        .comment-title {

            font-size: 1rem;

        }

    }

</style>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Made with <a href="https://quarto.org/">Quarto</a> | © 2024-2026</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>