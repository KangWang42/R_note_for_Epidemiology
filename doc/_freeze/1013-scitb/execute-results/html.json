{
  "hash": "26471363d320d8a99c5c9b66d953bfa9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: scitb-快速生成基线表一\ndate: '2024-10-20'\ncategories:\n- 实用 R 包\n- 表格制作\n- R包\n- 表格\nimage: images/gt-cover.svg\n---\n\n\n\n## R包介绍\n\nscitb是一个专门用于基线表开发的包，相较于tableone scitb具有更好使用，导出方便，快速设置的优点\n\n[CRAN库](https://cran.r-project.org/web//packages/scitb/index.html)\n\n[作者教程]([URL_ADDRESS](https://mp.weixin.qq.com/s?__biz=MzI1NjM3NTE1NQ==&mid=2247489581&idx=1&sn=de498ce7eaf3a3084efebddc568c7068&chksm=ea26f831dd5171272e58c707dac3242a8695d1413dfe5a5c8df926fa32c96728637290b14a6d&scene=21#wechat_redirect))\n\n## R包安装\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"scitb\")\n```\n:::\n\n\n\n## R包使用\n\n### 导入示例数据\n\n导入数据prematurity，：low 是否是小于2500g早产低体重儿，age 母亲的年龄，lwt 末次月经体重，race 种族，smoke孕期抽烟，ptl 早产史（计数），ht 有高血压病史，ui 子宫过敏，ftv 早孕时看医生的次数bwt 新生儿体重数值\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(scitb)\nlibrary(bruceR)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nbruceR (v2025.11)\nBroadly Useful Convenient and Efficient R functions\n\nPackages also loaded:\n✔ dplyr     \t✔ data.table\n✔ tidyr     \t✔ emmeans\n✔ stringr   \t✔ lmerTest\n✔ forcats   \t✔ effectsize\n✔ ggplot2   \t✔ performance\n✔ cowplot   \t✔ interactions\n\nMain functions of `bruceR`:\ncc()          \tDescribe() \tTTEST()\nadd()         \tFreq()     \tMANOVA()\n.mean()       \tCorr()     \tEMMEANS()\nset.wd()      \tAlpha()    \tPROCESS()\nimport()      \tEFA()      \tmodel_summary()\nprint_table() \tCFA()      \tlavaan_summary()\n\nFor full functionality, please install all dependencies:\ninstall.packages(\"bruceR\", dep=TRUE)\n\nOnline documentation:\nhttps://psychbruce.github.io/bruceR\n\nTo use this package in publications, please cite:\nBao, H. W. S. (2021). bruceR: Broadly useful convenient and efficient R functions (Version 2025.11) [Computer software]. https://doi.org/10.32614/CRAN.package.bruceR\n```\n\n\n:::\n\n```{.r .cell-code}\ndata <- prematurity\nhead(data,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  id low age lwt  race     smoke ptl ht ui ftv  bwt\n1 85   0  19 182 black nonsmoker   0  0  1   0 2523\n2 86   0  33 155 other nonsmoker   0  0  0   3 2551\n3 87   0  20 105 white    smoker   0  0  0   1 2557\n4 88   0  21 108 white    smoker   0  0  1   2 2594\n5 89   0  18 107 white    smoker   0  0  1   0 2600\n```\n\n\n:::\n:::\n\n\n### 生成描述性表1\n\n#### 首先定义变量\n\n为什么这里要定义变量，而不在基线表函数里直接引入字符向量，这是为了有良好的编程习惯。先从构建函数框架开始，最后函数调用，后续无论是修改变量还是增删变量都会很清晰\n\n\n::: {.cell}\n\n```{.r .cell-code}\nallVars<-c(\"low\",\"age\",\"lwt\",\"race\",\"smoke\",\"ptl\",\"ht\",\"ui\",\"ftv\",\"bwt\")\nfvars<-c(\"low\",\"race\",\"smoke\",\"ptl\",\"ht\",\"ui\",\"ftv\")\nstrata<-c(\"bwt\")\n```\n:::\n\n\n\n#### 生成基线表\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_neat <- data |> \n  mutate(\n    race = as.factor(race),\n    smoke = as.factor(smoke)\n  )\n\ntab0<-scitb1(vars=allVars,fvars=fvars,strata=strata,data=data_neat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Min 33.33333% 66.66667%       Max \n  709.000  2598.000  3283.667  4990.000 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nStrata is treated as a continuous variable.\n```\n\n\n:::\n\n```{.r .cell-code}\ntab0\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Characteristic G.0                      G.1                     \n   \"N\"            \"63\"                     \"63\"                    \nd1 \"age\"          \"22.00 (19.50-25.00)\"    \"23.00 (19.00-28.00)\"   \nd1 \"lwt\"          \"120.00 (105.00-131.00)\" \"120.00 (109.50-132.50)\"\nd1 \"bwt\"          \"2126.24±394.60\"         \"2969.94±190.20\"        \nd2 \"low\"          \" \"                      \" \"                     \n   \"0\"            \" 4 (6.35%)\"             \"63 (100.00%)\"          \n   \"1\"            \"59 (93.65%)\"            \" 0 (0.00%)\"            \nd2 \"race\"         \" \"                      \" \"                     \n   \"black\"        \"12 (19.05%)\"            \" 8 (12.70%)\"           \n   \"other\"        \"26 (41.27%)\"            \"25 (39.68%)\"           \n   \"white\"        \"25 (39.68%)\"            \"30 (47.62%)\"           \nd2 \"smoke\"        \" \"                      \" \"                     \n   \"nonsmoker\"    \"31 (49.21%)\"            \"39 (61.90%)\"           \n   \"smoker\"       \"32 (50.79%)\"            \"24 (38.10%)\"           \nd2 \"ptl\"          \" \"                      \" \"                     \n   \"0\"            \"45 (71.43%)\"            \"58 (92.06%)\"           \n   \"1\"            \"16 (25.40%)\"            \" 4 (6.35%)\"            \n   \"2\"            \" 2 (3.17%)\"             \" 1 (1.59%)\"            \n   \"3\"            \" 0 (0.00%)\"             \" 0 (0.00%)\"            \nd2 \"ht\"           \" \"                      \" \"                     \n   \"0\"            \"56 (88.89%)\"            \"61 (96.83%)\"           \n   \"1\"            \" 7 (11.11%)\"            \" 2 (3.17%)\"            \nd2 \"ui\"           \" \"                      \" \"                     \n   \"0\"            \"47 (74.60%)\"            \"54 (85.71%)\"           \n   \"1\"            \"16 (25.40%)\"            \" 9 (14.29%)\"           \nd2 \"ftv\"          \" \"                      \" \"                     \n   \"0\"            \"37 (58.73%)\"            \"32 (50.79%)\"           \n   \"1\"            \"12 (19.05%)\"            \"15 (23.81%)\"           \n   \"2\"            \" 8 (12.70%)\"            \"13 (20.63%)\"           \n   \"3\"            \" 5 (7.94%)\"             \" 2 (3.17%)\"            \n   \"4\"            \" 1 (1.59%)\"             \" 1 (1.59%)\"            \n   \"6\"            \" 0 (0.00%)\"             \" 0 (0.00%)\"            \n   G.2                      p value \n   \"63\"                     \"\"      \nd1 \"23.00 (19.50-28.00)\"    \"0.483\" \nd1 \"131.00 (120.00-156.00)\" \"<0.001\"\nd1 \"3736.68±317.76\"         \"<0.001\"\nd2 \" \"                      \"<0.001\"\n   \"63 (100.00%)\"           \" \"     \n   \" 0 (0.00%)\"             \" \"     \nd2 \" \"                      \"0.060\" \n   \" 6 (9.52%)\"             \" \"     \n   \"16 (25.40%)\"            \" \"     \n   \"41 (65.08%)\"            \" \"     \nd2 \" \"                      \"0.037\" \n   \"45 (71.43%)\"            \" \"     \n   \"18 (28.57%)\"            \" \"     \nd2 \" \"                      \"0.012\" \n   \"56 (88.89%)\"            \" \"     \n   \" 4 (6.35%)\"             \" \"     \n   \" 2 (3.17%)\"             \" \"     \n   \" 1 (1.59%)\"             \" \"     \nd2 \" \"                      \"0.154\" \n   \"60 (95.24%)\"            \" \"     \n   \" 3 (4.76%)\"             \" \"     \nd2 \" \"                      \"0.005\" \n   \"60 (95.24%)\"            \" \"     \n   \" 3 (4.76%)\"             \" \"     \nd2 \" \"                      \"0.283\" \n   \"31 (49.21%)\"            \" \"     \n   \"20 (31.75%)\"            \" \"     \n   \" 9 (14.29%)\"            \" \"     \n   \" 0 (0.00%)\"             \" \"     \n   \" 2 (3.17%)\"             \" \"     \n   \" 1 (1.59%)\"             \" \"     \n```\n\n\n:::\n:::\n\n\n\n#### 设置有非正态资料\n\n设置非正态后可以看到lwt变量是用百分位数进行描述，后边的pvalue也调用非参检验\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab2 <-scitb1(vars=allVars,fvars=fvars,strata=strata,data=data_neat, nonnormal=c(\"lwt\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Min 33.33333% 66.66667%       Max \n  709.000  2598.000  3283.667  4990.000 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nStrata is treated as a continuous variable.\n```\n\n\n:::\n\n```{.r .cell-code}\ntab2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Characteristic G.0                      G.1                     \n   \"N\"            \"63\"                     \"63\"                    \nd1 \"age\"          \"22.00 (19.50-25.00)\"    \"23.00 (19.00-28.00)\"   \nd1 \"lwt\"          \"120.00 (105.00-131.00)\" \"120.00 (109.50-132.50)\"\nd1 \"bwt\"          \"2126.24±394.60\"         \"2969.94±190.20\"        \nd2 \"low\"          \" \"                      \" \"                     \n   \"0\"            \" 4 (6.35%)\"             \"63 (100.00%)\"          \n   \"1\"            \"59 (93.65%)\"            \" 0 (0.00%)\"            \nd2 \"race\"         \" \"                      \" \"                     \n   \"black\"        \"12 (19.05%)\"            \" 8 (12.70%)\"           \n   \"other\"        \"26 (41.27%)\"            \"25 (39.68%)\"           \n   \"white\"        \"25 (39.68%)\"            \"30 (47.62%)\"           \nd2 \"smoke\"        \" \"                      \" \"                     \n   \"nonsmoker\"    \"31 (49.21%)\"            \"39 (61.90%)\"           \n   \"smoker\"       \"32 (50.79%)\"            \"24 (38.10%)\"           \nd2 \"ptl\"          \" \"                      \" \"                     \n   \"0\"            \"45 (71.43%)\"            \"58 (92.06%)\"           \n   \"1\"            \"16 (25.40%)\"            \" 4 (6.35%)\"            \n   \"2\"            \" 2 (3.17%)\"             \" 1 (1.59%)\"            \n   \"3\"            \" 0 (0.00%)\"             \" 0 (0.00%)\"            \nd2 \"ht\"           \" \"                      \" \"                     \n   \"0\"            \"56 (88.89%)\"            \"61 (96.83%)\"           \n   \"1\"            \" 7 (11.11%)\"            \" 2 (3.17%)\"            \nd2 \"ui\"           \" \"                      \" \"                     \n   \"0\"            \"47 (74.60%)\"            \"54 (85.71%)\"           \n   \"1\"            \"16 (25.40%)\"            \" 9 (14.29%)\"           \nd2 \"ftv\"          \" \"                      \" \"                     \n   \"0\"            \"37 (58.73%)\"            \"32 (50.79%)\"           \n   \"1\"            \"12 (19.05%)\"            \"15 (23.81%)\"           \n   \"2\"            \" 8 (12.70%)\"            \"13 (20.63%)\"           \n   \"3\"            \" 5 (7.94%)\"             \" 2 (3.17%)\"            \n   \"4\"            \" 1 (1.59%)\"             \" 1 (1.59%)\"            \n   \"6\"            \" 0 (0.00%)\"             \" 0 (0.00%)\"            \n   G.2                      p value \n   \"63\"                     \"\"      \nd1 \"23.00 (19.50-28.00)\"    \"0.483\" \nd1 \"131.00 (120.00-156.00)\" \"<0.001\"\nd1 \"3736.68±317.76\"         \"<0.001\"\nd2 \" \"                      \"<0.001\"\n   \"63 (100.00%)\"           \" \"     \n   \" 0 (0.00%)\"             \" \"     \nd2 \" \"                      \"0.060\" \n   \" 6 (9.52%)\"             \" \"     \n   \"16 (25.40%)\"            \" \"     \n   \"41 (65.08%)\"            \" \"     \nd2 \" \"                      \"0.037\" \n   \"45 (71.43%)\"            \" \"     \n   \"18 (28.57%)\"            \" \"     \nd2 \" \"                      \"0.012\" \n   \"56 (88.89%)\"            \" \"     \n   \" 4 (6.35%)\"             \" \"     \n   \" 2 (3.17%)\"             \" \"     \n   \" 1 (1.59%)\"             \" \"     \nd2 \" \"                      \"0.154\" \n   \"60 (95.24%)\"            \" \"     \n   \" 3 (4.76%)\"             \" \"     \nd2 \" \"                      \"0.005\" \n   \"60 (95.24%)\"            \" \"     \n   \" 3 (4.76%)\"             \" \"     \nd2 \" \"                      \"0.283\" \n   \"31 (49.21%)\"            \" \"     \n   \"20 (31.75%)\"            \" \"     \n   \" 9 (14.29%)\"            \" \"     \n   \" 0 (0.00%)\"             \" \"     \n   \" 2 (3.17%)\"             \" \"     \n   \" 1 (1.59%)\"             \" \"     \n```\n\n\n:::\n:::\n\n\n\n### 连续变量快速分层描述\n\n输出1可以看出年龄的自动分层记录，表明从14到20到25到45进行了分层\n\n如果想要生成其它分层数，设置参数 num = n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# allvar删不删除年龄都可以\n\nallVars3 <-c(\"race\", \"lwt\",\"smoke\", \"ptl\", \"ht\", \"ui\",\"ftv\", \"bwt\")\nfvars3 <-c(\"smoke\",\"ht\",\"ui\",\"race\")\nstrata3 <- \"age\"\n\ntab3 <-scitb1(vars=allVars3,fvars=fvars3,strata=strata3,data=data_neat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Min 33.33333% 66.66667%       Max \n       14        20        25        45 \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nStrata is treated as a continuous variable.\n```\n\n\n:::\n\n```{.r .cell-code}\ntab3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Characteristic G.0                      G.1                     \n   \"N\"            \"51\"                     \"69\"                    \nd1 \"lwt\"          \"119.00 (106.00-135.00)\" \"121.00 (110.00-132.00)\"\nd1 \"ptl\"          \"0.00 (0.00-0.00)\"       \"0.00 (0.00-0.00)\"      \nd1 \"ftv\"          \"0.00 (0.00-1.00)\"       \"0.00 (0.00-1.00)\"      \nd1 \"bwt\"          \"2974.08±612.51\"         \"2921.42±697.85\"        \nd2 \"smoke\"        \" \"                      \" \"                     \n   \"nonsmoker\"    \"28 (54.90%)\"            \"44 (63.77%)\"           \n   \"smoker\"       \"23 (45.10%)\"            \"25 (36.23%)\"           \nd2 \"ht\"           \" \"                      \" \"                     \n   \"0\"            \"48 (94.12%)\"            \"64 (92.75%)\"           \n   \"1\"            \" 3 (5.88%)\"             \" 5 (7.25%)\"            \nd2 \"ui\"           \" \"                      \" \"                     \n   \"0\"            \"43 (84.31%)\"            \"58 (84.06%)\"           \n   \"1\"            \" 8 (15.69%)\"            \"11 (15.94%)\"           \nd2 \"race\"         \" \"                      \" \"                     \n   \"black\"        \"10 (19.61%)\"            \"10 (14.49%)\"           \n   \"other\"        \"18 (35.29%)\"            \"27 (39.13%)\"           \n   \"white\"        \"23 (45.10%)\"            \"32 (46.38%)\"           \n   G.2                      p value\n   \"69\"                     \"\"     \nd1 \"130.00 (115.00-153.00)\" \"0.086\"\nd1 \"0.00 (0.00-0.00)\"       \"0.171\"\nd1 \"1.00 (0.00-2.00)\"       \"0.011\"\nd1 \"2945.13±839.82\"         \"0.927\"\nd2 \" \"                      \"0.587\"\n   \"43 (62.32%)\"            \" \"    \n   \"26 (37.68%)\"            \" \"    \nd2 \" \"                      \"0.929\"\n   \"65 (94.20%)\"            \" \"    \n   \" 4 (5.80%)\"             \" \"    \nd2 \" \"                      \"0.873\"\n   \"60 (86.96%)\"            \" \"    \n   \" 9 (13.04%)\"            \" \"    \nd2 \" \"                      \"0.320\"\n   \" 6 (8.70%)\"             \" \"    \n   \"22 (31.88%)\"            \" \"    \n   \"41 (59.42%)\"            \" \"    \n```\n\n\n:::\n:::\n\n\n\n### 保存结果\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(tab0,file= \"01-attch\\\\10\\\\data.csv\",row.names = F, \n    fileEncoding = \"gbk\")\n```\n:::\n\n\n保存出来是下图，复制到word改改就能用\n\n![](https://pic-go-42.oss-cn-guangzhou.aliyuncs.com/img/202410211052806.png)\n\n## 总结\n\n使用体验：自定义度，结果展示等不如comparegroups，但是胜在参数简单，在期刊没那么高要求和平时展示可以用\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}