<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-01-25">
<meta name="description" content="系统介绍常见距离指标的计算原理、适用场景及 R 语言实现">

<title>常见距离指标完整指南：从欧氏到马氏距离 – R 语言学习笔记</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f04c1bab01eaa4046294d2af630dbbb8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R 语言学习笔记</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">主页</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">入门指南</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="./sections/guide.html#学习路线">
 <span class="dropdown-text">📘 学习路线</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/guide.html#基础知识">
 <span class="dropdown-text">📖 基础知识</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/guide.html#工作流程">
 <span class="dropdown-text">⚙️ 工作流程</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-包" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">实用 R 包</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-包">    
        <li>
    <a class="dropdown-item" href="./sections/packages.html#表格制作">
 <span class="dropdown-text">📊 表格制作</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/packages.html#数据处理">
 <span class="dropdown-text">🔄 数据处理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/packages.html#模型整理">
 <span class="dropdown-text">📈 模型整理</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">统计分析方法</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--1">    
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#基础回归">
 <span class="dropdown-text">📊 基础回归</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#生存分析">
 <span class="dropdown-text">⏱️ 生存分析</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#因果推断">
 <span class="dropdown-text">🎯 因果推断</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#高级建模">
 <span class="dropdown-text">📐 高级建模</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#贝叶斯统计">
 <span class="dropdown-text">📈 贝叶斯统计</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#模型评估">
 <span class="dropdown-text">🎯 模型评估</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#综述方法">
 <span class="dropdown-text">📚 综述方法</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ai" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">机器学习与AI</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ai">    
        <li>
    <a class="dropdown-item" href="./sections/machine-learning.html#机器学习框架">
 <span class="dropdown-text">🤖 机器学习框架</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/machine-learning.html#深度学习">
 <span class="dropdown-text">🧠 深度学习</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/machine-learning.html#ai-工具">
 <span class="dropdown-text">🛠️ AI 工具</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">实用操作</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--2">    
        <li>
    <a class="dropdown-item" href="./sections/operation.html#数据导入导出">
 <span class="dropdown-text">📥 数据导入导出</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#数据清洗">
 <span class="dropdown-text">🧹 数据清洗</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#数据转换">
 <span class="dropdown-text">🔄 数据转换</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#文档写作">
 <span class="dropdown-text">📝 文档写作</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#开发环境">
 <span class="dropdown-text">💻 开发环境</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">数据可视化</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--3">    
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#图形基础">
 <span class="dropdown-text">🏗️ 图形基础</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#图形组合">
 <span class="dropdown-text">🔀 图形组合</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#分布图">
 <span class="dropdown-text">📊 分布图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#趋势图">
 <span class="dropdown-text">📈 趋势图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#比较图">
 <span class="dropdown-text">📊 比较图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#关系图">
 <span class="dropdown-text">🔄 关系图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#特殊图形">
 <span class="dropdown-text">🎨 特殊图形</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#专题图">
 <span class="dropdown-text">🗺️ 专题图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#进阶美化">
 <span class="dropdown-text">✨ 进阶美化</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">特殊应用</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--4">    
        <li>
    <a class="dropdown-item" href="./sections/special.html#卫生经济学">
 <span class="dropdown-text">💰 卫生经济学</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/special.html#质性研究">
 <span class="dropdown-text">🔬 质性研究</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/special.html#信号处理">
 <span class="dropdown-text">📡 信号处理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/special.html#环境流行病学">
 <span class="dropdown-text">🌍 环境流行病学</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/special.html#建模方法">
 <span class="dropdown-text">🔬 建模方法</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KangWang42/R_note_for_Epidemiology"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">常见距离指标完整指南：从欧氏到马氏距离</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">入门指南</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">📘 学习路线</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0001-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">新手入门指南</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">📖 基础知识</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMarkdown 入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012-quarto-vs-rmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto vs RMarkdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013-positron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positron IDE 教程</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">⚙️ 工作流程</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3006-reproducible-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">可重复研究工作流</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">实用 R 包</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 表格制作</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1011-rpac_brucer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">bruceR - 统计分析工具</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1012-comparegroups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">compareGroups - 描述性表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1013-scitb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scitb - 快速基线表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1053-gtsummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gtsummary - 发表级表格</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1067-gt-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gt - 现代表格系统</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">🔄 数据处理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1014-purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">purrr - 函数式编程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1014-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">future - 并行计算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1045-rstatix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rstatix - 管道式统计</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1071-targets-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">targets - 工作流管理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1072-arrow-bigdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">arrow - 大数据处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3015-tidytable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidytable - 高性能数据处理</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">📈 模型整理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1043-broom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">broom - 模型整理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1064-marginaleffects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">marginaleffects - 边际效应</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">统计分析方法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 基础回归</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1119-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">常见数据分布</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1019-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic 回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1021-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多元线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1112-robust-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">稳健线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1104-ridge-lasso.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">岭回归与 Lasso</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1105-regression-feature-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">回归特征筛选</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1026-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson/负二项回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1036-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">方差分析 (ANOVA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1117-nonparametric-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">非参数检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1074-quantile-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">分位数回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1075-zero-inflated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">零膨胀模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1113-threshold-effects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">阈值效应分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1093-ordinal-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">有序回归</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">⏱️ 生存分析</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1020-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">生存分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1050-competing-risks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">竞争风险分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1027-rcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">限制性立方样条 (RCS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1017-timeseries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时间序列分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1055-tx-effects-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">治疗效果分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1061-random-survival-forest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">随机生存森林 (RSF)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1077-composite-endpoints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">复合结局分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">🎯 因果推断</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1018-psm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">倾向性得分匹配</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1028-did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双重差分法 (DiD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1023-mediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">中介效应分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1054-subgroup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">亚组分析与交互作用</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1056-dag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DAG 因果图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1057-target-trial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">目标试验模拟</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1058-mendelian-randomization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">孟德尔随机化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1060-instrumental-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">工具变量法 (IV)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1059-evalue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E值敏感性分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1065-tmle-doubly-robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TMLE 双重稳健估计</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1066-causalimpact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CausalImpact 时间序列因果</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1076-ipw-weighting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IPW 倒概率加权</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1092-double-machine-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双重机器学习 (DML)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">📐 高级建模</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1127-panel-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">面板数据分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1024-multilevel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多水平模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1025-gam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">广义加性模型 (GAM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1085-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">广义估计方程 (GEE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1086-multiple-imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多重插补</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1087-msm-iptw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">边际结构模型 (MSM) 与 IPTW</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1088-fine-gray.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fine-Gray 竞争风险模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1089-time-varying-cox.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时变协变量 Cox 模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1090-ps-weight-diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">倾向评分权重诊断</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1091-advanced-target-trial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">目标试验模拟进阶</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1032-sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">结构方程模型 (SEM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1097-clpm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交叉滞后面板模型 (CLPM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1031-lca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">潜类别分析 (LCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1098-gbtm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">基于群组的轨迹模型 (GBTM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1039-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">主成分分析 (PCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1126-markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">马尔可夫模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1114-factor-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">因子分析完全指南</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1037-plspm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PLS-PM 路径模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1125-dea-tobit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DEA-Tobit 两阶段模型</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">📈 贝叶斯统计</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1051-bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">贝叶斯统计入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1078-rstanarm-bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rstanarm 贝叶斯回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1111-bayesian-multilevel-negbin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">贝叶斯多层负二项回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1073-prophet-forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">prophet 时间序列预测</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">🎯 模型评估</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1128-questionnaire-validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">问卷信效度分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1052-bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bootstrap与置换检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1047-roc-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROC 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1100-auc-auprc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AUC 与 AUPRC 对比</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1102-dca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">决策曲线分析 (DCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1109-nomogram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">列线图 (Nomogram)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1103-robustness-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">回归模型稳健性分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1048-power-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">样本量计算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1049-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">探索性数据分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">📚 综述方法</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1022-meta-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meta 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1041-network-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网状 Meta 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1029-umbrella-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">伞状综述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1040-scoping-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">范围综述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1124-delphi-method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">德尔菲法</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false">
 <span class="menu-text">🔬 流行病学研究设计</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1115-cross-sectional.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">横截面研究</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1116-cohort-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">队列研究</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1118-case-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">病例对照研究</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1120-rct-design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">随机对照试验 (RCT)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true">
 <span class="menu-text">机器学习与AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false">
 <span class="menu-text">🤖 机器学习框架</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1016-mlr3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mlr3 机器学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1042-tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidymodels 机器学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1101-ml-metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">机器学习预测指标</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1079-kmeans.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">K-means 聚类教程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1094-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KNN 最近邻</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1095-naive-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">朴素贝叶斯</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1096-gbdt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GBDT 梯度提升树</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1068-xgboost.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XGBoost 梯度提升</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1070-fairmetrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">fairmetrics 公平性评估</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1080-random-forest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">随机森林与决策树</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1081-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">支持向量机 (SVM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1082-ensemble-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">集成学习 (Bagging/Stacking)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1083-dimensionality-reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">降维 (PCA/UMAP/t-SNE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1084-anomaly-detection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">无监督异常检测</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1099-nested-cv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">嵌套交叉验证</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false">
 <span class="menu-text">🧠 深度学习</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1044-lstm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LSTM 深度学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1069-torch-deep-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">torch 深度学习</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false">
 <span class="menu-text">🛠️ AI 工具</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5001-opencode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OpenCode AI 编程代理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5002-opencode-skills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OpenCode Skills 技能系统</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5003-ohmyopencode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Oh My OpenCode 增强插件</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5004-opencode-mcp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OpenCode MCP 详解</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5005-opencode-agents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OpenCode Agents 代理系统</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5006-opencode-lsp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OpenCode LSP 语言服务器</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5007-opencode-vs-claude-code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">OpenCode vs Claude Code 对比指南</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="true">
 <span class="menu-text">实用操作</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-22" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false">
 <span class="menu-text">📥 数据导入导出</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-23" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3001-imports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数据导入导出</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3002-datatable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">data.table 完全指南</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3003-dplyr-tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">dplyr/tidyr 数据处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3012-readr-readxl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">readr/readxl - 高效读取</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3013-duckplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">duckplyr - 高性能数据处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3016-tidyverse-pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidyverse vs pandas 对比</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3005-pdf-reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PDF文件读取</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false">
 <span class="menu-text">🧹 数据清洗</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-24" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1046-missing-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">缺失值处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1063-outlier-detection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">异常值检测与处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3014-janitor-cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">janitor 数据清洗实战</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false">
 <span class="menu-text">🔄 数据转换</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-25" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3010-stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">stringr - 字符串处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3009-datetime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">日期时间处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3011-forcats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">forcats - 因子处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3008-regexp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">正则表达式</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false">
 <span class="menu-text">📝 文档写作</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-26" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMarkdown 入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012-quarto-vs-rmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto vs RMarkdown</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false">
 <span class="menu-text">💻 开发环境</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-27" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013-positron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positron IDE 教程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4001-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shiny Web 应用</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3006-reproducible-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">可重复研究工作流</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3004-web-scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网络爬虫入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3007-research-databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">主流科研数据库指南</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="true">
 <span class="menu-text">数据可视化</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-28" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false">
 <span class="menu-text">🏗️ 图形基础</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-29" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2032-ggplot2-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2 可视化入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2033-ggplot2-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2 样式设置详解</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2011-viscolor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">配色方案</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2013-legend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">图例自定义</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2061-base-r-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R 绑图基础</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false">
 <span class="menu-text">🔀 图形组合</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-30" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2012-patchwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">patchwork - 图片拼接</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2021-cowplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">cowplot - 图形组合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2031-bindcomplex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">复杂组合图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 分布图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-31" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2025-bindboxplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">箱线图与小提琴图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2027-bindhistogram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">直方图与密度图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2043-bindjoyplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Joy Plot 山脊图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2041-bindjitter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">抖动图与蜂群图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false">
 <span class="menu-text">📈 趋势图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-32" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2026-bindscatterplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">散点图与趋势线</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2029-bindlineplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">折线图与时间序列</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2069-accessible-linechart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">可访问性折线图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2030-bindareaplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">面积图与堆叠图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2048-bindpeakvalley.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时序峰谷标记图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 比较图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-33" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2028-bindbarchart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">柱状图与饼图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2035-bindlollipop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">棒棒糖图与排序图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2036-binddivergent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">发散型图表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2039-binddumbbell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">哑铃图与坡度图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2047-bindbullet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">子弹图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false">
 <span class="menu-text">🔄 关系图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-34" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2040-bindbubblechart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">气泡图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2042-bindmarginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">边缘分布图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2049-bindcorrplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">相关图矩阵</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2051-bindpairplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">矩阵图与成对图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2057-bindparallel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">平行坐标图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false">
 <span class="menu-text">🎨 特殊图形</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-35" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2037-bindwaffle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">华夫饼图与树形图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2038-bindpyramid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">人口金字塔图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2045-binddonut.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">环形图与甜甜圈图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2044-bindcalendar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">日历热图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2046-bindwaterfall.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">瀑布图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2058-bindmosaic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">马赛克图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false">
 <span class="menu-text">🗺️ 专题图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-36" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2015-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">地图绑制</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2014-sankey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">桑基图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2067-alluvial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">冲积图 (Alluvial)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2066-upset.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">UpSet 多集合交集</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2016-forestplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">森林图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2020-heatmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">热图绑制完全指南</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2024-venn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">韦恩图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2023-radar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">雷达图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 其他图形</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-37" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2050-bindcountplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">计数图与分类图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2052-bindacf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">自相关图 ACF/PACF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2053-bindwordcloud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">词云图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2054-bindnetwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网络关系图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2055-bindgantt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">甘特图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2056-bindfunnel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">漏斗图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2059-bindribbon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">置信区间图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2060-ml-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">机器学习可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2064-gganimate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">动态图表与动画可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2062-interactive-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交互式可视化进阶</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="false">
 <span class="menu-text">✨ 进阶美化</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-38" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2017-ggtext.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggtext - 中英文字体混合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2018-tidyplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidyplots - 极简可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2022-ggally.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GGally - 可视化扩展</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2019-dualaxis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双坐标轴</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2034-ggguides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggguides - 图例简化</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-39" role="navigation" aria-expanded="true">
 <span class="menu-text">特殊应用</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-39" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-39" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-40" role="navigation" aria-expanded="false">
 <span class="menu-text">💰 卫生经济学</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-40" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-40" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1015-health-economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">卫生经济学分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1062-treeage-pro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TreeAge Pro 决策分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-41" role="navigation" aria-expanded="false">
 <span class="menu-text">🔬 质性研究</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-41" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-41" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1030-qualitative-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">质性研究与文本挖掘</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-42" role="navigation" aria-expanded="false">
 <span class="menu-text">📡 信号处理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-42" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-42" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1096-wavelet-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">小波变换 (Wavelet Transform)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1034-nvmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">变分模态分解 (VMD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1035-fft-nvmd-gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FFT + VMD + GMM</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-43" role="navigation" aria-expanded="false">
 <span class="menu-text">🌍 环境流行病学</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-43" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-43" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1033-dlnm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">分布滞后非线性模型 (DLNM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1106-wqs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">加权分位数和回归 (WQS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1107-qgcomp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">分位数 G-计算 (qgcomp)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1108-bkmr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">贝叶斯核机器回归 (BKMR)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-44" role="navigation" aria-expanded="false">
 <span class="menu-text">🔬 建模方法</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-44" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-44" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1110-abm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ABM 基于主体建模</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#方法背景与适用场景" id="toc-方法背景与适用场景" class="nav-link active" data-scroll-target="#方法背景与适用场景">方法背景与适用场景</a>
  <ul class="collapse">
  <li><a href="#什么是距离指标" id="toc-什么是距离指标" class="nav-link" data-scroll-target="#什么是距离指标">什么是距离指标？</a></li>
  <li><a href="#核心应用场景" id="toc-核心应用场景" class="nav-link" data-scroll-target="#核心应用场景">核心应用场景</a></li>
  <li><a href="#常见距离指标对比" id="toc-常见距离指标对比" class="nav-link" data-scroll-target="#常见距离指标对比">常见距离指标对比</a></li>
  </ul></li>
  <li><a href="#核心概念与模型入门" id="toc-核心概念与模型入门" class="nav-link" data-scroll-target="#核心概念与模型入门">核心概念与模型入门</a>
  <ul class="collapse">
  <li><a href="#基础数学定义" id="toc-基础数学定义" class="nav-link" data-scroll-target="#基础数学定义">基础数学定义</a></li>
  <li><a href="#欧氏距离-euclidean-distance" id="toc-欧氏距离-euclidean-distance" class="nav-link" data-scroll-target="#欧氏距离-euclidean-distance">1. 欧氏距离 (Euclidean Distance)</a></li>
  <li><a href="#曼哈顿距离-manhattan-distance" id="toc-曼哈顿距离-manhattan-distance" class="nav-link" data-scroll-target="#曼哈顿距离-manhattan-distance">2. 曼哈顿距离 (Manhattan Distance)</a></li>
  <li><a href="#切比雪夫距离-chebyshev-distance" id="toc-切比雪夫距离-chebyshev-distance" class="nav-link" data-scroll-target="#切比雪夫距离-chebyshev-distance">3. 切比雪夫距离 (Chebyshev Distance)</a></li>
  <li><a href="#闵可夫斯基距离-minkowski-distance" id="toc-闵可夫斯基距离-minkowski-distance" class="nav-link" data-scroll-target="#闵可夫斯基距离-minkowski-distance">4. 闵可夫斯基距离 (Minkowski Distance)</a></li>
  <li><a href="#马氏距离-mahalanobis-distance" id="toc-马氏距离-mahalanobis-distance" class="nav-link" data-scroll-target="#马氏距离-mahalanobis-distance">5. 马氏距离 (Mahalanobis Distance)</a></li>
  <li><a href="#余弦相似度-cosine-similarity" id="toc-余弦相似度-cosine-similarity" class="nav-link" data-scroll-target="#余弦相似度-cosine-similarity">6. 余弦相似度 (Cosine Similarity)</a></li>
  <li><a href="#汉明距离-hamming-distance" id="toc-汉明距离-hamming-distance" class="nav-link" data-scroll-target="#汉明距离-hamming-distance">7. 汉明距离 (Hamming Distance)</a></li>
  <li><a href="#jaccard-距离-jaccard-distance" id="toc-jaccard-距离-jaccard-distance" class="nav-link" data-scroll-target="#jaccard-距离-jaccard-distance">8. Jaccard 距离 (Jaccard Distance)</a></li>
  <li><a href="#相关距离-correlation-distance" id="toc-相关距离-correlation-distance" class="nav-link" data-scroll-target="#相关距离-correlation-distance">9. 相关距离 (Correlation Distance)</a></li>
  </ul></li>
  <li><a href="#模型假设与前提条件" id="toc-模型假设与前提条件" class="nav-link" data-scroll-target="#模型假设与前提条件">模型假设与前提条件</a>
  <ul class="collapse">
  <li><a href="#各距离指标的假设" id="toc-各距离指标的假设" class="nav-link" data-scroll-target="#各距离指标的假设">各距离指标的假设</a></li>
  <li><a href="#关键假设与检验" id="toc-关键假设与检验" class="nav-link" data-scroll-target="#关键假设与检验">关键假设与检验</a></li>
  <li><a href="#如何选择合适的距离指标" id="toc-如何选择合适的距离指标" class="nav-link" data-scroll-target="#如何选择合适的距离指标">如何选择合适的距离指标</a></li>
  </ul></li>
  <li><a href="#数据准备" id="toc-数据准备" class="nav-link" data-scroll-target="#数据准备">数据准备</a>
  <ul class="collapse">
  <li><a href="#模拟数据集" id="toc-模拟数据集" class="nav-link" data-scroll-target="#模拟数据集">模拟数据集</a></li>
  <li><a href="#数据探索" id="toc-数据探索" class="nav-link" data-scroll-target="#数据探索">数据探索</a></li>
  </ul></li>
  <li><a href="#完整分析流程" id="toc-完整分析流程" class="nav-link" data-scroll-target="#完整分析流程">完整分析流程</a>
  <ul class="collapse">
  <li><a href="#步骤1计算两点间的各种距离" id="toc-步骤1计算两点间的各种距离" class="nav-link" data-scroll-target="#步骤1计算两点间的各种距离">步骤1：计算两点间的各种距离</a></li>
  <li><a href="#步骤2使用-r-包计算距离矩阵" id="toc-步骤2使用-r-包计算距离矩阵" class="nav-link" data-scroll-target="#步骤2使用-r-包计算距离矩阵">步骤2：使用 R 包计算距离矩阵</a></li>
  <li><a href="#步骤3马氏距离计算特殊处理" id="toc-步骤3马氏距离计算特殊处理" class="nav-link" data-scroll-target="#步骤3马氏距离计算特殊处理">步骤3：马氏距离计算（特殊处理）</a></li>
  <li><a href="#步骤4余弦相似度计算" id="toc-步骤4余弦相似度计算" class="nav-link" data-scroll-target="#步骤4余弦相似度计算">步骤4：余弦相似度计算</a></li>
  <li><a href="#步骤5汉明距离计算二值数据" id="toc-步骤5汉明距离计算二值数据" class="nav-link" data-scroll-target="#步骤5汉明距离计算二值数据">步骤5：汉明距离计算（二值数据）</a></li>
  <li><a href="#步骤6jaccard-距离计算" id="toc-步骤6jaccard-距离计算" class="nav-link" data-scroll-target="#步骤6jaccard-距离计算">步骤6：Jaccard 距离计算</a></li>
  <li><a href="#步骤7距离指标比较与可视化" id="toc-步骤7距离指标比较与可视化" class="nav-link" data-scroll-target="#步骤7距离指标比较与可视化">步骤7：距离指标比较与可视化</a></li>
  <li><a href="#步骤8聚类分析应用" id="toc-步骤8聚类分析应用" class="nav-link" data-scroll-target="#步骤8聚类分析应用">步骤8：聚类分析应用</a></li>
  <li><a href="#步骤9k-近邻分类器应用" id="toc-步骤9k-近邻分类器应用" class="nav-link" data-scroll-target="#步骤9k-近邻分类器应用">步骤9：K-近邻分类器应用</a></li>
  </ul></li>
  <li><a href="#结果解读与报告" id="toc-结果解读与报告" class="nav-link" data-scroll-target="#结果解读与报告">结果解读与报告</a>
  <ul class="collapse">
  <li><a href="#距离指标的统计意义" id="toc-距离指标的统计意义" class="nav-link" data-scroll-target="#距离指标的统计意义">距离指标的统计意义</a></li>
  <li><a href="#论文报告格式" id="toc-论文报告格式" class="nav-link" data-scroll-target="#论文报告格式">论文报告格式</a></li>
  </ul></li>
  <li><a href="#常见错误与纠偏" id="toc-常见错误与纠偏" class="nav-link" data-scroll-target="#常见错误与纠偏">常见错误与纠偏</a>
  <ul class="collapse">
  <li><a href="#错误1未标准化数据直接计算欧氏距离" id="toc-错误1未标准化数据直接计算欧氏距离" class="nav-link" data-scroll-target="#错误1未标准化数据直接计算欧氏距离">错误1：未标准化数据直接计算欧氏距离</a></li>
  <li><a href="#错误2在高度相关变量上使用欧氏距离" id="toc-错误2在高度相关变量上使用欧氏距离" class="nav-link" data-scroll-target="#错误2在高度相关变量上使用欧氏距离">错误2：在高度相关变量上使用欧氏距离</a></li>
  <li><a href="#错误3马氏距离协方差矩阵奇异" id="toc-错误3马氏距离协方差矩阵奇异" class="nav-link" data-scroll-target="#错误3马氏距离协方差矩阵奇异">错误3：马氏距离协方差矩阵奇异</a></li>
  <li><a href="#错误4余弦相似度用于比较零向量" id="toc-错误4余弦相似度用于比较零向量" class="nav-link" data-scroll-target="#错误4余弦相似度用于比较零向量">错误4：余弦相似度用于比较零向量</a></li>
  <li><a href="#错误5汉明距离用于连续变量" id="toc-错误5汉明距离用于连续变量" class="nav-link" data-scroll-target="#错误5汉明距离用于连续变量">错误5：汉明距离用于连续变量</a></li>
  <li><a href="#错误6忽略距离指标的尺度差异" id="toc-错误6忽略距离指标的尺度差异" class="nav-link" data-scroll-target="#错误6忽略距离指标的尺度差异">错误6：忽略距离指标的尺度差异</a></li>
  <li><a href="#错误7knn-中-k-值选择不当" id="toc-错误7knn-中-k-值选择不当" class="nav-link" data-scroll-target="#错误7knn-中-k-值选择不当">错误7：KNN 中 k 值选择不当</a></li>
  </ul></li>
  <li><a href="#进阶扩展" id="toc-进阶扩展" class="nav-link" data-scroll-target="#进阶扩展">进阶扩展</a>
  <ul class="collapse">
  <li><a href="#动态时间规整-dtw-距离" id="toc-动态时间规整-dtw-距离" class="nav-link" data-scroll-target="#动态时间规整-dtw-距离">1. 动态时间规整 (DTW) 距离</a></li>
  <li><a href="#堡垒距离-bhattacharyya-distance" id="toc-堡垒距离-bhattacharyya-distance" class="nav-link" data-scroll-target="#堡垒距离-bhattacharyya-distance">2. 堡垒距离 (Bhattacharyya Distance)</a></li>
  <li><a href="#earth-movers-distance-emd" id="toc-earth-movers-distance-emd" class="nav-link" data-scroll-target="#earth-movers-distance-emd">3. Earth Mover’s Distance (EMD)</a></li>
  <li><a href="#自定义距离函数" id="toc-自定义距离函数" class="nav-link" data-scroll-target="#自定义距离函数">4. 自定义距离函数</a></li>
  <li><a href="#高维数据的距离度量" id="toc-高维数据的距离度量" class="nav-link" data-scroll-target="#高维数据的距离度量">5. 高维数据的距离度量</a></li>
  <li><a href="#距离学习的应用" id="toc-距离学习的应用" class="nav-link" data-scroll-target="#距离学习的应用">6. 距离学习的应用</a></li>
  <li><a href="#推荐阅读" id="toc-推荐阅读" class="nav-link" data-scroll-target="#推荐阅读">推荐阅读</a></li>
  </ul></li>
  <li><a href="#总结" id="toc-总结" class="nav-link" data-scroll-target="#总结">总结</a>
  <ul class="collapse">
  <li><a href="#核心要点" id="toc-核心要点" class="nav-link" data-scroll-target="#核心要点">核心要点</a></li>
  <li><a href="#距离指标速查表" id="toc-距离指标速查表" class="nav-link" data-scroll-target="#距离指标速查表">距离指标速查表</a></li>
  </ul></li>
  <li><a href="#参考文献" id="toc-参考文献" class="nav-link" data-scroll-target="#参考文献">参考文献</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">常见距离指标完整指南：从欧氏到马氏距离</h1>
<p class="subtitle lead">数据分析中的相似度度量方法</p>
  <div class="quarto-categories">
    <div class="quarto-category">统计分析方法</div>
    <div class="quarto-category">基础统计</div>
  </div>
  </div>

<div>
  <div class="description">
    系统介绍常见距离指标的计算原理、适用场景及 R 语言实现
  </div>
</div>


<div class="quarto-title-meta column-body">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 25, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="方法背景与适用场景" class="level2">
<h2 class="anchored" data-anchor-id="方法背景与适用场景">方法背景与适用场景</h2>
<section id="什么是距离指标" class="level3">
<h3 class="anchored" data-anchor-id="什么是距离指标">什么是距离指标？</h3>
<p><strong>零基础通俗解释</strong>：想象你在地图上规划路线。从一个点到另一个点，可以走直线（欧氏距离），也可以沿着街道网格走（曼哈顿距离）。在数据分析中，“距离”就是衡量两个数据点”有多像”或”有多远”的方法。距离越小，说明两个对象越相似。</p>
</section>
<section id="核心应用场景" class="level3">
<h3 class="anchored" data-anchor-id="核心应用场景">核心应用场景</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>应用场景</th>
<th>典型方法</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>聚类分析</strong></td>
<td>欧氏、曼哈顿</td>
<td>K-means、层次聚类</td>
</tr>
<tr class="even">
<td><strong>分类算法</strong></td>
<td>欧氏、马氏</td>
<td>K-近邻分类器</td>
</tr>
<tr class="odd">
<td><strong>异常检测</strong></td>
<td>马氏距离、欧氏</td>
<td>多变量异常值识别</td>
</tr>
<tr class="even">
<td><strong>降维分析</strong></td>
<td>欧氏</td>
<td>PCA、t-SNE</td>
</tr>
<tr class="odd">
<td><strong>文本分析</strong></td>
<td>余弦相似度、Jaccard</td>
<td>文档相似度计算</td>
</tr>
<tr class="even">
<td><strong>图像识别</strong></td>
<td>欧氏、汉明距离</td>
<td>特征向量匹配</td>
</tr>
<tr class="odd">
<td><strong>推荐系统</strong></td>
<td>余弦相似度</td>
<td>用户行为相似性</td>
</tr>
<tr class="even">
<td><strong>相关性分析</strong></td>
<td>相关距离</td>
<td>变量关系度量</td>
</tr>
</tbody>
</table>
</section>
<section id="常见距离指标对比" class="level3">
<h3 class="anchored" data-anchor-id="常见距离指标对比">常见距离指标对比</h3>
<p><img src="images/diagrams/stat-distance-metrics-comparison.svg" class="img-fluid"></p>
</section>
</section>
<section id="核心概念与模型入门" class="level2">
<h2 class="anchored" data-anchor-id="核心概念与模型入门">核心概念与模型入门</h2>
<section id="基础数学定义" class="level3">
<h3 class="anchored" data-anchor-id="基础数学定义">基础数学定义</h3>
<p>对于两个 <span class="math inline">\(d\)</span> 维向量 <span class="math inline">\(\mathbf{x} = (x_1, x_2, \ldots, x_d)\)</span> 和 <span class="math inline">\(\mathbf{y} = (y_1, y_2, \ldots, y_d)\)</span>：</p>
</section>
<section id="欧氏距离-euclidean-distance" class="level3">
<h3 class="anchored" data-anchor-id="欧氏距离-euclidean-distance">1. 欧氏距离 (Euclidean Distance)</h3>
<p><strong>直观理解</strong>：两点间的直线距离，就像用直尺测量。</p>
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = \sqrt{\sum_{i=1}^{d} (x_i - y_i)^2}\]</span></p>
<p><strong>特点</strong>： - 最常用的距离度量 - 适用于各维度量纲一致的数据 - 对异常值敏感</p>
</section>
<section id="曼哈顿距离-manhattan-distance" class="level3">
<h3 class="anchored" data-anchor-id="曼哈顿距离-manhattan-distance">2. 曼哈顿距离 (Manhattan Distance)</h3>
<p><strong>直观理解</strong>：城市街区距离，只能沿坐标轴方向移动。</p>
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = \sum_{i=1}^{d} |x_i - y_i|\]</span></p>
<p><strong>特点</strong>： - 对异常值比欧氏距离更稳健 - 适用于网格化数据（如城市地图）</p>
</section>
<section id="切比雪夫距离-chebyshev-distance" class="level3">
<h3 class="anchored" data-anchor-id="切比雪夫距离-chebyshev-distance">3. 切比雪夫距离 (Chebyshev Distance)</h3>
<p><strong>直观理解</strong>：国际象棋中”王”的移动方式，每次可以在任意方向移动一格。</p>
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = \max_{1 \leq i \leq d} |x_i - y_i|\]</span></p>
<p><strong>特点</strong>： - 只关心最大差异维度 - 适用于需要捕捉极端差异的场景</p>
</section>
<section id="闵可夫斯基距离-minkowski-distance" class="level3">
<h3 class="anchored" data-anchor-id="闵可夫斯基距离-minkowski-distance">4. 闵可夫斯基距离 (Minkowski Distance)</h3>
<p><strong>直观理解</strong>：欧氏和曼哈顿距离的推广，通过参数 <span class="math inline">\(p\)</span> 调整。</p>
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = \left(\sum_{i=1}^{d} |x_i - y_i|^p\right)^{1/p}\]</span></p>
<p><strong>特殊情况</strong>： - <span class="math inline">\(p = 1\)</span>：曼哈顿距离 - <span class="math inline">\(p = 2\)</span>：欧氏距离 - <span class="math inline">\(p = \infty\)</span>：切比雪夫距离</p>
</section>
<section id="马氏距离-mahalanobis-distance" class="level3">
<h3 class="anchored" data-anchor-id="马氏距离-mahalanobis-distance">5. 马氏距离 (Mahalanobis Distance)</h3>
<p><strong>直观理解</strong>：考虑变量间相关性和方差的”统计距离”。就像在拥挤的房间里找”远”的人，不是看物理距离，而是看”反常程度”。</p>
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = \sqrt{(\mathbf{x} - \mathbf{y})^T \mathbf{S}^{-1} (\mathbf{x} - \mathbf{y})}\]</span></p>
<p>其中 <span class="math inline">\(\mathbf{S}\)</span> 是协方差矩阵。</p>
<p><strong>特点</strong>： - 自动标准化数据 - 考虑变量间相关性 - 对异常值检测更准确</p>
<p><img src="images/diagrams/stat-mahalanobis-visualization.svg" class="img-fluid"></p>
</section>
<section id="余弦相似度-cosine-similarity" class="level3">
<h3 class="anchored" data-anchor-id="余弦相似度-cosine-similarity">6. 余弦相似度 (Cosine Similarity)</h3>
<p><strong>直观理解</strong>：衡量两个向量的方向相似性，不考虑长度差异。就像比较两支笔的朝向，不管长短。</p>
<p><span class="math display">\[\text{similarity}(\mathbf{x}, \mathbf{y}) = \cos(\theta) = \frac{\mathbf{x} \cdot \mathbf{y}}{\|\mathbf{x}\| \|\mathbf{y}\|} = \frac{\sum_{i=1}^{d} x_i y_i}{\sqrt{\sum_{i=1}^{d} x_i^2} \sqrt{\sum_{i=1}^{d} y_i^2}}\]</span></p>
<p><strong>特点</strong>： - 范围在 <span class="math inline">\([-1, 1]\)</span> 之间 - 适合文本分析、推荐系统 - 对向量长度不敏感</p>
</section>
<section id="汉明距离-hamming-distance" class="level3">
<h3 class="anchored" data-anchor-id="汉明距离-hamming-distance">7. 汉明距离 (Hamming Distance)</h3>
<p><strong>直观理解</strong>：两个字符串有多少个位置不同。比如 “kitten” 和 “sitting” 有 3 个不同。</p>
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = \sum_{i=1}^{d} I(x_i \neq y_i)\]</span></p>
<p>其中 <span class="math inline">\(I(\cdot)\)</span> 是指示函数。</p>
<p><strong>特点</strong>： - 只适用于离散数据 - 常用于字符串比较、错误检测</p>
</section>
<section id="jaccard-距离-jaccard-distance" class="level3">
<h3 class="anchored" data-anchor-id="jaccard-距离-jaccard-distance">8. Jaccard 距离 (Jaccard Distance)</h3>
<p><strong>直观理解</strong>：衡量两个集合的相似性，基于交集和并集。</p>
<p><span class="math display">\[d(A, B) = 1 - \frac{|A \cap B|}{|A \cup B|} = 1 - \text{Jaccard 相似系数}\]</span></p>
<p><strong>特点</strong>： - 范围在 <span class="math inline">\([0, 1]\)</span> 之间 - 适用于集合数据、二元特征 - 常用于文本相似度（单词集合）</p>
</section>
<section id="相关距离-correlation-distance" class="level3">
<h3 class="anchored" data-anchor-id="相关距离-correlation-distance">9. 相关距离 (Correlation Distance)</h3>
<p><strong>直观理解</strong>：基于相关系数的距离。</p>
<p><span class="math display">\[d(\mathbf{x}, \mathbf{y}) = 1 - \text{corr}(\mathbf{x}, \mathbf{y})\]</span></p>
<p><strong>特点</strong>： - 范围在 <span class="math inline">\([0, 2]\)</span> 之间 - 适合衡量变量间的模式相似性 - 基因表达分析常用</p>
</section>
</section>
<section id="模型假设与前提条件" class="level2">
<h2 class="anchored" data-anchor-id="模型假设与前提条件">模型假设与前提条件</h2>
<section id="各距离指标的假设" class="level3">
<h3 class="anchored" data-anchor-id="各距离指标的假设">各距离指标的假设</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>距离指标假设与特性对比</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">距离指标</th>
<th style="text-align: left;">数据类型</th>
<th style="text-align: left;">量纲要求</th>
<th style="text-align: left;">相关性考虑</th>
<th style="text-align: left;">异常值敏感度</th>
<th style="text-align: left;">计算复杂度</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">欧氏距离</td>
<td style="text-align: left;">连续型</td>
<td style="text-align: left;">需标准化</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">高</td>
<td style="text-align: left;">O(d)</td>
</tr>
<tr class="even">
<td style="text-align: left;">曼哈顿距离</td>
<td style="text-align: left;">连续型/有序</td>
<td style="text-align: left;">建议标准化</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">中</td>
<td style="text-align: left;">O(d)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">马氏距离</td>
<td style="text-align: left;">连续型</td>
<td style="text-align: left;">自动标准化</td>
<td style="text-align: left;">是</td>
<td style="text-align: left;">低</td>
<td style="text-align: left;">O(d²)</td>
</tr>
<tr class="even">
<td style="text-align: left;">余弦相似度</td>
<td style="text-align: left;">连续型/离散</td>
<td style="text-align: left;">不需标准化</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">中</td>
<td style="text-align: left;">O(d)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">汉明距离</td>
<td style="text-align: left;">离散型/二值</td>
<td style="text-align: left;">无</td>
<td style="text-align: left;">否</td>
<td style="text-align: left;">低</td>
<td style="text-align: left;">O(d)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="关键假设与检验" class="level3">
<h3 class="anchored" data-anchor-id="关键假设与检验">关键假设与检验</h3>
<section id="数据标准化对于欧氏曼哈顿距离" class="level4">
<h4 class="anchored" data-anchor-id="数据标准化对于欧氏曼哈顿距离">1. 数据标准化（对于欧氏、曼哈顿距离）</h4>
<p><strong>假设</strong>：各维度具有相同的量纲和尺度。</p>
<p><strong>检验方法</strong>： - 检查各变量的均值和方差 - 绘制箱线图查看分布差异</p>
<p><strong>违背后果</strong>： - 量纲大的变量主导距离计算 - 结果被某些维度”绑架”</p>
</section>
<section id="马氏距离的协方差矩阵正定性" class="level4">
<h4 class="anchored" data-anchor-id="马氏距离的协方差矩阵正定性">2. 马氏距离的协方差矩阵正定性</h4>
<p><strong>假设</strong>：协方差矩阵是可逆的（正定矩阵）。</p>
<p><strong>检验方法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查协方差矩阵是否正定</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>is_positive_definite <span class="ot">&lt;-</span> <span class="cf">function</span>(S) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(S, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>values</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">all</span>(eigenvalues <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>违背后果</strong>： - 无法计算逆矩阵 - 存在完全线性相关的变量</p>
</section>
<section id="余弦相似度的向量非零假设" class="level4">
<h4 class="anchored" data-anchor-id="余弦相似度的向量非零假设">3. 余弦相似度的向量非零假设</h4>
<p><strong>假设</strong>：向量长度不为零。</p>
<p><strong>违背后果</strong>： - 分母为零，无法计算 - 需要特殊处理零向量</p>
</section>
</section>
<section id="如何选择合适的距离指标" class="level3">
<h3 class="anchored" data-anchor-id="如何选择合适的距离指标">如何选择合适的距离指标</h3>
<p><img src="images/diagrams/stat-distance-selection-flowchart.svg" class="img-fluid"></p>
<p><strong>选择指南</strong>：</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>数据特征</th>
<th>推荐距离</th>
<th>理由</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>连续变量、量纲一致</td>
<td>欧氏距离</td>
<td>直观、计算简单</td>
</tr>
<tr class="even">
<td>连续变量、存在异常值</td>
<td>曼哈顿距离</td>
<td>更稳健</td>
</tr>
<tr class="odd">
<td>变量间有相关性</td>
<td>马氏距离</td>
<td>考虑协方差</td>
</tr>
<tr class="even">
<td>文本数据、向量长度差异大</td>
<td>余弦相似度</td>
<td>关注方向</td>
</tr>
<tr class="odd">
<td>分类/二值数据</td>
<td>汉明/Jaccard</td>
<td>专门设计</td>
</tr>
<tr class="even">
<td>网格化数据</td>
<td>曼哈顿/切比雪夫</td>
<td>符合物理意义</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="数据准备" class="level2">
<h2 class="anchored" data-anchor-id="数据准备">数据准备</h2>
<section id="模拟数据集" class="level3">
<h3 class="anchored" data-anchor-id="模拟数据集">模拟数据集</h3>
<p>让我们创建一个包含多种类型特征的模拟数据集：</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置随机种子</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2026</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 基础数据：连续型变量</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 样本量</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">5</span>    <span class="co"># 维度</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成具有相关性的多元正态数据</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">165</span>, <span class="dv">70</span>, <span class="dv">120</span>, <span class="dv">80</span>)  <span class="co"># 均值向量</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>,  <span class="dv">15</span>,   <span class="dv">8</span>,   <span class="dv">5</span>,   <span class="dv">6</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="dv">15</span>,  <span class="dv">25</span>,  <span class="dv">12</span>,   <span class="dv">7</span>,   <span class="dv">8</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>   <span class="dv">8</span>,  <span class="dv">12</span>,   <span class="dv">9</span>,   <span class="dv">4</span>,   <span class="dv">5</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>   <span class="dv">5</span>,   <span class="dv">7</span>,   <span class="dv">4</span>,   <span class="dv">3</span>,   <span class="dv">3</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>   <span class="dv">6</span>,   <span class="dv">8</span>,   <span class="dv">5</span>,   <span class="dv">3</span>,   <span class="dv">4</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加一些噪声确保正定性</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> Sigma <span class="sc">+</span> <span class="fu">diag</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>data_continuous <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, Sigma)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_continuous) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"体重(kg)"</span>, <span class="st">"身高(cm)"</span>, <span class="st">"年龄"</span>, <span class="st">"收缩压"</span>, <span class="st">"舒张压"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 标准化数据（用于距离计算）</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> <span class="fu">scale</span>(data_continuous)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 添加类别标签</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_scaled)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>data_scaled<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 创建二值数据（用于汉明/Jaccard距离）</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>binary_data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, n <span class="sc">*</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>), n, <span class="dv">10</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(binary_data) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Feature_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 创建文本向量（用于余弦相似度）</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>text_vectors <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="dv">20</span>), n, <span class="dv">20</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(text_vectors) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Word_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示前几行</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_scaled)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    体重(kg)    身高(cm)       年龄     收缩压       舒张压 group
1  0.5625007  0.85569713  0.2312359  0.1946672 -0.020956788     C
2 -0.8688507 -1.12414343 -0.6888472 -0.6410958 -0.613525568     C
3  0.0816926  0.20111741  0.4367446  0.4801330  0.137072839     C
4 -0.2657137 -0.09761617  0.9571904 -0.8129577 -0.006108138     C
5 -0.7442774 -0.34143255 -0.7451297 -0.4678319 -0.906597170     C
6 -2.2723667 -2.38384409 -2.6802320 -1.3709673 -1.677314794     C</code></pre>
</div>
</div>
</section>
<section id="数据探索" class="level3">
<h3 class="anchored" data-anchor-id="数据探索">数据探索</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看数据结构</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data_scaled)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  6 variables:
 $ 体重(kg): num  0.5625 -0.8689 0.0817 -0.2657 -0.7443 ...
 $ 身高(cm): num  0.8557 -1.1241 0.2011 -0.0976 -0.3414 ...
 $ 年龄    : num  0.231 -0.689 0.437 0.957 -0.745 ...
 $ 收缩压  : num  0.195 -0.641 0.48 -0.813 -0.468 ...
 $ 舒张压  : num  -0.02096 -0.61353 0.13707 -0.00611 -0.9066 ...
 $ group   : chr  "C" "C" "C" "C" ...</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看各变量分布</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_scaled[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    体重(kg)          身高(cm)              年龄              收缩压        
 Min.   :-2.5394   Min.   :-2.554252   Min.   :-2.68023   Min.   :-1.94885  
 1st Qu.:-0.6964   1st Qu.:-0.741448   1st Qu.:-0.70556   1st Qu.:-0.80144  
 Median :-0.1038   Median : 0.003071   Median : 0.03906   Median : 0.07783  
 Mean   : 0.0000   Mean   : 0.000000   Mean   : 0.00000   Mean   : 0.00000  
 3rd Qu.: 0.6068   3rd Qu.: 0.660840   3rd Qu.: 0.67801   3rd Qu.: 0.59737  
 Max.   : 2.3221   Max.   : 2.365275   Max.   : 2.64081   Max.   : 2.40411  
     舒张压       
 Min.   :-2.3585  
 1st Qu.:-0.6619  
 Median :-0.1132  
 Mean   : 0.0000  
 3rd Qu.: 0.6835  
 Max.   : 2.6439  </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查变量相关性</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data_scaled[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cor_matrix, <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         体重(kg) 身高(cm) 年龄 收缩压 舒张压
体重(kg)     1.00     0.96 0.85   0.87   0.94
身高(cm)     0.96     1.00 0.81   0.78   0.84
年龄         0.85     0.81 1.00   0.75   0.87
收缩压       0.87     0.78 0.75   1.00   0.82
舒张压       0.94     0.84 0.87   0.82   1.00</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化相关性</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>cor_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(cor_matrix)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cor_melt, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(value, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">mid =</span> <span class="st">"white"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limit =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>, <span class="at">fill =</span> <span class="st">"相关系数"</span>) <span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="1100-distance-metrics_files/figure-html/correlation-heatmap-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>变量相关性热图</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="完整分析流程" class="level2">
<h2 class="anchored" data-anchor-id="完整分析流程">完整分析流程</h2>
<section id="步骤1计算两点间的各种距离" class="level3">
<h3 class="anchored" data-anchor-id="步骤1计算两点间的各种距离">步骤1：计算两点间的各种距离</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择两个样本点</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>point_a <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_scaled[<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>point_b <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_scaled[<span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"点A:"</span>, <span class="fu">round</span>(point_a, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>点A: 0.563 0.856 0.231 0.195 -0.021</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"点B:"</span>, <span class="fu">round</span>(point_b, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>点B: -0.869 -1.124 -0.689 -0.641 -0.614</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 欧氏距离</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>euclidean_dist <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((point_a <span class="sc">-</span> point_b)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. 欧氏距离:"</span>, <span class="fu">round</span>(euclidean_dist, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol type="1">
<li>欧氏距离: 2.8044</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 曼哈顿距离</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>manhattan_dist <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(point_a <span class="sc">-</span> point_b))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. 曼哈顿距离:"</span>, <span class="fu">round</span>(manhattan_dist, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="2" type="1">
<li>曼哈顿距离: 5.7596</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 切比雪夫距离</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>chebyshev_dist <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">abs</span>(point_a <span class="sc">-</span> point_b))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. 切比雪夫距离:"</span>, <span class="fu">round</span>(chebyshev_dist, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="3" type="1">
<li>切比雪夫距离: 1.9798</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 闵可夫斯基距离（p=1.5）</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>minkowski_dist <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(point_a <span class="sc">-</span> point_b)<span class="sc">^</span><span class="fl">1.5</span>)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.5</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. 闵可夫斯基距离(p=1.5):"</span>, <span class="fu">round</span>(minkowski_dist, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="4" type="1">
<li>闵可夫斯基距离(p=1.5): 3.5189</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 马氏距离</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cov</span>(data_scaled[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>mahalanobis_dist <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(<span class="fu">t</span>(point_a <span class="sc">-</span> point_b) <span class="sc">%*%</span> <span class="fu">solve</span>(S) <span class="sc">%*%</span> (point_a <span class="sc">-</span> point_b)))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"5. 马氏距离:"</span>, <span class="fu">round</span>(mahalanobis_dist, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="5" type="1">
<li>马氏距离: 2.8105</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. 余弦相似度（转换为距离）</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cosine_sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(point_a <span class="sc">*</span> point_b) <span class="sc">/</span> (<span class="fu">sqrt</span>(<span class="fu">sum</span>(point_a<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(point_b<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>cosine_dist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> cosine_sim</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"6. 余弦距离(1-相似度):"</span>, <span class="fu">round</span>(cosine_dist, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="6" type="1">
<li>余弦距离(1-相似度): 1.8902</li>
</ol>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"   余弦相似度:"</span>, <span class="fu">round</span>(cosine_sim, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>余弦相似度: -0.8902</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. 相关距离</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cor_dist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">cor</span>(point_a, point_b)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"7. 相关距离:"</span>, <span class="fu">round</span>(cor_dist, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<ol start="7" type="1">
<li>相关距离: 1.9755</li>
</ol>
</section>
<section id="步骤2使用-r-包计算距离矩阵" class="level3">
<h3 class="anchored" data-anchor-id="步骤2使用-r-包计算距离矩阵">步骤2：使用 R 包计算距离矩阵</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建数据矩阵</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data_scaled[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 使用 stats 包计算欧氏距离</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>euclidean_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_matrix, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 计算曼哈顿距离</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>manhattan_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_matrix, <span class="at">method =</span> <span class="st">"manhattan"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 计算最大距离（切比雪夫）</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>maximum_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_matrix, <span class="at">method =</span> <span class="st">"maximum"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 计算闵可夫斯基距离（p=1.5）</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>minkowski_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_matrix, <span class="at">method =</span> <span class="st">"minkowski"</span>, <span class="at">p =</span> <span class="fl">1.5</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看距离矩阵（前10×10）</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">as.matrix</span>(euclidean_matrix)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1    2    3    4    5    6    7    8    9   10
1  0.00 2.80 0.90 1.77 2.31 5.67 2.25 3.49 1.25 1.91
2  2.80 0.00 2.40 2.13 0.86 3.03 1.09 1.59 2.53 1.80
3  0.90 2.40 0.00 1.47 2.09 5.35 1.67 3.44 0.73 1.31
4  1.77 2.13 1.47 0.00 2.03 5.06 1.37 2.82 1.21 1.80
5  2.31 0.86 2.09 2.03 0.00 3.41 1.28 1.60 2.41 1.91
6  5.67 3.03 5.35 5.06 3.41 0.00 4.02 2.80 5.55 4.61
7  2.25 1.09 1.67 1.37 1.28 4.02 0.00 2.39 1.75 1.47
8  3.49 1.59 3.44 2.82 1.60 2.80 2.39 0.00 3.54 3.05
9  1.25 2.53 0.73 1.21 2.41 5.55 1.75 3.54 0.00 1.26
10 1.91 1.80 1.31 1.80 1.91 4.61 1.47 3.05 1.26 0.00</code></pre>
</div>
</div>
</section>
<section id="步骤3马氏距离计算特殊处理" class="level3">
<h3 class="anchored" data-anchor-id="步骤3马氏距离计算特殊处理">步骤3：马氏距离计算（特殊处理）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个点到中心的马氏距离</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>data_center <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(data_matrix)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>mahalanobis_all <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(data_matrix, data_center, <span class="fu">cov</span>(data_matrix))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 按马氏距离排序</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>mahalanobis_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Index =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mahalanobis_Distance =</span> mahalanobis_all,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> data_scaled<span class="sc">$</span>group</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>mahalanobis_df <span class="ot">&lt;-</span> mahalanobis_df[<span class="fu">order</span>(mahalanobis_df<span class="sc">$</span>Mahalanobis_Distance, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示马氏距离最大的5个点</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mahalanobis_df, <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Index Mahalanobis_Distance Group
22    22            14.329026     C
6      6            14.046073     C
93    93            12.197886     C
77    77             9.410634     C
15    15             9.382263     B</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化马氏距离分布</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mahalanobis_df, <span class="fu">aes</span>(<span class="at">x =</span> Mahalanobis_Distance)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qchisq</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">5</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fu">qchisq</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">5</span>), <span class="at">y =</span> <span class="dv">8</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">"97.5% 分位数</span><span class="sc">\n</span><span class="st">(潜在异常值)"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"马氏距离"</span>, <span class="at">y =</span> <span class="st">"频数"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"马氏距离分布与异常值检测"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"95% 置信区间阈值:"</span>, <span class="fu">round</span>(<span class="fu">qchisq</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">5</span>), <span class="dv">2</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="1100-distance-metrics_files/figure-html/mahalanobis-plot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>马氏距离分布</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="步骤4余弦相似度计算" class="level3">
<h3 class="anchored" data-anchor-id="步骤4余弦相似度计算">步骤4：余弦相似度计算</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算所有文本向量之间的余弦相似度</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cosine_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cosine_matrix) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(cosine_matrix) <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>n</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> i<span class="sc">:</span>n) {</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    sim <span class="ot">&lt;-</span> <span class="fu">sum</span>(text_vectors[i, ] <span class="sc">*</span> text_vectors[j, ]) <span class="sc">/</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>           (<span class="fu">sqrt</span>(<span class="fu">sum</span>(text_vectors[i, ]<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(text_vectors[j, ]<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    cosine_matrix[i, j] <span class="ot">&lt;-</span> cosine_matrix[j, i] <span class="ot">&lt;-</span> sim</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 转换为距离</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>cosine_distance_matrix <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> cosine_matrix</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示部分相似度矩阵</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cosine_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1      2      3      4      5
1  1.000  0.116 -0.356  0.059  0.169
2  0.116  1.000  0.048 -0.318 -0.297
3 -0.356  0.048  1.000  0.463 -0.589
4  0.059 -0.318  0.463  1.000 -0.363
5  0.169 -0.297 -0.589 -0.363  1.000</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化余弦相似度</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择前20个样本</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>cosine_subset <span class="ot">&lt;-</span> cosine_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用pheatmap绘制</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(cosine_subset,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">display_numbers =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>))(<span class="dv">50</span>),</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">51</span>),</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"余弦相似度热图"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster_rows =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">cluster_cols =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="1100-distance-metrics_files/figure-html/cosine-heatmap-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>余弦相似度热图</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="步骤5汉明距离计算二值数据" class="level3">
<h3 class="anchored" data-anchor-id="步骤5汉明距离计算二值数据">步骤5：汉明距离计算（二值数据）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算二值数据的汉明距离</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>hamming_matrix <span class="ot">&lt;-</span> <span class="fu">dist</span>(binary_data, <span class="at">method =</span> <span class="st">"manhattan"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看汉明距离矩阵</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">as.matrix</span>(hamming_matrix)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">0</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1 2 3 4 5 6 7 8 9 10
1  0 7 2 3 6 6 4 3 5  7
2  7 0 7 6 5 7 7 6 6  6
3  2 7 0 5 4 4 4 3 3  7
4  3 6 5 0 5 5 3 4 4  6
5  6 5 4 5 0 4 6 7 5  5
6  6 7 4 5 4 0 2 5 3  3
7  4 7 4 3 6 2 0 5 3  5
8  3 6 3 4 7 5 5 0 4  6
9  5 6 3 4 5 3 3 4 0  6
10 7 6 7 6 5 3 5 6 6  0</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化汉明距离分布</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>hamming_values <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(hamming_matrix)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">Hamming =</span> hamming_values), <span class="fu">aes</span>(<span class="at">x =</span> Hamming)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"汉明距离"</span>, <span class="at">y =</span> <span class="st">"频数"</span>, <span class="at">title =</span> <span class="st">"二值特征汉明距离分布"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="1100-distance-metrics_files/figure-html/hamming-histogram-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>汉明距离分布</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="步骤6jaccard-距离计算" class="level3">
<h3 class="anchored" data-anchor-id="步骤6jaccard-距离计算">步骤6：Jaccard 距离计算</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 proxy 包计算 Jaccard 距离（如果已安装）</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"proxy"</span>)) <span class="fu">install.packages</span>(<span class="st">"proxy"</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(proxy)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 将二值数据转换为逻辑矩阵</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>binary_logical <span class="ot">&lt;-</span> binary_data <span class="sc">==</span> <span class="dv">1</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 Jaccard 距离</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>jaccard_matrix <span class="ot">&lt;-</span> proxy<span class="sc">::</span><span class="fu">dist</span>(binary_logical, <span class="at">method =</span> <span class="st">"Jaccard"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看部分矩阵</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">as.matrix</span>(jaccard_matrix)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1     2     3     4     5     6     7     8     9    10
1  0.000 0.700 0.286 0.429 0.667 0.667 0.500 0.429 0.625 0.778
2  0.700 0.000 0.700 0.667 0.556 0.700 0.700 0.667 0.667 0.667
3  0.286 0.700 0.000 0.625 0.500 0.500 0.500 0.429 0.429 0.778
4  0.429 0.667 0.625 0.000 0.625 0.625 0.429 0.571 0.571 0.750
5  0.667 0.556 0.500 0.625 0.000 0.500 0.667 0.778 0.625 0.625
6  0.667 0.700 0.500 0.625 0.500 0.000 0.286 0.625 0.429 0.429
7  0.500 0.700 0.500 0.429 0.667 0.286 0.000 0.625 0.429 0.625
8  0.429 0.667 0.429 0.571 0.778 0.625 0.625 0.000 0.571 0.750
9  0.625 0.667 0.429 0.571 0.625 0.429 0.429 0.571 0.000 0.750
10 0.778 0.667 0.778 0.750 0.625 0.429 0.625 0.750 0.750 0.000</code></pre>
</div>
</div>
</section>
<section id="步骤7距离指标比较与可视化" class="level3">
<h3 class="anchored" data-anchor-id="步骤7距离指标比较与可视化">步骤7：距离指标比较与可视化</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较不同距离指标下前5个点之间的距离</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>points_to_compare <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pair =</span> <span class="fu">character</span>(),</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Euclidean =</span> <span class="fu">numeric</span>(),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Manhattan =</span> <span class="fu">numeric</span>(),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Chebyshev =</span> <span class="fu">numeric</span>(),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Minkowski =</span> <span class="fu">numeric</span>(),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> points_to_compare) {</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> points_to_compare) {</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">&lt;</span> j) {</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>      comparison_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(comparison_df, <span class="fu">data.frame</span>(</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">Pair =</span> <span class="fu">paste0</span>(i, <span class="st">"-"</span>, j),</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">Euclidean =</span> euclidean_matrix[<span class="fu">cbind</span>(i, j)],</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">Manhattan =</span> manhattan_matrix[<span class="fu">cbind</span>(i, j)],</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">Chebyshev =</span> maximum_matrix[<span class="fu">cbind</span>(i, j)],</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">Minkowski =</span> minkowski_matrix[<span class="fu">cbind</span>(i, j)]</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(comparison_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Pair Euclidean Manhattan Chebyshev Minkowski
1   1-2 2.8044119  5.759607 1.9798406  3.518891
2   1-2 0.8990823  1.784392 0.6545797  1.111289
3   1-3 2.8044119  5.759607 1.9798406  3.518891
4   1-3 1.7712379  3.529956 1.0076249  2.223846
5   1-4 2.8044119  5.759607 1.9798406  3.518891
6   1-4 2.3059364  5.028413 1.3067781  2.978777
7   1-5 2.8044119  5.759607 1.9798406  3.518891
8   1-5 5.6747228 12.207869 3.2395412  7.284918
9   2-3 0.8990823  1.784392 0.6545797  1.111289
10  2-3 1.7712379  3.529956 1.0076249  2.223846
11  2-4 0.8990823  1.784392 0.6545797  1.111289
12  2-4 2.3059364  5.028413 1.3067781  2.978777
13  2-5 0.8990823  1.784392 0.6545797  1.111289
14  2-5 5.6747228 12.207869 3.2395412  7.284918
15  3-4 1.7712379  3.529956 1.0076249  2.223846
16  3-4 2.3059364  5.028413 1.3067781  2.978777
17  3-5 1.7712379  3.529956 1.0076249  2.223846
18  3-5 5.6747228 12.207869 3.2395412  7.284918
19  4-5 2.3059364  5.028413 1.3067781  2.978777
20  4-5 5.6747228 12.207869 3.2395412  7.284918</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化不同距离指标的差异</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>comparison_melt <span class="ot">&lt;-</span> <span class="fu">melt</span>(comparison_df, <span class="at">id.vars =</span> <span class="st">"Pair"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comparison_melt, <span class="fu">aes</span>(<span class="at">x =</span> Pair, <span class="at">y =</span> value, <span class="at">fill =</span> variable)) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set2"</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"样本对"</span>, <span class="at">y =</span> <span class="st">"距离值"</span>, <span class="at">fill =</span> <span class="st">"距离指标"</span>,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"不同距离指标计算结果对比"</span>) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="1100-distance-metrics_files/figure-html/distance-comparison-plot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>不同距离指标比较</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="步骤8聚类分析应用" class="level3">
<h3 class="anchored" data-anchor-id="步骤8聚类分析应用">步骤8：聚类分析应用</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用不同距离进行层次聚类</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 基于欧氏距离的聚类</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>hclust_euclidean <span class="ot">&lt;-</span> <span class="fu">hclust</span>(euclidean_matrix, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 基于曼哈顿距离的聚类</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>hclust_manhattan <span class="ot">&lt;-</span> <span class="fu">hclust</span>(manhattan_matrix, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 基于马氏距离的聚类（需要手动计算）</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>mahalanobis_matrix <span class="ot">&lt;-</span> <span class="fu">as.dist</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, n, n))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(data_matrix[i, ], data_matrix[j, ], <span class="fu">cov</span>(data_matrix))</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    mahalanobis_matrix[<span class="fu">cbind</span>(i, j)] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(d)</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>hclust_mahalanobis <span class="ot">&lt;-</span> <span class="fu">hclust</span>(mahalanobis_matrix, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制聚类树</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_euclidean, <span class="at">main =</span> <span class="st">"欧氏距离聚类"</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_manhattan, <span class="at">main =</span> <span class="st">"曼哈顿距离聚类"</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hclust_mahalanobis, <span class="at">main =</span> <span class="st">"马氏距离聚类"</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1100-distance-metrics_files/figure-html/clustering-example-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="步骤9k-近邻分类器应用" class="level3">
<h3 class="anchored" data-anchor-id="步骤9k-近邻分类器应用">步骤9：K-近邻分类器应用</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建训练集和测试集</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2026</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> <span class="dv">80</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>test_idx <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n, train_idx)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data_scaled[train_idx, ]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data_scaled[test_idx, ]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 class 包的 KNN</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"class"</span>)) <span class="fu">install.packages</span>(<span class="st">"class"</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 预测（k=3）</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>knn_pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> train_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">test =</span> test_data[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">cl =</span> train_data<span class="sc">$</span>group,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">k =</span> k)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算准确率</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">mean</span>(knn_pred <span class="sc">==</span> test_data<span class="sc">$</span>group)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"KNN 分类准确率 (k="</span>, k, <span class="st">"):"</span>, <span class="fu">round</span>(accuracy <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>KNN 分类准确率 (k= 3 ): 30 %</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 混淆矩阵</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> knn_pred, <span class="at">Actual =</span> test_data<span class="sc">$</span>group)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Actual
Predicted A B C
        A 1 1 3
        B 3 4 2
        C 4 1 1</code></pre>
</div>
</div>
</section>
</section>
<section id="结果解读与报告" class="level2">
<h2 class="anchored" data-anchor-id="结果解读与报告">结果解读与报告</h2>
<section id="距离指标的统计意义" class="level3">
<h3 class="anchored" data-anchor-id="距离指标的统计意义">距离指标的统计意义</h3>
<section id="马氏距离与异常值检测" class="level4">
<h4 class="anchored" data-anchor-id="马氏距离与异常值检测">1. 马氏距离与异常值检测</h4>
<p>马氏距离服从 <span class="math inline">\(\chi^2\)</span> 分布，自由度为数据维度。常用阈值： - <span class="math inline">\(95\%\)</span> 置信水平：<span class="math inline">\(\chi^2_{0.95, df}\)</span> - <span class="math inline">\(97.5\%\)</span> 置信水平：<span class="math inline">\(\chi^2_{0.975, df}\)</span> - <span class="math inline">\(99\%\)</span> 置信水平：<span class="math inline">\(\chi^2_{0.99, df}\)</span></p>
<p><strong>解读</strong>： - 超过阈值的点可视为潜在异常值 - 但需结合领域知识判断是否为真实异常</p>
</section>
<section id="余弦相似度解读" class="level4">
<h4 class="anchored" data-anchor-id="余弦相似度解读">2. 余弦相似度解读</h4>
<table class="caption-top table">
<thead>
<tr class="header">
<th>余弦相似度</th>
<th>关系描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\approx 1\)</span></td>
<td>几乎相同方向（高度相似）</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\approx 0\)</span></td>
<td>正交（不相关）</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\approx -1\)</span></td>
<td>方向相反（高度负相关）</td>
</tr>
</tbody>
</table>
</section>
<section id="汉明距离解读" class="level4">
<h4 class="anchored" data-anchor-id="汉明距离解读">3. 汉明距离解读</h4>
<p>对于长度为 <span class="math inline">\(L\)</span> 的二值字符串，汉明距离 <span class="math inline">\(d\)</span>： - 最小值：0（完全相同） - 最大值：<span class="math inline">\(L\)</span>（完全不同） - 比例：<span class="math inline">\(d/L\)</span> 表示差异程度</p>
</section>
</section>
<section id="论文报告格式" class="level3">
<h3 class="anchored" data-anchor-id="论文报告格式">论文报告格式</h3>
<p><strong>示例1：异常值检测报告</strong></p>
<blockquote class="blockquote">
<p>“我们采用马氏距离进行多变量异常值检测。协方差矩阵显示各变量间存在显著相关性（<span class="math inline">\(r = 0.32-0.75\)</span>），因此马氏距离比欧氏距离更合适。共识别出 5 个样本的马氏距离超过 <span class="math inline">\(97.5\%\)</span> 分位数阈值（<span class="math inline">\(\chi^2_{0.975, 5} = 12.83\)</span>），占总样本的 5%。这些样本在年龄和血压变量上同时表现出极端值，经临床复核后确认 3 例为数据录入错误，2 例为真实病例。”</p>
</blockquote>
<p><strong>示例2：文本相似度分析报告</strong></p>
<blockquote class="blockquote">
<p>“采用余弦相似度度量文档间的语义相似性。相比欧氏距离，余弦相似度不受文档长度影响，更能反映语义方向的一致性。计算结果显示，相似度在 <span class="math inline">\(0.8\)</span> 以上的文档对共 24 对，主要集中于同一主题类别。层次聚类基于余弦距离矩阵将 100 篇文档分为 7 个主题簇，轮廓系数为 <span class="math inline">\(0.42\)</span>，表明聚类效果中等偏好。”</p>
</blockquote>
<p><strong>示例3：KNN 分类器性能报告</strong></p>
<blockquote class="blockquote">
<p>“使用 K-近邻分类器对三类患者进行分类，采用 5 折交叉验证评估性能。比较了欧氏距离和马氏距离两种度量方式。欧氏距离下，最优 <span class="math inline">\(k=3\)</span> 时准确率为 <span class="math inline">\(78.3\%\)</span>（95% CI: 71.2%-84.5%）；马氏距离下，最优 <span class="math inline">\(k=5\)</span> 时准确率为 <span class="math inline">\(82.7\%\)</span>（95% CI: 76.0%-88.3%）。马氏距离考虑了变量间的相关性，分类性能显著优于欧氏距离（<span class="math inline">\(p = 0.032\)</span>）。”</p>
</blockquote>
</section>
</section>
<section id="常见错误与纠偏" class="level2">
<h2 class="anchored" data-anchor-id="常见错误与纠偏">常见错误与纠偏</h2>
<section id="错误1未标准化数据直接计算欧氏距离" class="level3">
<h3 class="anchored" data-anchor-id="错误1未标准化数据直接计算欧氏距离">错误1：未标准化数据直接计算欧氏距离</h3>
<p><strong>问题表现</strong>： - 某些变量范围很大（如年龄：0-100），某些很小（如性别：0-1） - 大范围变量主导距离计算</p>
<p><strong>错误示例</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 错误：未标准化</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>wrong_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_continuous, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 第一个变量（体重~50kg）的影响远大于第二个变量（身高~165cm）</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 因为它们的方差不同</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>正确做法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 正确：先标准化</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>scaled_data <span class="ot">&lt;-</span> <span class="fu">scale</span>(data_continuous)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>correct_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(scaled_data, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="错误2在高度相关变量上使用欧氏距离" class="level3">
<h3 class="anchored" data-anchor-id="错误2在高度相关变量上使用欧氏距离">错误2：在高度相关变量上使用欧氏距离</h3>
<p><strong>问题表现</strong>： - 多个变量高度相关，信息冗余 - 欧氏距离重复计算相似信息</p>
<p><strong>错误示例</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 假设有5个高度相关的身高测量（不同时间点）</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>redundant_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(height1, height2, height3, height4, height5)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 欧氏距离会重复计算相似信息</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><strong>正确做法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法1：降维后计算</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(redundant_data)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>dist_pca <span class="ot">&lt;-</span> <span class="fu">dist</span>(pca_result<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])  <span class="co"># 使用主成分</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法2：使用马氏距离</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>mahalanobis_dist <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(redundant_data, <span class="fu">colMeans</span>(redundant_data),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">cov</span>(redundant_data))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="错误3马氏距离协方差矩阵奇异" class="level3">
<h3 class="anchored" data-anchor-id="错误3马氏距离协方差矩阵奇异">错误3：马氏距离协方差矩阵奇异</h3>
<p><strong>问题表现</strong>：</p>
<pre><code>Error in solve.default(S) :
  system is computationally singular: reciprocal condition number</code></pre>
<p><strong>原因</strong>： - 存在完全线性相关的变量 - 样本量小于变量数</p>
<p><strong>正确做法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法1：去除冗余变量</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(data)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>high_corr <span class="ot">&lt;-</span> <span class="fu">findCorrelation</span>(cor_matrix, <span class="at">cutoff =</span> <span class="fl">0.95</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>data_reduced <span class="ot">&lt;-</span> data[, <span class="sc">-</span>high_corr]</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法2：使用伪逆</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>S_pseudo <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">ginv</span>(S)  <span class="co"># 广义逆</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>mahalanobis_dist <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(<span class="fu">t</span>(x <span class="sc">-</span> y) <span class="sc">%*%</span> S_pseudo <span class="sc">%*%</span> (x <span class="sc">-</span> y)))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法3：添加微小正则化项</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>S_reg <span class="ot">&lt;-</span> S <span class="sc">+</span> <span class="fu">diag</span>(<span class="fl">1e-6</span>, <span class="fu">ncol</span>(S))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="错误4余弦相似度用于比较零向量" class="level3">
<h3 class="anchored" data-anchor-id="错误4余弦相似度用于比较零向量">错误4：余弦相似度用于比较零向量</h3>
<p><strong>问题表现</strong>：</p>
<pre><code>Warning: NaNs produced</code></pre>
<p><strong>原因</strong>：零向量长度为0，导致分母为0</p>
<p><strong>正确做法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>safe_cosine_sim <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  norm_x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  norm_y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(y<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (norm_x <span class="sc">==</span> <span class="dv">0</span> <span class="sc">||</span> norm_y <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># 或者返回0表示不相似</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(x <span class="sc">*</span> y) <span class="sc">/</span> (norm_x <span class="sc">*</span> norm_y)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="错误5汉明距离用于连续变量" class="level3">
<h3 class="anchored" data-anchor-id="错误5汉明距离用于连续变量">错误5：汉明距离用于连续变量</h3>
<p><strong>问题表现</strong>： - 对连续变量应用汉明距离失去意义 - 离散化时可能损失信息</p>
<p><strong>正确做法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法1：使用合适的距离指标</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dist</span>(data_continuous, <span class="at">method =</span> <span class="st">"euclidean"</span>)  <span class="co"># 连续数据用欧氏</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法2：先离散化（有信息损失）</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>discrete_data <span class="ot">&lt;-</span> <span class="fu">cut</span>(data_continuous, <span class="at">breaks =</span> <span class="dv">5</span>, <span class="at">labels =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dist</span>(discrete_data, <span class="at">method =</span> <span class="st">"manhattan"</span>)  <span class="co"># 离散化后可用汉明</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="错误6忽略距离指标的尺度差异" class="level3">
<h3 class="anchored" data-anchor-id="错误6忽略距离指标的尺度差异">错误6：忽略距离指标的尺度差异</h3>
<p><strong>问题表现</strong>： - 混合使用不同距离指标时，直接比较数值 - 各距离指标的取值范围不同</p>
<p><strong>正确做法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 标准化距离值后再比较</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>euclidean_norm <span class="ot">&lt;-</span> euclidean_matrix <span class="sc">/</span> <span class="fu">max</span>(euclidean_matrix)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>manhattan_norm <span class="ot">&lt;-</span> manhattan_matrix <span class="sc">/</span> <span class="fu">max</span>(manhattan_matrix)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 或使用相对排名</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>euclidean_rank <span class="ot">&lt;-</span> <span class="fu">rank</span>(euclidean_matrix)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>manhattan_rank <span class="ot">&lt;-</span> <span class="fu">rank</span>(manhattan_matrix)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="错误7knn-中-k-值选择不当" class="level3">
<h3 class="anchored" data-anchor-id="错误7knn-中-k-值选择不当">错误7：KNN 中 k 值选择不当</h3>
<p><strong>问题表现</strong>： - k 太小：过拟合，对噪声敏感 - k 太大：欠拟合，忽略局部结构</p>
<p><strong>正确做法</strong>：</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用交叉验证选择最优 k</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>knn_tune <span class="ot">&lt;-</span> <span class="fu">train</span>(group <span class="sc">~</span> ., <span class="at">data =</span> train_data,</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">trControl =</span> ctrl,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">metric =</span> <span class="st">"Accuracy"</span>)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(knn_tune)  <span class="co"># 查看准确率随 k 的变化</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>best_k <span class="ot">&lt;-</span> knn_tune<span class="sc">$</span>bestTune<span class="sc">$</span>k</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="进阶扩展" class="level2">
<h2 class="anchored" data-anchor-id="进阶扩展">进阶扩展</h2>
<section id="动态时间规整-dtw-距离" class="level3">
<h3 class="anchored" data-anchor-id="动态时间规整-dtw-距离">1. 动态时间规整 (DTW) 距离</h3>
<p><strong>用途</strong>：时间序列相似度度量，允许时间轴对齐</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 安装并使用 dtw 包</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"dtw"</span>)) <span class="fu">install.packages</span>(<span class="st">"dtw"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dtw)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 两个时间序列</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>ts1 <span class="ot">&lt;-</span> <span class="fu">sin</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span><span class="sc">*</span>pi, <span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>ts2 <span class="ot">&lt;-</span> <span class="fu">sin</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span><span class="sc">*</span>pi, <span class="at">length.out =</span> <span class="dv">100</span>)) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 DTW 距离</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>dtw_result <span class="ot">&lt;-</span> <span class="fu">dtw</span>(ts1, ts2)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>dtw_result<span class="sc">$</span>distance  <span class="co"># DTW 距离</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="堡垒距离-bhattacharyya-distance" class="level3">
<h3 class="anchored" data-anchor-id="堡垒距离-bhattacharyya-distance">2. 堡垒距离 (Bhattacharyya Distance)</h3>
<p><strong>用途</strong>：概率分布相似度度量</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 两个正态分布</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span>; sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">1</span>; sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bhattacharyya 距离</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>bhattacharyya <span class="ot">&lt;-</span> <span class="fl">0.25</span> <span class="sc">*</span> ((mu1 <span class="sc">-</span> mu2)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (sigma1 <span class="sc">+</span> sigma2) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>                 <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">log</span>((sigma1 <span class="sc">+</span> sigma2) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">sqrt</span>(sigma1 <span class="sc">*</span> sigma2)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="earth-movers-distance-emd" class="level3">
<h3 class="anchored" data-anchor-id="earth-movers-distance-emd">3. Earth Mover’s Distance (EMD)</h3>
<p><strong>用途</strong>：图像检索、颜色分布比较</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 安装并使用 emdist 包</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"emdist"</span>)) <span class="fu">install.packages</span>(<span class="st">"emdist"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emdist)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算两个分布之间的 EMD</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>emd_dist <span class="ot">&lt;-</span> <span class="fu">emd2</span>(dist1, dist2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="自定义距离函数" class="level3">
<h3 class="anchored" data-anchor-id="自定义距离函数">4. 自定义距离函数</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义加权欧氏距离</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>weighted_euclidean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, weights) {</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">sum</span>(weights <span class="sc">*</span> (x <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义对称 KL 散度</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>symmetric_kl <span class="ot">&lt;-</span> <span class="cf">function</span>(p, q) {</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  epsilon <span class="ot">&lt;-</span> <span class="fl">1e-10</span>  <span class="co"># 避免log(0)</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> p <span class="sc">+</span> epsilon</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> q <span class="sc">+</span> epsilon</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(p <span class="sc">*</span> <span class="fu">log</span>(p<span class="sc">/</span>q)) <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">sum</span>(q <span class="sc">*</span> <span class="fu">log</span>(q<span class="sc">/</span>p))</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="高维数据的距离度量" class="level3">
<h3 class="anchored" data-anchor-id="高维数据的距离度量">5. 高维数据的距离度量</h3>
<p><strong>问题</strong>：维度灾难（Curse of Dimensionality）</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用降维技术</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. PCA</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(high_dim_data)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>dist_pca <span class="ot">&lt;-</span> <span class="fu">dist</span>(pca_result<span class="sc">$</span>x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])  <span class="co"># 使用前10个主成分</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. t-SNE</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"Rtsne"</span>)) <span class="fu">install.packages</span>(<span class="st">"Rtsne"</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>tsne_result <span class="ot">&lt;-</span> <span class="fu">Rtsne</span>(high_dim_data, <span class="at">dims =</span> <span class="dv">2</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>dist_tsne <span class="ot">&lt;-</span> <span class="fu">dist</span>(tsne_result<span class="sc">$</span>Y)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 随机投影</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"RP"</span>)) <span class="fu">install.packages</span>(<span class="st">"RP"</span>)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RP)</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>rp_result <span class="ot">&lt;-</span> <span class="fu">randomProjection</span>(high_dim_data, <span class="at">k =</span> <span class="dv">50</span>)</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>dist_rp <span class="ot">&lt;-</span> <span class="fu">dist</span>(rp_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="距离学习的应用" class="level3">
<h3 class="anchored" data-anchor-id="距离学习的应用">6. 距离学习的应用</h3>
<p><strong>核技巧</strong>：将数据映射到高维空间</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RBF 核距离</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>rbf_kernel_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">gamma =</span> <span class="dv">1</span>) {</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">sum</span>((x <span class="sc">-</span> y)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 多项式核距离</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>poly_kernel_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">degree =</span> <span class="dv">2</span>) {</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">sum</span>(x <span class="sc">*</span> y) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">^</span>degree</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="推荐阅读" class="level3">
<h3 class="anchored" data-anchor-id="推荐阅读">推荐阅读</h3>
<ol type="1">
<li><strong>Deza, M. M., &amp; Deza, E. (2009).</strong> <em>Encyclopedia of Distances</em>. Springer.</li>
<li><strong>Aggarwal, C. C., et al.&nbsp;(2001).</strong> “On the surprising behavior of distance metrics in high dimensional spaces.” <em>ICDT</em>.</li>
<li><strong>Cha, S.-H. (2007).</strong> “Comprehensive survey on distance/similarity measures between probability density functions.” <em>International Journal of Mathematical Models and Methods in Applied Sciences</em>.</li>
<li><strong>Cover, T. M., &amp; Hart, P. E. (1967).</strong> “Nearest neighbor pattern classification.” <em>IEEE Transactions on Information Theory</em>.</li>
</ol>
</section>
</section>
<section id="总结" class="level2">
<h2 class="anchored" data-anchor-id="总结">总结</h2>
<section id="核心要点" class="level3">
<h3 class="anchored" data-anchor-id="核心要点">核心要点</h3>
<ol type="1">
<li><strong>距离指标选择原则</strong>：
<ul>
<li>连续变量：欧氏/曼哈顿（需标准化）</li>
<li>相关变量：马氏距离</li>
<li>文本/高维稀疏：余弦相似度</li>
<li>离散/二值：汉明/Jaccard</li>
</ul></li>
<li><strong>关键注意事项</strong>：
<ul>
<li>使用欧氏/曼哈顿距离前必须标准化</li>
<li>马氏距离需检查协方差矩阵正定性</li>
<li>高维数据考虑降维</li>
<li>结合业务场景选择指标</li>
</ul></li>
<li><strong>实践建议</strong>：
<ul>
<li>多尝试几种距离指标，比较效果</li>
<li>使用交叉验证选择最优参数</li>
<li>可视化距离矩阵和聚类结果</li>
<li>报告时说明距离指标选择的依据</li>
</ul></li>
</ol>
</section>
<section id="距离指标速查表" class="level3">
<h3 class="anchored" data-anchor-id="距离指标速查表">距离指标速查表</h3>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>距离指标速查表</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 36%">
<col style="width: 18%">
<col style="width: 15%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">距离指标</th>
<th style="text-align: left;">R函数</th>
<th style="text-align: left;">适用场景</th>
<th style="text-align: left;">计算复杂度</th>
<th style="text-align: left;">是否需标准化</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">欧氏</td>
<td style="text-align: left;">dist(x, ‘euclidean’)</td>
<td style="text-align: left;">通用连续数据</td>
<td style="text-align: left;">O(d)</td>
<td style="text-align: left;">是</td>
</tr>
<tr class="even">
<td style="text-align: left;">曼哈顿</td>
<td style="text-align: left;">dist(x, ‘manhattan’)</td>
<td style="text-align: left;">存在异常值</td>
<td style="text-align: left;">O(d)</td>
<td style="text-align: left;">是</td>
</tr>
<tr class="odd">
<td style="text-align: left;">马氏</td>
<td style="text-align: left;">mahalanobis()</td>
<td style="text-align: left;">相关变量</td>
<td style="text-align: left;">O(d²)</td>
<td style="text-align: left;">否</td>
</tr>
<tr class="even">
<td style="text-align: left;">余弦</td>
<td style="text-align: left;">自定义</td>
<td style="text-align: left;">文本/向量</td>
<td style="text-align: left;">O(d)</td>
<td style="text-align: left;">否</td>
</tr>
<tr class="odd">
<td style="text-align: left;">汉明</td>
<td style="text-align: left;">dist(x, ‘manhattan’)</td>
<td style="text-align: left;">二值数据</td>
<td style="text-align: left;">O(d)</td>
<td style="text-align: left;">否</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jaccard</td>
<td style="text-align: left;">proxy::dist(x, ‘Jaccard’)</td>
<td style="text-align: left;">集合数据</td>
<td style="text-align: left;">O(d)</td>
<td style="text-align: left;">否</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="参考文献" class="level2">
<h2 class="anchored" data-anchor-id="参考文献">参考文献</h2>
<ol type="1">
<li>Everitt, B., Landau, S., Leese, M., &amp; Stahl, D. (2011). <em>Cluster Analysis</em> (5th ed.). Wiley.</li>
<li>Hastie, T., Tibshirani, R., &amp; Friedman, J. (2009). <em>The Elements of Statistical Learning</em> (2nd ed.). Springer.</li>
<li>James, G., Witten, D., Hastie, T., &amp; Tibshirani, R. (2013). <em>An Introduction to Statistical Learning</em>. Springer.</li>
<li>Aggarwal, C. C. (2015). <em>Data Mining: The Textbook</em>. Springer.</li>
<li>Deza, M. M., &amp; Deza, E. (2009). <em>Encyclopedia of Distances</em>. Springer.</li>
</ol>
<hr>
<p><strong>附录：完整代码汇总</strong></p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 完整代码：常见距离指标计算与比较</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ==================================================</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要包</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置种子</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2026</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 数据生成</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">165</span>, <span class="dv">70</span>, <span class="dv">120</span>, <span class="dv">80</span>)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>,  <span class="dv">15</span>,   <span class="dv">8</span>,   <span class="dv">5</span>,   <span class="dv">6</span>,</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">15</span>,  <span class="dv">25</span>,  <span class="dv">12</span>,   <span class="dv">7</span>,   <span class="dv">8</span>,</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>   <span class="dv">8</span>,  <span class="dv">12</span>,   <span class="dv">9</span>,   <span class="dv">4</span>,   <span class="dv">5</span>,</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>   <span class="dv">5</span>,   <span class="dv">7</span>,   <span class="dv">4</span>,   <span class="dv">3</span>,   <span class="dv">3</span>,</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>   <span class="dv">6</span>,   <span class="dv">8</span>,   <span class="dv">5</span>,   <span class="dv">3</span>,   <span class="dv">4</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">diag</span>(<span class="fl">0.1</span>, <span class="dv">5</span>)</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>data_continuous <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, Sigma)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_continuous) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"体重"</span>, <span class="st">"身高"</span>, <span class="st">"年龄"</span>, <span class="st">"收缩压"</span>, <span class="st">"舒张压"</span>)</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>data_scaled <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(data_continuous))</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>data_scaled<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 计算距离矩阵</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data_scaled[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>euclidean_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_matrix, <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a>manhattan_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_matrix, <span class="at">method =</span> <span class="st">"manhattan"</span>)</span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a>chebyshev_dist <span class="ot">&lt;-</span> <span class="fu">dist</span>(data_matrix, <span class="at">method =</span> <span class="st">"maximum"</span>)</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 马氏距离</span></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cov</span>(data_matrix)</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>mahalanobis_all <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(data_matrix, <span class="fu">colMeans</span>(data_matrix), S)</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 异常值检测（马氏距离）</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="dv">5</span>)</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">which</span>(mahalanobis_all <span class="sc">&gt;</span> threshold)</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"检测到"</span>, <span class="fu">length</span>(outliers), <span class="st">"个潜在异常值</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. KNN 分类</span></span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>train_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">80</span>)</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>knn_pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> data_scaled[train_idx, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>                <span class="at">test =</span> data_scaled[<span class="sc">-</span>train_idx, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>                <span class="at">cl =</span> data_scaled<span class="sc">$</span>group[train_idx],</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>                <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 聚类分析</span></span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------------</span></span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(euclidean_dist, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(clusters, data_scaled<span class="sc">$</span>group)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>


</section>

</main> <!-- /main -->
<!-- Hypothesis 文字划线评论功能 -->

<!-- 用户可以选中任意文字添加批注，所有人都能看到 -->

<script>

    window.hypothesisConfig = function () {

        return {

            branding: {

                appBackgroundColor: 'white',

                ctaBackgroundColor: '#4f46e5',

                ctaTextColor: 'white',

                selectionFontFamily: 'inherit'

            },

            enableExperimentalNewNoteButton: true,

            showHighlights: 'always'

        };

    };

</script>

<script async="" src="https://hypothes.is/embed.js"></script>



<!-- Hypothesis 使用提示 -->

<style>

    .hypothesis-hint {

        position: fixed;

        bottom: 100px;

        right: 20px;

        background: linear-gradient(135deg, #4f46e5, #7c3aed);

        color: white;

        padding: 12px 16px;

        border-radius: 12px;

        font-size: 0.85rem;

        box-shadow: 0 4px 20px rgba(79, 70, 229, 0.3);

        z-index: 999;

        opacity: 0;

        transform: translateY(20px);

        transition: all 0.3s ease;

        pointer-events: none;

        max-width: 200px;

        line-height: 1.4;

    }

    

    .hypothesis-hint.show {

        opacity: 1;

        transform: translateY(0);

    }

    

    .hypothesis-hint::before {

        content: "💡";

        margin-right: 6px;

    }

    

    @media (max-width: 768px) {

        .hypothesis-hint {

            bottom: 80px;

            right: 10px;

            left: 10px;

            max-width: none;

        }

    }

</style>



<div class="hypothesis-hint" id="hypothesis-hint">

    选中文字可以添加批注，与其他读者互动！

</div>



<script>

    // 首次访问时显示提示

    document.addEventListener('DOMContentLoaded', function() {

        const hint = document.getElementById('hypothesis-hint');

        const hintShown = localStorage.getItem('hypothesis_hint_shown');

        

        if (!hintShown && hint) {

            setTimeout(() => {

                hint.classList.add('show');

                setTimeout(() => {

                    hint.classList.remove('show');

                    localStorage.setItem('hypothesis_hint_shown', 'true');

                }, 5000);

            }, 3000);

        }

    });

</script>



<!-- Back to Top Button -->

<button id="back-to-top" aria-label="Back to Top">

    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">

        <path d="M18 15l-6-6-6 6"></path>

    </svg>

</button>



<!-- Floating TOC Button (Mobile Only) -->

<button id="toc-floating-btn" aria-label="Table of Contents">

    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">

        <line x1="8" y1="6" x2="21" y2="6"></line>

        <line x1="8" y1="12" x2="21" y2="12"></line>

        <line x1="8" y1="18" x2="21" y2="18"></line>

        <line x1="3" y1="6" x2="3.01" y2="6"></line>

        <line x1="3" y1="12" x2="3.01" y2="12"></line>

        <line x1="3" y1="18" x2="3.01" y2="18"></line>

    </svg>

</button>



<!-- TOC Modal -->

<div class="toc-modal-overlay">

    <div class="toc-modal-content">

        <div class="toc-modal-header">

            <div class="toc-modal-title">目录</div>

            <button class="toc-modal-close" aria-label="Close">×</button>

        </div>

        <div class="toc-modal-body" id="toc-modal-body">

            <!-- TOC content will be injected here -->

        </div>

    </div>

</div>



<script>

    // Back to Top Logic

    const backToTopBtn = document.getElementById('back-to-top');



    window.addEventListener('scroll', () => {

        if (window.scrollY > 300) {

            backToTopBtn.classList.add('visible');

        } else {

            backToTopBtn.classList.remove('visible');

        }

    });



    backToTopBtn.addEventListener('click', () => {

        window.scrollTo({

            top: 0,

            behavior: 'smooth'

        });

    });



    // Mobile Table Scrolling Logic

    document.addEventListener("DOMContentLoaded", function () {

        const tables = document.querySelectorAll('table');

        tables.forEach(table => {

            if (!table.parentElement.classList.contains('table-responsive')) {

                const wrapper = document.createElement('div');

                wrapper.className = 'table-responsive';

                wrapper.style.overflowX = 'auto'; // Force scroll

                table.parentNode.insertBefore(wrapper, table);

                wrapper.appendChild(table);

            }

        });



        // Floating TOC Logic

        const tocBtn = document.getElementById('toc-floating-btn');

        const tocOverlay = document.querySelector('.toc-modal-overlay');

        const tocClose = document.querySelector('.toc-modal-close');

        const tocBody = document.getElementById('toc-modal-body');

        const originalToc = document.getElementById('TOC');



        if (originalToc && tocBtn) {

            // Check if TOC has content

            const tocLinks = originalToc.querySelectorAll('a');

            if (tocLinks.length > 0) {

                tocBtn.style.display = 'flex';



                // Function to populate modal

                const populateToc = () => {

                    tocBody.innerHTML = '';

                    const tocClone = originalToc.querySelector('ul').cloneNode(true);

                    tocBody.appendChild(tocClone);



                    // Add click listeners to close modal on link click

                    tocBody.querySelectorAll('a').forEach(link => {

                        link.addEventListener('click', () => {

                            tocOverlay.classList.remove('active');

                            // Smooth scroll to target (handled by browser usually, but ensure modal closes first)

                        });

                    });

                };



                tocBtn.addEventListener('click', () => {

                    populateToc();

                    tocOverlay.classList.add('active');

                });



                tocClose.addEventListener('click', () => {

                    tocOverlay.classList.remove('active');

                });



                tocOverlay.addEventListener('click', (e) => {

                    if (e.target === tocOverlay) {

                        tocOverlay.classList.remove('active');

                    }

                });

            } else {

                tocBtn.style.display = 'none';

            }

        } else if (tocBtn) {

            tocBtn.style.display = 'none';

        }



        // Article Footer Random Recommendation

        // Only run on article pages (has sidebar and main content)

        const sidebar = document.querySelector('#quarto-sidebar') || document.querySelector('.sidebar');

        const mainContent = document.querySelector('main');



        if (sidebar && mainContent) {

            const links = Array.from(sidebar.querySelectorAll('a.sidebar-item-text'));



            // If no links found with specific class, try generic anchor in sidebar

            const allLinks = links.length > 0 ? links : Array.from(sidebar.querySelectorAll('a'));



            // Filter out section headers if they are just toggles (usually href is # or empty)

            const validLinks = allLinks.filter(a => a.href && !a.href.endsWith('#') && !a.href.includes('javascript:'));



            // Article Footer Navigation (Prev/Next + Random)

            const currentUrl = window.location.href.split('#')[0];

            let currentIndex = -1;



            // Find current article index

            for (let i = 0; i < validLinks.length; i++) {

                if (validLinks[i].href.split('#')[0] === currentUrl) {

                    currentIndex = i;

                    break;

                }

            }



            // Create Container

            const footerNav = document.createElement('div');

            footerNav.className = 'article-footer-nav-container';

            footerNav.style.marginTop = '4rem';

            footerNav.style.paddingTop = '2rem';

            footerNav.style.borderTop = '1px solid #e5e7eb';



            // 1. Prev/Next Navigation

            if (currentIndex !== -1) {

                let navHtml = '<div class="article-footer-nav">';



                // Previous

                if (currentIndex > 0) {

                    const prevLink = validLinks[currentIndex - 1];

                    const prevTitle = prevLink.innerText.trim();

                    navHtml += `

                        <a href="${prevLink.href}" class="article-nav-link">

                            <span class="nav-label">上一篇</span>

                            <span class="nav-title">« ${prevTitle}</span>

                        </a>

                    `;

                } else {

                    navHtml += `<div></div>`;

                }



                // Next

                if (currentIndex < validLinks.length - 1) {

                    const nextLink = validLinks[currentIndex + 1];

                    const nextTitle = nextLink.innerText.trim();

                    navHtml += `

                        <a href="${nextLink.href}" class="article-nav-link" style="text-align: right;">

                            <span class="nav-label">下一篇</span>

                            <span class="nav-title">${nextTitle} »</span>

                        </a>

                    `;

                } else {

                    navHtml += `<div></div>`;

                }



                navHtml += '</div>';



                // Append Prev/Next HTML

                const navDiv = document.createElement('div');

                navDiv.innerHTML = navHtml;

                footerNav.appendChild(navDiv);

            }



            // 2. Random Recommendation

            const otherLinks = validLinks.filter((_, idx) => idx !== currentIndex);

            if (otherLinks.length > 0) {

                const randomIdx = Math.floor(Math.random() * otherLinks.length);

                const randomLink = otherLinks[randomIdx];

                const randomTitle = randomLink.innerText.trim(); // Use innerText for title



                if (randomTitle) {

                    const randomDiv = document.createElement('div');

                    randomDiv.innerHTML = `

                        <div class="random-recommendation">

                            <h4>👋 随便看看</h4>

                            <p>探索更多 R 语言精彩内容</p>

                            <a href="${randomLink.href}" class="random-btn">

                                🎲 ${randomTitle}

                            </a>

                        </div>

                    `;

                    footerNav.appendChild(randomDiv);

                }

            }



            mainContent.appendChild(footerNav);

        }

    });

</script>



<!-- Like Button Styles -->

<style>

    .article-like-container {

        display: flex;

        justify-content: flex-start;

        margin: 1.5rem 0 2rem 0;

        padding: 0;

    }



    .like-wrapper {

        display: flex;

        flex-direction: column;

        align-items: flex-start;

        gap: 0.4rem;

    }



    .like-btn {

        display: inline-flex;

        align-items: center;

        gap: 0.5rem;

        padding: 0.6rem 1.2rem;

        border: 2px solid #e5e7eb;

        border-radius: 50px;

        background: white;

        color: #6b7280;

        font-size: 0.95rem;

        font-weight: 500;

        cursor: pointer;

        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);

        user-select: none;

    }



    .like-btn:hover {

        border-color: #f472b6;

        color: #ec4899;

        background: #fdf2f8;

    }



    .like-btn.liked {

        border-color: #ec4899;

        color: #ec4899;

        background: #fdf2f8;

    }



    .like-btn.pop {

        animation: pop-animation 0.3s ease;

    }



    @keyframes pop-animation {

        0% {

            transform: scale(1);

        }



        50% {

            transform: scale(1.15);

        }



        100% {

            transform: scale(1);

        }

    }



    .like-icon {

        width: 20px;

        height: 20px;

        transition: transform 0.2s;

    }



    .like-btn:hover .like-icon {

        transform: scale(1.1);

    }



    .like-icon .heart-outline {

        fill: none;

        stroke: currentColor;

        stroke-width: 2;

    }



    .like-icon .heart-fill {

        fill: currentColor;

        opacity: 0;

        transition: opacity 0.2s;

    }



    .like-btn.liked .heart-fill {

        opacity: 1;

    }



    .like-btn.liked .heart-outline {

        stroke: none;

    }



    .like-text {

        font-size: 0.9rem;

    }



    .like-count {

        font-size: 0.85rem;

        min-width: 1rem;

        text-align: center;

    }



    .like-hint {

        font-size: 0.75rem;

        color: #9ca3af;

        padding-left: 0.25rem;

    }



    /* Mobile optimization */

    @media (max-width: 768px) {

        .article-like-container {

            margin: 1rem 0 1.5rem 0;

        }



        .like-btn {

            padding: 0.5rem 1rem;

            font-size: 0.9rem;

        }



        .like-icon {

            width: 18px;

            height: 18px;

        }

    }

</style>



<!-- Like Section Script with Supabase Backend -->

<script>

    // Supabase Configuration

    const SUPABASE_URL = 'https://zyfdzyifhvglibpganxt.supabase.co';

    const SUPABASE_ANON_KEY = 'sb_publishable_XhaP4hFZ30sHZybEjVRQxg_iwlPTxz8';



    document.addEventListener('DOMContentLoaded', async function () {

        const mainContent = document.querySelector('main');



        // Only show on article pages (not index, not sections)

        const isArticlePage = !window.location.pathname.includes('index.html') &&

            !window.location.pathname.includes('sections/') &&

            !window.location.pathname.endsWith('/');



        if (!isArticlePage || !mainContent) return;



        const articleId = window.location.pathname.replace(/[^a-zA-Z0-9]/g, '_');

        const likeKey = `article_like_${articleId}`; // localStorage key for current user's like state



        // Create Like Section (at page bottom)

        const likeSection = document.createElement('div');

        likeSection.className = 'article-like-section';



        // Initial state from localStorage (for immediate UI feedback)

        const isLiked = localStorage.getItem(likeKey) === 'true';

        let likeCount = 0;



        likeSection.innerHTML = `

            <div class="like-section-inner">

                <p class="like-prompt">觉得有帮助？点赞支持一下 👇</p>

                <button class="like-btn ${isLiked ? 'liked' : ''}" id="article-like-btn" aria-label="点赞">

                    <svg class="like-icon" viewBox="0 0 24 24" width="24" height="24">

                        <path class="heart-outline" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>

                        <path class="heart-fill" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>

                    </svg>

                    <span class="like-text">${isLiked ? '已喜欢' : '喜欢这篇文章'}</span>

                    <span class="like-count" id="like-count"><span class="loading-dots">...</span></span>

                </button>

            </div>

        `;



        mainContent.appendChild(likeSection);



        const likeBtn = document.getElementById('article-like-btn');

        const likeCountSpan = document.getElementById('like-count');

        const likeText = likeBtn.querySelector('.like-text');



        // Supabase API helper

        async function supabaseRequest(method, endpoint, body = null) {

            const options = {

                method: method,

                headers: {

                    'apikey': SUPABASE_ANON_KEY,

                    'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,

                    'Content-Type': 'application/json',

                    'Prefer': method === 'POST' ? 'return=representation' : 'return=minimal'

                }

            };

            if (body) options.body = JSON.stringify(body);



            try {

                const response = await fetch(`${SUPABASE_URL}/rest/v1/${endpoint}`, options);

                if (!response.ok) throw new Error(`HTTP ${response.status}`);

                const text = await response.text();

                return text ? JSON.parse(text) : null;

            } catch (error) {

                console.error('Supabase error:', error);

                return null;

            }

        }



        // Fetch current like count from Supabase

        async function fetchLikeCount() {

            const data = await supabaseRequest('GET', `article_likes?article_id=eq.${articleId}&select=like_count`);

            if (data && data.length > 0) {

                return data[0].like_count;

            }

            return 0;

        }



        // Update like count in Supabase

        async function updateLikeCount(newCount) {

            // Try to update existing record

            const existing = await supabaseRequest('GET', `article_likes?article_id=eq.${articleId}&select=id`);



            if (existing && existing.length > 0) {

                // Update existing

                await supabaseRequest('PATCH', `article_likes?article_id=eq.${articleId}`, {

                    like_count: newCount

                });

            } else {

                // Insert new record

                await supabaseRequest('POST', 'article_likes', {

                    article_id: articleId,

                    like_count: newCount

                });

            }

        }



        // Load initial like count

        try {

            likeCount = await fetchLikeCount();

            likeCountSpan.textContent = likeCount > 0 ? likeCount : '';

        } catch (e) {

            console.error('Failed to fetch likes:', e);

            likeCountSpan.textContent = '';

        }



        // Like button click handler

        likeBtn.addEventListener('click', async function () {

            const currentlyLiked = this.classList.contains('liked');



            // Optimistic UI update

            if (currentlyLiked) {

                this.classList.remove('liked');

                likeCount = Math.max(0, likeCount - 1);

                likeText.textContent = '喜欢这篇文章';

                localStorage.setItem(likeKey, 'false');

            } else {

                this.classList.add('liked');

                likeCount++;

                likeText.textContent = '已喜欢';

                localStorage.setItem(likeKey, 'true');



                this.classList.add('pop');

                setTimeout(() => this.classList.remove('pop'), 300);

            }



            likeCountSpan.textContent = likeCount > 0 ? likeCount : '';



            // Sync with Supabase in background

            try {

                await updateLikeCount(likeCount);

            } catch (e) {

                console.error('Failed to sync like:', e);

            }

        });



        // ============================================

        // Comment Section with Supabase

        // ============================================



        // Create comment section HTML

        const commentSection = document.createElement('div');

        commentSection.className = 'comment-section';

        commentSection.innerHTML = `

            <h4 class="comment-title">💬 评论区</h4>

            <div class="comment-form">

                <input type="text" id="comment-nickname" class="comment-nickname" placeholder="昵称（可选）" maxlength="20">

                <textarea id="comment-content" class="comment-textarea" placeholder="写下你的想法..." maxlength="500" rows="3"></textarea>

                <div class="comment-form-footer">

                    <span class="char-count"><span id="char-count">0</span>/500</span>

                    <button id="submit-comment" class="comment-submit-btn">发表评论</button>

                </div>

            </div>

            <div id="comment-list" class="comment-list">

                <div class="loading-comments">加载评论中...</div>

            </div>

        `;



        // Append comment section after like section

        const likeSectionEl = document.querySelector('.article-like-section');

        if (likeSectionEl) {

            likeSectionEl.after(commentSection);

        } else {

            mainContent.appendChild(commentSection);

        }



        const commentNickname = document.getElementById('comment-nickname');

        const commentContent = document.getElementById('comment-content');

        const submitBtn = document.getElementById('submit-comment');

        const commentList = document.getElementById('comment-list');

        const charCount = document.getElementById('char-count');



        // Visitor ID for identifying own comments

        let visitorId = localStorage.getItem('visitor_id');

        if (!visitorId) {

            visitorId = 'v_' + Math.random().toString(36).substr(2, 9) + Date.now().toString(36);

            localStorage.setItem('visitor_id', visitorId);

        }



        // Character counter

        commentContent.addEventListener('input', () => {

            charCount.textContent = commentContent.value.length;

        });



        // Format time helper

        function formatTime(timestamp) {

            const date = new Date(timestamp);

            const now = new Date();

            const diff = now - date;



            if (diff < 60000) return '刚刚';

            if (diff < 3600000) return Math.floor(diff / 60000) + ' 分钟前';

            if (diff < 86400000) return Math.floor(diff / 3600000) + ' 小时前';

            if (diff < 604800000) return Math.floor(diff / 86400000) + ' 天前';



            return date.toLocaleDateString('zh-CN');

        }



        // Escape HTML to prevent XSS

        function escapeHtml(text) {

            const div = document.createElement('div');

            div.textContent = text;

            return div.innerHTML;

        }



        // Fetch comments from Supabase

        async function fetchComments() {

            const data = await supabaseRequest('GET', `article_comments?article_id=eq.${articleId}&order=created_at.desc`);

            return data || [];

        }



        // Post new comment

        async function postComment(nickname, content) {

            return await supabaseRequest('POST', 'article_comments', {

                article_id: articleId,

                nickname: nickname || '匿名用户',

                content: content,

                visitor_id: visitorId

            });

        }



        // Delete comment

        async function deleteComment(commentId) {

            await supabaseRequest('DELETE', `article_comments?id=eq.${commentId}&visitor_id=eq.${visitorId}`);

        }



        // Render comments

        function renderComments(comments) {

            if (!comments || comments.length === 0) {

                commentList.innerHTML = '<div class="no-comments">暂无评论，来做第一个留言的人吧 🎉</div>';

                return;

            }



            commentList.innerHTML = comments.map(c => `

                <div class="comment-item" data-id="${c.id}">

                    <div class="comment-header">

                        <span class="comment-author">${escapeHtml(c.nickname || '匿名用户')}</span>

                        <span class="comment-time">${formatTime(c.created_at)}</span>

                        ${c.visitor_id === visitorId ? `<button class="comment-delete" data-id="${c.id}">删除</button>` : ''}

                    </div>

                    <div class="comment-body">${escapeHtml(c.content)}</div>

                </div>

            `).join('');



            // Add delete handlers

            commentList.querySelectorAll('.comment-delete').forEach(btn => {

                btn.addEventListener('click', async function () {

                    const id = this.dataset.id;

                    await deleteComment(id);

                    loadComments();

                });

            });

        }



        // Load and display comments

        async function loadComments() {

            try {

                const comments = await fetchComments();

                renderComments(comments);

            } catch (e) {

                console.error('Failed to load comments:', e);

                commentList.innerHTML = '<div class="no-comments">加载评论失败</div>';

            }

        }



        // Submit comment handler

        submitBtn.addEventListener('click', async function () {

            const content = commentContent.value.trim();

            if (!content) {

                alert('请输入评论内容');

                return;

            }



            submitBtn.disabled = true;

            submitBtn.textContent = '发送中...';



            try {

                await postComment(commentNickname.value.trim(), content);

                commentContent.value = '';

                charCount.textContent = '0';

                await loadComments();

            } catch (e) {

                console.error('Failed to post comment:', e);

                alert('评论发送失败，请重试');

            }



            submitBtn.disabled = false;

            submitBtn.textContent = '发表评论';

        });



        // Initial load

        loadComments();

    });

</script>



<!-- Interaction Section Styles -->

<style>

    .article-interaction-section {

        margin-top: 3rem;

        padding-top: 2rem;

        border-top: 2px solid #e5e7eb;

    }



    .interaction-header {

        text-align: center;

        margin-bottom: 2rem;

    }



    .interaction-header h3 {

        font-size: 1.4rem;

        color: #1f2937;

        margin: 0 0 0.5rem 0;

    }



    .interaction-header p {

        color: #6b7280;

        font-size: 0.95rem;

        margin: 0;

    }



    /* Like Section at Bottom */

    .article-like-section {

        margin-top: 3rem;

        padding: 2rem 0;

        border-top: 2px solid #e5e7eb;

        text-align: center;

    }



    .like-section-inner {

        display: flex;

        flex-direction: column;

        align-items: center;

        gap: 1rem;

    }



    .like-prompt {

        color: #6b7280;

        font-size: 0.95rem;

        margin: 0;

    }



    .article-like-section .like-btn {

        padding: 0.75rem 2rem;

        font-size: 1rem;

    }



    .article-like-section .like-icon {

        width: 22px;

        height: 22px;

    }



    /* Mobile */

    @media (max-width: 768px) {

        .article-like-section {

            margin-top: 2rem;

            padding: 1.5rem 0;

        }



        .like-prompt {

            font-size: 0.9rem;

        }

    }



    /* Comment Section */

    .comment-section {

        margin-top: 2rem;

        padding: 1.5rem;

        background: #f9fafb;

        border-radius: 12px;

    }



    .comment-title {

        font-size: 1.1rem;

        color: #1f2937;

        margin: 0 0 1rem 0;

    }



    .comment-form {

        margin-bottom: 1.5rem;

    }



    .comment-nickname {

        width: 200px;

        padding: 0.5rem 0.75rem;

        border: 1px solid #e5e7eb;

        border-radius: 8px;

        font-size: 0.9rem;

        margin-bottom: 0.75rem;

        background: white;

    }



    .comment-textarea {

        width: 100%;

        padding: 0.75rem;

        border: 1px solid #e5e7eb;

        border-radius: 8px;

        font-size: 0.95rem;

        resize: vertical;

        min-height: 80px;

        background: white;

        font-family: inherit;

        box-sizing: border-box;

        margin-bottom: 0.5rem;

    }



    .comment-nickname:focus,

    .comment-textarea:focus {

        outline: none;

        border-color: #4f46e5;

        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);

    }



    .comment-form-footer {

        display: flex;

        justify-content: space-between;

        align-items: center;

    }



    .char-count {

        font-size: 0.8rem;

        color: #9ca3af;

    }



    .comment-submit-btn {

        padding: 0.6rem 1.5rem;

        background: #4f46e5;

        color: white;

        border: none;

        border-radius: 8px;

        font-size: 0.9rem;

        font-weight: 500;

        cursor: pointer;

        transition: all 0.2s;

    }



    .comment-submit-btn:hover:not(:disabled) {

        background: #4338ca;

        transform: translateY(-1px);

    }



    .comment-submit-btn:disabled {

        opacity: 0.6;

        cursor: not-allowed;

    }



    .comment-list {

        margin-top: 1rem;

    }



    .loading-comments,

    .no-comments {

        text-align: center;

        color: #9ca3af;

        padding: 1.5rem;

        font-size: 0.95rem;

    }



    .comment-item {

        background: white;

        border-radius: 8px;

        padding: 1rem;

        margin-bottom: 0.75rem;

        border: 1px solid #e5e7eb;

    }



    .comment-header {

        display: flex;

        align-items: center;

        gap: 0.75rem;

        margin-bottom: 0.5rem;

    }



    .comment-author {

        font-weight: 600;

        color: #1f2937;

        font-size: 0.9rem;

    }



    .comment-time {

        font-size: 0.8rem;

        color: #9ca3af;

    }



    .comment-delete {

        margin-left: auto;

        background: none;

        border: none;

        color: #ef4444;

        font-size: 0.8rem;

        cursor: pointer;

        padding: 0.2rem 0.5rem;

        border-radius: 4px;

    }



    .comment-delete:hover {

        background: #fef2f2;

    }



    .comment-body {

        color: #374151;

        font-size: 0.95rem;

        line-height: 1.6;

        white-space: pre-wrap;

        word-break: break-word;

    }



    /* Mobile Comment Styles */

    @media (max-width: 768px) {

        .comment-section {

            padding: 1rem;

        }



        .comment-nickname {

            width: 100%;

        }



        .comment-title {

            font-size: 1rem;

        }

    }

</style>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Made with <a href="https://quarto.org/">Quarto</a> | © 2024-2026</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>