{"title":"双坐标轴：左右两个 Y 轴的绑图技巧","markdown":{"yaml":{"title":"双坐标轴：左右两个 Y 轴的绑图技巧","date":"2026-01-10","categories":["可视化","ggplot2","双坐标轴"],"image":"figure/dualaxis-cover.png"},"headingText":"加载必要的包","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(\n  echo = TRUE,\n  warning = FALSE,\n  message = FALSE,\n  fig.width = 8,\n  fig.height = 5,\n  fig.retina = 2,\n  out.width = \"100%\",\n  dpi = 150\n)\n\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\n# ggnewscale 用于多图例场景（可选）\nif (requireNamespace(\"ggnewscale\", quietly = TRUE)) {\n  library(ggnewscale)\n}\n```\n\n> 双坐标轴（Dual Y-Axis）图表可以在同一张图中展示两个量纲不同的变量，常用于展示趋势对比、柱线混合图等场景。本教程介绍如何在 ggplot2 中实现双坐标轴绑图。\n\n## 什么是双坐标轴？\n\n双坐标轴图表是指在同一张图中使用两个 Y 轴：\n\n- **左 Y 轴（主轴）**：通常展示主要变量\n- **右 Y 轴（次轴）**：展示次要变量，量纲可能不同\n\n### 适用场景\n\n| 场景 | 示例 |\n|------|------|\n| 柱线混合图 | 柱状图显示销量，折线图显示增长率 |\n| 趋势对比 | 温度与降雨量的时间变化 |\n| 因果关系 | 广告投入与销售额的关系 |\n\n### 争议与注意事项\n\n双坐标轴图表存在一些争议：\n\n1. **误导性**：两个 Y 轴的刻度比例会影响读者对数据关系的理解\n2. **可读性**：增加了图表的复杂度\n3. **替代方案**：分面图（facet）通常是更好的选择\n\n使用建议：\n\n- ✅ 两个变量确实有关联时使用\n- ✅ 明确标注两个轴的单位\n- ❌ 避免刻意调整刻度来制造相关性假象\n\n## 基础用法\n\n### ggplot2 中的 sec_axis()\n\nggplot2 通过 `sec_axis()` 函数实现双坐标轴。核心原理是 **次轴必须是主轴的线性变换**。\n\n```{r}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\n```\n\n### 最简示例\n\n```{r}\n# 创建示例数据\ndf <- data.frame(\n  month = 1:12,\n  sales = c(120, 135, 150, 180, 200, 220, 250, 240, 210, 180, 150, 160),\n  growth_rate = c(5, 8, 12, 15, 18, 20, 22, 18, 12, 8, 5, 6)\n)\n\n# 定义转换系数（让两个变量在图上有相似的范围）\ncoef <- max(df$sales) / max(df$growth_rate)\n\nggplot(df, aes(x = month)) +\n  geom_col(aes(y = sales), fill = \"#4f46e5\", alpha = 0.7) +\n  geom_line(aes(y = growth_rate * coef), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = growth_rate * coef), color = \"#ef4444\", size = 3) +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售额与增长率\", x = NULL) +\n  theme_bw(base_size = 12)\n```\n\n### 关键步骤解析\n\n1. **计算转换系数**：`coef <- max(主轴变量) / max(次轴变量)`\n2. **绑制次轴数据时乘以系数**：`aes(y = growth_rate * coef)`\n3. **设置 sec_axis 时除以系数**：`sec_axis(~ . / coef, name = \"次轴标签\")`\n\n## 柱线混合图\n\n柱线混合图是双坐标轴最常见的应用场景。\n\n### 基础版本\n\n```{r}\n# 模拟季度数据\nquarterly <- data.frame(\n  quarter = c(\"Q1\", \"Q2\", \"Q3\", \"Q4\"),\n  revenue = c(450, 520, 680, 720),\n  profit_margin = c(12, 15, 18, 20)\n)\n\ncoef <- max(quarterly$revenue) / max(quarterly$profit_margin)\n\nggplot(quarterly, aes(x = quarter)) +\n  geom_col(aes(y = revenue), fill = \"#0ea5e9\", width = 0.6) +\n  geom_line(aes(y = profit_margin * coef, group = 1), \n            color = \"#f97316\", linewidth = 1.5) +\n  geom_point(aes(y = profit_margin * coef), \n             color = \"#f97316\", size = 4) +\n  scale_y_continuous(\n    name = \"营收 (万元)\",\n    sec.axis = sec_axis(~ . / coef, name = \"利润率 (%)\")\n  ) +\n  labs(title = \"季度营收与利润率\", x = NULL) +\n  theme_minimal(base_size = 12)\n```\n\n### 添加数据标签\n\n```{r}\nggplot(quarterly, aes(x = quarter)) +\n  geom_col(aes(y = revenue), fill = \"#0ea5e9\", width = 0.6) +\n  geom_text(aes(y = revenue, label = revenue), vjust = -0.5, size = 4) +\n  geom_line(aes(y = profit_margin * coef, group = 1), \n            color = \"#f97316\", linewidth = 1.5) +\n  geom_point(aes(y = profit_margin * coef), \n             color = \"#f97316\", size = 4) +\n  geom_text(aes(y = profit_margin * coef, label = paste0(profit_margin, \"%\")), \n            vjust = -1, color = \"#f97316\", size = 4) +\n  scale_y_continuous(\n    name = \"营收 (万元)\",\n    limits = c(0, max(quarterly$revenue) * 1.15),\n    sec.axis = sec_axis(~ . / coef, name = \"利润率 (%)\")\n  ) +\n  labs(title = \"季度营收与利润率\", x = NULL) +\n  theme_minimal(base_size = 12)\n```\n\n## 双折线图\n\n当两个变量都是连续时间序列时，可以用双折线图。\n\n```{r}\n# 模拟气象数据\nweather <- data.frame(\n  date = seq(as.Date(\"2025-01-01\"), as.Date(\"2025-12-01\"), by = \"month\"),\n  temperature = c(8, 10, 15, 20, 25, 30, 33, 32, 28, 22, 15, 10),\n  rainfall = c(45, 60, 80, 120, 180, 220, 150, 100, 70, 50, 40, 35)\n)\n\ncoef <- max(weather$rainfall) / max(weather$temperature)\n\nggplot(weather, aes(x = date)) +\n  geom_line(aes(y = temperature), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = temperature), color = \"#ef4444\", size = 2.5) +\n  geom_area(aes(y = rainfall / coef), fill = \"#3b82f6\", alpha = 0.3) +\n  geom_line(aes(y = rainfall / coef), color = \"#3b82f6\", linewidth = 1.2) +\n  scale_y_continuous(\n    name = \"温度 (°C)\",\n    sec.axis = sec_axis(~ . * coef, name = \"降雨量 (mm)\")\n  ) +\n  scale_x_date(date_labels = \"%m月\", date_breaks = \"1 month\") +\n  labs(title = \"2025 年月度温度与降雨量\", x = NULL) +\n  theme_bw(base_size = 12) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n## 自定义坐标轴样式\n\n### 匹配颜色\n\n让坐标轴颜色与对应的数据系列颜色一致，提高可读性：\n\n```{r}\nggplot(df, aes(x = month)) +\n  geom_col(aes(y = sales), fill = \"#4f46e5\", alpha = 0.8) +\n  geom_line(aes(y = growth_rate * coef), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = growth_rate * coef), color = \"#ef4444\", size = 3) +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售额与增长率\", x = NULL) +\n  theme_bw(base_size = 12) +\n  theme(\n    axis.title.y.left = element_text(color = \"#4f46e5\", face = \"bold\"),\n    axis.text.y.left = element_text(color = \"#4f46e5\"),\n    axis.title.y.right = element_text(color = \"#ef4444\", face = \"bold\"),\n    axis.text.y.right = element_text(color = \"#ef4444\")\n  )\n```\n\n### 添加图例\n\n双坐标轴图表默认没有图例，需要手动创建：\n\n```{r}\nggplot(df, aes(x = month)) +\n  geom_col(aes(y = sales, fill = \"销售额\"), alpha = 0.8) +\n  geom_line(aes(y = growth_rate * coef, color = \"增长率\"), linewidth = 1.2) +\n  geom_point(aes(y = growth_rate * coef, color = \"增长率\"), size = 3) +\n  scale_fill_manual(values = c(\"销售额\" = \"#4f46e5\")) +\n  scale_color_manual(values = c(\"增长率\" = \"#ef4444\")) +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(\n    title = \"月度销售额与增长率\",\n    x = NULL,\n    fill = NULL,\n    color = NULL\n  ) +\n  theme_bw(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    legend.box = \"horizontal\"\n  ) +\n  guides(\n    fill = guide_legend(order = 1),\n    color = guide_legend(order = 2)\n  )\n```\n\n## 分组双坐标轴\n\n当有分组变量时，可以使用堆叠或分组柱状图。\n\n```{r}\n# 分组数据\ngrouped_data <- data.frame(\n  quarter = rep(c(\"Q1\", \"Q2\", \"Q3\", \"Q4\"), each = 2),\n  category = rep(c(\"产品A\", \"产品B\"), 4),\n  sales = c(200, 150, 250, 180, 300, 220, 280, 250),\n  total_growth = rep(c(8, 12, 15, 10), each = 2)\n)\n\n# 计算每季度总销售额用于绑图\ngrouped_summary <- grouped_data |>\n  group_by(quarter) |>\n  summarise(total_sales = sum(sales), growth = first(total_growth))\n\ncoef <- max(grouped_summary$total_sales) / max(grouped_summary$growth)\n\nggplot() +\n  geom_col(data = grouped_data, \n           aes(x = quarter, y = sales, fill = category),\n           position = \"dodge\", width = 0.7) +\n  geom_line(data = grouped_summary,\n            aes(x = quarter, y = growth * coef, group = 1),\n            color = \"#f97316\", linewidth = 1.5) +\n  geom_point(data = grouped_summary,\n             aes(x = quarter, y = growth * coef),\n             color = \"#f97316\", size = 4) +\n  scale_fill_manual(values = c(\"产品A\" = \"#4f46e5\", \"产品B\" = \"#06b6d4\")) +\n  scale_y_continuous(\n    name = \"销售额 (万元)\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  labs(title = \"分产品销售额与总体增长率\", x = NULL, fill = NULL) +\n  theme_minimal(base_size = 12) +\n  theme(legend.position = \"top\")\n```\n\n## 使用 ggnewscale 实现双图例\n\n当需要为两个轴分别设置完整的图例时，可以使用 `ggnewscale` 包：\n\n```{r eval=requireNamespace(\"ggnewscale\", quietly=TRUE)}\nlibrary(ggnewscale)\n\nggplot(df, aes(x = month)) +\n  # 第一个图层：柱状图\n  geom_col(aes(y = sales, fill = sales), alpha = 0.8) +\n  scale_fill_gradient(low = \"#c7d2fe\", high = \"#4f46e5\", name = \"销售额\") +\n  # 开启新的填充/颜色标度\n\n  new_scale_color() +\n  # 第二个图层：折线图\n  geom_line(aes(y = growth_rate * coef, color = growth_rate), linewidth = 1.5) +\n  geom_point(aes(y = growth_rate * coef, color = growth_rate), size = 3) +\n  scale_color_gradient(low = \"#fca5a5\", high = \"#dc2626\", name = \"增长率 (%)\") +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售额与增长率\", x = NULL) +\n  theme_bw(base_size = 12)\n```\n\n## 实战案例\n\n### 案例1：经济指标对比\n\n```{r}\n# 模拟经济数据\neconomy <- data.frame(\n  year = 2015:2024,\n  gdp = c(68.9, 74.6, 83.2, 91.9, 99.1, 101.4, 114.4, 121.0, 126.1, 134.8),\n  gdp_growth = c(6.9, 6.7, 6.8, 6.6, 6.0, 2.3, 8.1, 3.0, 5.2, 5.0)\n)\n\ncoef <- max(economy$gdp) / max(economy$gdp_growth)\n\nggplot(economy, aes(x = year)) +\n  geom_area(aes(y = gdp), fill = \"#4f46e5\", alpha = 0.3) +\n  geom_line(aes(y = gdp), color = \"#4f46e5\", linewidth = 1.2) +\n  geom_point(aes(y = gdp), color = \"#4f46e5\", size = 2.5) +\n  geom_line(aes(y = gdp_growth * coef), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = gdp_growth * coef), color = \"#ef4444\", size = 2.5) +\n  scale_y_continuous(\n    name = \"GDP (万亿元)\",\n    sec.axis = sec_axis(~ . / coef, name = \"GDP增速 (%)\")\n  ) +\n  scale_x_continuous(breaks = 2015:2024) +\n  labs(title = \"中国 GDP 总量与增速 (2015-2024)\", x = NULL) +\n  theme_bw(base_size = 12) +\n  theme(\n    axis.title.y.left = element_text(color = \"#4f46e5\"),\n    axis.text.y.left = element_text(color = \"#4f46e5\"),\n    axis.title.y.right = element_text(color = \"#ef4444\"),\n    axis.text.y.right = element_text(color = \"#ef4444\"),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n```\n\n### 案例2：营销效果分析\n\n```{r}\n# 模拟营销数据\nmarketing <- data.frame(\n  week = 1:12,\n  ad_spend = c(5, 8, 12, 15, 20, 25, 22, 18, 15, 12, 10, 8),\n  conversions = c(120, 180, 280, 350, 480, 600, 550, 420, 350, 280, 220, 180)\n)\n\ncoef <- max(marketing$conversions) / max(marketing$ad_spend)\n\nggplot(marketing, aes(x = week)) +\n  geom_col(aes(y = conversions, fill = \"转化数\"), alpha = 0.7, width = 0.7) +\n  geom_line(aes(y = ad_spend * coef, color = \"广告支出\"), linewidth = 1.5) +\n  geom_point(aes(y = ad_spend * coef, color = \"广告支出\"), size = 3) +\n  scale_fill_manual(values = c(\"转化数\" = \"#10b981\")) +\n  scale_color_manual(values = c(\"广告支出\" = \"#f59e0b\")) +\n  scale_y_continuous(\n    name = \"转化数\",\n    sec.axis = sec_axis(~ . / coef, name = \"广告支出 (万元)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(\"第\", 1:12, \"周\")) +\n  labs(\n    title = \"广告投入与转化效果\",\n    subtitle = \"12 周营销活动追踪\",\n    x = NULL, fill = NULL, color = NULL\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n```\n\n### 案例3：库存管理\n\n```{r fig.width=10}\n# 模拟库存数据\ninventory <- data.frame(\n  month = factor(month.abb, levels = month.abb),\n  stock = c(1000, 850, 920, 780, 650, 500, 600, 750, 900, 1100, 1200, 1050),\n  turnover = c(2.5, 2.8, 2.6, 3.0, 3.5, 4.0, 3.8, 3.2, 2.8, 2.4, 2.2, 2.5)\n)\n\ncoef <- max(inventory$stock) / max(inventory$turnover)\n\nggplot(inventory, aes(x = month)) +\n  geom_col(aes(y = stock), fill = \"#6366f1\", alpha = 0.7, width = 0.6) +\n  geom_line(aes(y = turnover * coef, group = 1), \n            color = \"#ec4899\", linewidth = 1.5) +\n  geom_point(aes(y = turnover * coef), color = \"#ec4899\", size = 3.5) +\n  geom_hline(yintercept = 800, linetype = \"dashed\", color = \"#6366f1\", alpha = 0.5) +\n  annotate(\"text\", x = 11.5, y = 850, label = \"安全库存线\", \n           color = \"#6366f1\", size = 3.5) +\n  scale_y_continuous(\n    name = \"库存量 (件)\",\n    sec.axis = sec_axis(~ . / coef, name = \"周转率\")\n  ) +\n  labs(\n    title = \"库存量与周转率月度变化\",\n    x = NULL\n  ) +\n  theme_bw(base_size = 12) +\n  theme(\n    axis.title.y.left = element_text(color = \"#6366f1\", face = \"bold\"),\n    axis.text.y.left = element_text(color = \"#6366f1\"),\n    axis.title.y.right = element_text(color = \"#ec4899\", face = \"bold\"),\n    axis.text.y.right = element_text(color = \"#ec4899\")\n  )\n```\n\n## 封装函数\n\n为了方便复用，可以将双坐标轴绑图封装成函数：\n\n```{r}\n#' 创建柱线混合双坐标轴图\n#' \n#' @param data 数据框\n#' @param x x轴变量名（字符串）\n#' @param y1 主轴变量名（柱状图）\n#' @param y2 次轴变量名（折线图）\n#' @param y1_name 主轴标签\n#' @param y2_name 次轴标签\n#' @param title 图表标题\n#' @param bar_color 柱状图颜色\n#' @param line_color 折线图颜色\ncreate_dual_axis_plot <- function(\n    data, x, y1, y2,\n    y1_name = y1, y2_name = y2,\n    title = NULL,\n    bar_color = \"#4f46e5\",\n    line_color = \"#ef4444\"\n) {\n  \n  # 提取数据\n  x_val <- data[[x]]\n  y1_val <- data[[y1]]\n  y2_val <- data[[y2]]\n  \n  # 计算转换系数\n  coef <- max(y1_val, na.rm = TRUE) / max(y2_val, na.rm = TRUE)\n  \n  # 创建绑图数据\n  plot_data <- data.frame(\n    x = x_val,\n    y1 = y1_val,\n    y2 = y2_val,\n    y2_scaled = y2_val * coef\n  )\n  \n  # 绘图\n  ggplot(plot_data, aes(x = x)) +\n    geom_col(aes(y = y1), fill = bar_color, alpha = 0.7, width = 0.6) +\n    geom_line(aes(y = y2_scaled, group = 1), color = line_color, linewidth = 1.2) +\n    geom_point(aes(y = y2_scaled), color = line_color, size = 3) +\n    scale_y_continuous(\n      name = y1_name,\n      sec.axis = sec_axis(~ . / coef, name = y2_name)\n    ) +\n    labs(title = title, x = NULL) +\n    theme_bw(base_size = 12) +\n    theme(\n      axis.title.y.left = element_text(color = bar_color, face = \"bold\"),\n      axis.text.y.left = element_text(color = bar_color),\n      axis.title.y.right = element_text(color = line_color, face = \"bold\"),\n      axis.text.y.right = element_text(color = line_color)\n    )\n}\n\n# 使用示例\ncreate_dual_axis_plot(\n  data = df,\n  x = \"month\",\n  y1 = \"sales\",\n  y2 = \"growth_rate\",\n  y1_name = \"销售额\",\n  y2_name = \"增长率 (%)\",\n  title = \"月度销售数据\"\n)\n```\n\n## 常见问题\n\n### 1. 如何确定合适的转换系数？\n\n最常用的方法是让两个变量的最大值对齐：\n\n```r\ncoef <- max(主轴变量) / max(次轴变量)\n```\n\n也可以根据数据范围调整：\n\n```r\n# 让两个变量的范围对齐\ncoef <- diff(range(主轴变量)) / diff(range(次轴变量))\n```\n\n### 2. 次轴数据显示不完整怎么办？\n\n调整主轴的 limits：\n\n```r\nscale_y_continuous(\n  limits = c(0, max(主轴变量) * 1.1),  # 留出10%空间\n  sec.axis = sec_axis(...)\n)\n```\n\n### 3. 如何让次轴从 0 开始？\n\n需要对数据进行偏移变换：\n\n```{r}\n# 示例：次轴数据范围是 10-30，想让它从 0 开始显示\ndf_offset <- data.frame(\n  x = 1:5,\n  y1 = c(100, 150, 200, 180, 220),\n  y2 = c(10, 15, 20, 25, 30)\n)\n\n# 计算偏移和缩放\ny2_min <- min(df_offset$y2)\ny2_max <- max(df_offset$y2)\ny1_max <- max(df_offset$y1)\n\n# 变换公式: y2_transformed = (y2 - y2_min) * y1_max / (y2_max - y2_min)\ncoef <- y1_max / (y2_max - y2_min)\noffset <- y2_min\n\nggplot(df_offset, aes(x = x)) +\n  geom_col(aes(y = y1), fill = \"#4f46e5\", alpha = 0.7) +\n  geom_line(aes(y = (y2 - offset) * coef), color = \"#ef4444\", linewidth = 1.2) +\n  scale_y_continuous(\n    name = \"主轴\",\n    sec.axis = sec_axis(~ . / coef + offset, name = \"次轴\")\n  ) +\n  theme_bw()\n```\n\n### 4. 双坐标轴 vs 分面图\n\n当不确定是否使用双坐标轴时，考虑用分面图替代：\n\n```{r fig.height=6}\n# 数据转换为长格式\ndf_long <- df |>\n  pivot_longer(cols = c(sales, growth_rate), \n               names_to = \"metric\", \n               values_to = \"value\") |>\n  mutate(metric = ifelse(metric == \"sales\", \"销售额\", \"增长率 (%)\"))\n\n# 分面图\nggplot(df_long, aes(x = month, y = value, color = metric)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.5) +\n  facet_wrap(~ metric, ncol = 1, scales = \"free_y\") +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售数据\", x = NULL, y = NULL, color = NULL) +\n  theme_bw(base_size = 12) +\n  theme(legend.position = \"none\")\n```\n\n## 总结\n\n双坐标轴的核心要点：\n\n1. **原理**：次轴是主轴的线性变换，通过 `sec_axis()` 实现\n2. **转换系数**：`coef = max(主轴) / max(次轴)`\n3. **绘制次轴数据**：乘以系数 `y2 * coef`\n4. **设置次轴刻度**：除以系数 `~ . / coef`\n5. **美化**：匹配坐标轴颜色，添加图例\n\n使用建议：\n\n- ✅ 两个变量有明确关联时使用\n- ✅ 用颜色区分两个轴\n- ✅ 清晰标注单位\n- ❌ 避免刻意调整比例误导读者\n- ❌ 当数据复杂时，考虑分面图替代\n\n## 参考资源\n\n- [ggplot2 官方文档 - sec_axis](https://ggplot2.tidyverse.org/reference/sec_axis.html)\n- [ggnewscale 包](https://github.com/eliocamp/ggnewscale)\n- [Why not to use two Y axes](https://blog.datawrapper.de/dualaxis/) - 关于双坐标轴争议的讨论\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(\n  echo = TRUE,\n  warning = FALSE,\n  message = FALSE,\n  fig.width = 8,\n  fig.height = 5,\n  fig.retina = 2,\n  out.width = \"100%\",\n  dpi = 150\n)\n\n# 加载必要的包\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\n# ggnewscale 用于多图例场景（可选）\nif (requireNamespace(\"ggnewscale\", quietly = TRUE)) {\n  library(ggnewscale)\n}\n```\n\n> 双坐标轴（Dual Y-Axis）图表可以在同一张图中展示两个量纲不同的变量，常用于展示趋势对比、柱线混合图等场景。本教程介绍如何在 ggplot2 中实现双坐标轴绑图。\n\n## 什么是双坐标轴？\n\n双坐标轴图表是指在同一张图中使用两个 Y 轴：\n\n- **左 Y 轴（主轴）**：通常展示主要变量\n- **右 Y 轴（次轴）**：展示次要变量，量纲可能不同\n\n### 适用场景\n\n| 场景 | 示例 |\n|------|------|\n| 柱线混合图 | 柱状图显示销量，折线图显示增长率 |\n| 趋势对比 | 温度与降雨量的时间变化 |\n| 因果关系 | 广告投入与销售额的关系 |\n\n### 争议与注意事项\n\n双坐标轴图表存在一些争议：\n\n1. **误导性**：两个 Y 轴的刻度比例会影响读者对数据关系的理解\n2. **可读性**：增加了图表的复杂度\n3. **替代方案**：分面图（facet）通常是更好的选择\n\n使用建议：\n\n- ✅ 两个变量确实有关联时使用\n- ✅ 明确标注两个轴的单位\n- ❌ 避免刻意调整刻度来制造相关性假象\n\n## 基础用法\n\n### ggplot2 中的 sec_axis()\n\nggplot2 通过 `sec_axis()` 函数实现双坐标轴。核心原理是 **次轴必须是主轴的线性变换**。\n\n```{r}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\n```\n\n### 最简示例\n\n```{r}\n# 创建示例数据\ndf <- data.frame(\n  month = 1:12,\n  sales = c(120, 135, 150, 180, 200, 220, 250, 240, 210, 180, 150, 160),\n  growth_rate = c(5, 8, 12, 15, 18, 20, 22, 18, 12, 8, 5, 6)\n)\n\n# 定义转换系数（让两个变量在图上有相似的范围）\ncoef <- max(df$sales) / max(df$growth_rate)\n\nggplot(df, aes(x = month)) +\n  geom_col(aes(y = sales), fill = \"#4f46e5\", alpha = 0.7) +\n  geom_line(aes(y = growth_rate * coef), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = growth_rate * coef), color = \"#ef4444\", size = 3) +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售额与增长率\", x = NULL) +\n  theme_bw(base_size = 12)\n```\n\n### 关键步骤解析\n\n1. **计算转换系数**：`coef <- max(主轴变量) / max(次轴变量)`\n2. **绑制次轴数据时乘以系数**：`aes(y = growth_rate * coef)`\n3. **设置 sec_axis 时除以系数**：`sec_axis(~ . / coef, name = \"次轴标签\")`\n\n## 柱线混合图\n\n柱线混合图是双坐标轴最常见的应用场景。\n\n### 基础版本\n\n```{r}\n# 模拟季度数据\nquarterly <- data.frame(\n  quarter = c(\"Q1\", \"Q2\", \"Q3\", \"Q4\"),\n  revenue = c(450, 520, 680, 720),\n  profit_margin = c(12, 15, 18, 20)\n)\n\ncoef <- max(quarterly$revenue) / max(quarterly$profit_margin)\n\nggplot(quarterly, aes(x = quarter)) +\n  geom_col(aes(y = revenue), fill = \"#0ea5e9\", width = 0.6) +\n  geom_line(aes(y = profit_margin * coef, group = 1), \n            color = \"#f97316\", linewidth = 1.5) +\n  geom_point(aes(y = profit_margin * coef), \n             color = \"#f97316\", size = 4) +\n  scale_y_continuous(\n    name = \"营收 (万元)\",\n    sec.axis = sec_axis(~ . / coef, name = \"利润率 (%)\")\n  ) +\n  labs(title = \"季度营收与利润率\", x = NULL) +\n  theme_minimal(base_size = 12)\n```\n\n### 添加数据标签\n\n```{r}\nggplot(quarterly, aes(x = quarter)) +\n  geom_col(aes(y = revenue), fill = \"#0ea5e9\", width = 0.6) +\n  geom_text(aes(y = revenue, label = revenue), vjust = -0.5, size = 4) +\n  geom_line(aes(y = profit_margin * coef, group = 1), \n            color = \"#f97316\", linewidth = 1.5) +\n  geom_point(aes(y = profit_margin * coef), \n             color = \"#f97316\", size = 4) +\n  geom_text(aes(y = profit_margin * coef, label = paste0(profit_margin, \"%\")), \n            vjust = -1, color = \"#f97316\", size = 4) +\n  scale_y_continuous(\n    name = \"营收 (万元)\",\n    limits = c(0, max(quarterly$revenue) * 1.15),\n    sec.axis = sec_axis(~ . / coef, name = \"利润率 (%)\")\n  ) +\n  labs(title = \"季度营收与利润率\", x = NULL) +\n  theme_minimal(base_size = 12)\n```\n\n## 双折线图\n\n当两个变量都是连续时间序列时，可以用双折线图。\n\n```{r}\n# 模拟气象数据\nweather <- data.frame(\n  date = seq(as.Date(\"2025-01-01\"), as.Date(\"2025-12-01\"), by = \"month\"),\n  temperature = c(8, 10, 15, 20, 25, 30, 33, 32, 28, 22, 15, 10),\n  rainfall = c(45, 60, 80, 120, 180, 220, 150, 100, 70, 50, 40, 35)\n)\n\ncoef <- max(weather$rainfall) / max(weather$temperature)\n\nggplot(weather, aes(x = date)) +\n  geom_line(aes(y = temperature), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = temperature), color = \"#ef4444\", size = 2.5) +\n  geom_area(aes(y = rainfall / coef), fill = \"#3b82f6\", alpha = 0.3) +\n  geom_line(aes(y = rainfall / coef), color = \"#3b82f6\", linewidth = 1.2) +\n  scale_y_continuous(\n    name = \"温度 (°C)\",\n    sec.axis = sec_axis(~ . * coef, name = \"降雨量 (mm)\")\n  ) +\n  scale_x_date(date_labels = \"%m月\", date_breaks = \"1 month\") +\n  labs(title = \"2025 年月度温度与降雨量\", x = NULL) +\n  theme_bw(base_size = 12) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n## 自定义坐标轴样式\n\n### 匹配颜色\n\n让坐标轴颜色与对应的数据系列颜色一致，提高可读性：\n\n```{r}\nggplot(df, aes(x = month)) +\n  geom_col(aes(y = sales), fill = \"#4f46e5\", alpha = 0.8) +\n  geom_line(aes(y = growth_rate * coef), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = growth_rate * coef), color = \"#ef4444\", size = 3) +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售额与增长率\", x = NULL) +\n  theme_bw(base_size = 12) +\n  theme(\n    axis.title.y.left = element_text(color = \"#4f46e5\", face = \"bold\"),\n    axis.text.y.left = element_text(color = \"#4f46e5\"),\n    axis.title.y.right = element_text(color = \"#ef4444\", face = \"bold\"),\n    axis.text.y.right = element_text(color = \"#ef4444\")\n  )\n```\n\n### 添加图例\n\n双坐标轴图表默认没有图例，需要手动创建：\n\n```{r}\nggplot(df, aes(x = month)) +\n  geom_col(aes(y = sales, fill = \"销售额\"), alpha = 0.8) +\n  geom_line(aes(y = growth_rate * coef, color = \"增长率\"), linewidth = 1.2) +\n  geom_point(aes(y = growth_rate * coef, color = \"增长率\"), size = 3) +\n  scale_fill_manual(values = c(\"销售额\" = \"#4f46e5\")) +\n  scale_color_manual(values = c(\"增长率\" = \"#ef4444\")) +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(\n    title = \"月度销售额与增长率\",\n    x = NULL,\n    fill = NULL,\n    color = NULL\n  ) +\n  theme_bw(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    legend.box = \"horizontal\"\n  ) +\n  guides(\n    fill = guide_legend(order = 1),\n    color = guide_legend(order = 2)\n  )\n```\n\n## 分组双坐标轴\n\n当有分组变量时，可以使用堆叠或分组柱状图。\n\n```{r}\n# 分组数据\ngrouped_data <- data.frame(\n  quarter = rep(c(\"Q1\", \"Q2\", \"Q3\", \"Q4\"), each = 2),\n  category = rep(c(\"产品A\", \"产品B\"), 4),\n  sales = c(200, 150, 250, 180, 300, 220, 280, 250),\n  total_growth = rep(c(8, 12, 15, 10), each = 2)\n)\n\n# 计算每季度总销售额用于绑图\ngrouped_summary <- grouped_data |>\n  group_by(quarter) |>\n  summarise(total_sales = sum(sales), growth = first(total_growth))\n\ncoef <- max(grouped_summary$total_sales) / max(grouped_summary$growth)\n\nggplot() +\n  geom_col(data = grouped_data, \n           aes(x = quarter, y = sales, fill = category),\n           position = \"dodge\", width = 0.7) +\n  geom_line(data = grouped_summary,\n            aes(x = quarter, y = growth * coef, group = 1),\n            color = \"#f97316\", linewidth = 1.5) +\n  geom_point(data = grouped_summary,\n             aes(x = quarter, y = growth * coef),\n             color = \"#f97316\", size = 4) +\n  scale_fill_manual(values = c(\"产品A\" = \"#4f46e5\", \"产品B\" = \"#06b6d4\")) +\n  scale_y_continuous(\n    name = \"销售额 (万元)\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  labs(title = \"分产品销售额与总体增长率\", x = NULL, fill = NULL) +\n  theme_minimal(base_size = 12) +\n  theme(legend.position = \"top\")\n```\n\n## 使用 ggnewscale 实现双图例\n\n当需要为两个轴分别设置完整的图例时，可以使用 `ggnewscale` 包：\n\n```{r eval=requireNamespace(\"ggnewscale\", quietly=TRUE)}\nlibrary(ggnewscale)\n\nggplot(df, aes(x = month)) +\n  # 第一个图层：柱状图\n  geom_col(aes(y = sales, fill = sales), alpha = 0.8) +\n  scale_fill_gradient(low = \"#c7d2fe\", high = \"#4f46e5\", name = \"销售额\") +\n  # 开启新的填充/颜色标度\n\n  new_scale_color() +\n  # 第二个图层：折线图\n  geom_line(aes(y = growth_rate * coef, color = growth_rate), linewidth = 1.5) +\n  geom_point(aes(y = growth_rate * coef, color = growth_rate), size = 3) +\n  scale_color_gradient(low = \"#fca5a5\", high = \"#dc2626\", name = \"增长率 (%)\") +\n  scale_y_continuous(\n    name = \"销售额\",\n    sec.axis = sec_axis(~ . / coef, name = \"增长率 (%)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售额与增长率\", x = NULL) +\n  theme_bw(base_size = 12)\n```\n\n## 实战案例\n\n### 案例1：经济指标对比\n\n```{r}\n# 模拟经济数据\neconomy <- data.frame(\n  year = 2015:2024,\n  gdp = c(68.9, 74.6, 83.2, 91.9, 99.1, 101.4, 114.4, 121.0, 126.1, 134.8),\n  gdp_growth = c(6.9, 6.7, 6.8, 6.6, 6.0, 2.3, 8.1, 3.0, 5.2, 5.0)\n)\n\ncoef <- max(economy$gdp) / max(economy$gdp_growth)\n\nggplot(economy, aes(x = year)) +\n  geom_area(aes(y = gdp), fill = \"#4f46e5\", alpha = 0.3) +\n  geom_line(aes(y = gdp), color = \"#4f46e5\", linewidth = 1.2) +\n  geom_point(aes(y = gdp), color = \"#4f46e5\", size = 2.5) +\n  geom_line(aes(y = gdp_growth * coef), color = \"#ef4444\", linewidth = 1.2) +\n  geom_point(aes(y = gdp_growth * coef), color = \"#ef4444\", size = 2.5) +\n  scale_y_continuous(\n    name = \"GDP (万亿元)\",\n    sec.axis = sec_axis(~ . / coef, name = \"GDP增速 (%)\")\n  ) +\n  scale_x_continuous(breaks = 2015:2024) +\n  labs(title = \"中国 GDP 总量与增速 (2015-2024)\", x = NULL) +\n  theme_bw(base_size = 12) +\n  theme(\n    axis.title.y.left = element_text(color = \"#4f46e5\"),\n    axis.text.y.left = element_text(color = \"#4f46e5\"),\n    axis.title.y.right = element_text(color = \"#ef4444\"),\n    axis.text.y.right = element_text(color = \"#ef4444\"),\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n```\n\n### 案例2：营销效果分析\n\n```{r}\n# 模拟营销数据\nmarketing <- data.frame(\n  week = 1:12,\n  ad_spend = c(5, 8, 12, 15, 20, 25, 22, 18, 15, 12, 10, 8),\n  conversions = c(120, 180, 280, 350, 480, 600, 550, 420, 350, 280, 220, 180)\n)\n\ncoef <- max(marketing$conversions) / max(marketing$ad_spend)\n\nggplot(marketing, aes(x = week)) +\n  geom_col(aes(y = conversions, fill = \"转化数\"), alpha = 0.7, width = 0.7) +\n  geom_line(aes(y = ad_spend * coef, color = \"广告支出\"), linewidth = 1.5) +\n  geom_point(aes(y = ad_spend * coef, color = \"广告支出\"), size = 3) +\n  scale_fill_manual(values = c(\"转化数\" = \"#10b981\")) +\n  scale_color_manual(values = c(\"广告支出\" = \"#f59e0b\")) +\n  scale_y_continuous(\n    name = \"转化数\",\n    sec.axis = sec_axis(~ . / coef, name = \"广告支出 (万元)\")\n  ) +\n  scale_x_continuous(breaks = 1:12, labels = paste0(\"第\", 1:12, \"周\")) +\n  labs(\n    title = \"广告投入与转化效果\",\n    subtitle = \"12 周营销活动追踪\",\n    x = NULL, fill = NULL, color = NULL\n  ) +\n  theme_minimal(base_size = 12) +\n  theme(\n    legend.position = \"top\",\n    axis.text.x = element_text(angle = 45, hjust = 1)\n  )\n```\n\n### 案例3：库存管理\n\n```{r fig.width=10}\n# 模拟库存数据\ninventory <- data.frame(\n  month = factor(month.abb, levels = month.abb),\n  stock = c(1000, 850, 920, 780, 650, 500, 600, 750, 900, 1100, 1200, 1050),\n  turnover = c(2.5, 2.8, 2.6, 3.0, 3.5, 4.0, 3.8, 3.2, 2.8, 2.4, 2.2, 2.5)\n)\n\ncoef <- max(inventory$stock) / max(inventory$turnover)\n\nggplot(inventory, aes(x = month)) +\n  geom_col(aes(y = stock), fill = \"#6366f1\", alpha = 0.7, width = 0.6) +\n  geom_line(aes(y = turnover * coef, group = 1), \n            color = \"#ec4899\", linewidth = 1.5) +\n  geom_point(aes(y = turnover * coef), color = \"#ec4899\", size = 3.5) +\n  geom_hline(yintercept = 800, linetype = \"dashed\", color = \"#6366f1\", alpha = 0.5) +\n  annotate(\"text\", x = 11.5, y = 850, label = \"安全库存线\", \n           color = \"#6366f1\", size = 3.5) +\n  scale_y_continuous(\n    name = \"库存量 (件)\",\n    sec.axis = sec_axis(~ . / coef, name = \"周转率\")\n  ) +\n  labs(\n    title = \"库存量与周转率月度变化\",\n    x = NULL\n  ) +\n  theme_bw(base_size = 12) +\n  theme(\n    axis.title.y.left = element_text(color = \"#6366f1\", face = \"bold\"),\n    axis.text.y.left = element_text(color = \"#6366f1\"),\n    axis.title.y.right = element_text(color = \"#ec4899\", face = \"bold\"),\n    axis.text.y.right = element_text(color = \"#ec4899\")\n  )\n```\n\n## 封装函数\n\n为了方便复用，可以将双坐标轴绑图封装成函数：\n\n```{r}\n#' 创建柱线混合双坐标轴图\n#' \n#' @param data 数据框\n#' @param x x轴变量名（字符串）\n#' @param y1 主轴变量名（柱状图）\n#' @param y2 次轴变量名（折线图）\n#' @param y1_name 主轴标签\n#' @param y2_name 次轴标签\n#' @param title 图表标题\n#' @param bar_color 柱状图颜色\n#' @param line_color 折线图颜色\ncreate_dual_axis_plot <- function(\n    data, x, y1, y2,\n    y1_name = y1, y2_name = y2,\n    title = NULL,\n    bar_color = \"#4f46e5\",\n    line_color = \"#ef4444\"\n) {\n  \n  # 提取数据\n  x_val <- data[[x]]\n  y1_val <- data[[y1]]\n  y2_val <- data[[y2]]\n  \n  # 计算转换系数\n  coef <- max(y1_val, na.rm = TRUE) / max(y2_val, na.rm = TRUE)\n  \n  # 创建绑图数据\n  plot_data <- data.frame(\n    x = x_val,\n    y1 = y1_val,\n    y2 = y2_val,\n    y2_scaled = y2_val * coef\n  )\n  \n  # 绘图\n  ggplot(plot_data, aes(x = x)) +\n    geom_col(aes(y = y1), fill = bar_color, alpha = 0.7, width = 0.6) +\n    geom_line(aes(y = y2_scaled, group = 1), color = line_color, linewidth = 1.2) +\n    geom_point(aes(y = y2_scaled), color = line_color, size = 3) +\n    scale_y_continuous(\n      name = y1_name,\n      sec.axis = sec_axis(~ . / coef, name = y2_name)\n    ) +\n    labs(title = title, x = NULL) +\n    theme_bw(base_size = 12) +\n    theme(\n      axis.title.y.left = element_text(color = bar_color, face = \"bold\"),\n      axis.text.y.left = element_text(color = bar_color),\n      axis.title.y.right = element_text(color = line_color, face = \"bold\"),\n      axis.text.y.right = element_text(color = line_color)\n    )\n}\n\n# 使用示例\ncreate_dual_axis_plot(\n  data = df,\n  x = \"month\",\n  y1 = \"sales\",\n  y2 = \"growth_rate\",\n  y1_name = \"销售额\",\n  y2_name = \"增长率 (%)\",\n  title = \"月度销售数据\"\n)\n```\n\n## 常见问题\n\n### 1. 如何确定合适的转换系数？\n\n最常用的方法是让两个变量的最大值对齐：\n\n```r\ncoef <- max(主轴变量) / max(次轴变量)\n```\n\n也可以根据数据范围调整：\n\n```r\n# 让两个变量的范围对齐\ncoef <- diff(range(主轴变量)) / diff(range(次轴变量))\n```\n\n### 2. 次轴数据显示不完整怎么办？\n\n调整主轴的 limits：\n\n```r\nscale_y_continuous(\n  limits = c(0, max(主轴变量) * 1.1),  # 留出10%空间\n  sec.axis = sec_axis(...)\n)\n```\n\n### 3. 如何让次轴从 0 开始？\n\n需要对数据进行偏移变换：\n\n```{r}\n# 示例：次轴数据范围是 10-30，想让它从 0 开始显示\ndf_offset <- data.frame(\n  x = 1:5,\n  y1 = c(100, 150, 200, 180, 220),\n  y2 = c(10, 15, 20, 25, 30)\n)\n\n# 计算偏移和缩放\ny2_min <- min(df_offset$y2)\ny2_max <- max(df_offset$y2)\ny1_max <- max(df_offset$y1)\n\n# 变换公式: y2_transformed = (y2 - y2_min) * y1_max / (y2_max - y2_min)\ncoef <- y1_max / (y2_max - y2_min)\noffset <- y2_min\n\nggplot(df_offset, aes(x = x)) +\n  geom_col(aes(y = y1), fill = \"#4f46e5\", alpha = 0.7) +\n  geom_line(aes(y = (y2 - offset) * coef), color = \"#ef4444\", linewidth = 1.2) +\n  scale_y_continuous(\n    name = \"主轴\",\n    sec.axis = sec_axis(~ . / coef + offset, name = \"次轴\")\n  ) +\n  theme_bw()\n```\n\n### 4. 双坐标轴 vs 分面图\n\n当不确定是否使用双坐标轴时，考虑用分面图替代：\n\n```{r fig.height=6}\n# 数据转换为长格式\ndf_long <- df |>\n  pivot_longer(cols = c(sales, growth_rate), \n               names_to = \"metric\", \n               values_to = \"value\") |>\n  mutate(metric = ifelse(metric == \"sales\", \"销售额\", \"增长率 (%)\"))\n\n# 分面图\nggplot(df_long, aes(x = month, y = value, color = metric)) +\n  geom_line(linewidth = 1.2) +\n  geom_point(size = 2.5) +\n  facet_wrap(~ metric, ncol = 1, scales = \"free_y\") +\n  scale_x_continuous(breaks = 1:12, labels = paste0(1:12, \"月\")) +\n  labs(title = \"月度销售数据\", x = NULL, y = NULL, color = NULL) +\n  theme_bw(base_size = 12) +\n  theme(legend.position = \"none\")\n```\n\n## 总结\n\n双坐标轴的核心要点：\n\n1. **原理**：次轴是主轴的线性变换，通过 `sec_axis()` 实现\n2. **转换系数**：`coef = max(主轴) / max(次轴)`\n3. **绘制次轴数据**：乘以系数 `y2 * coef`\n4. **设置次轴刻度**：除以系数 `~ . / coef`\n5. **美化**：匹配坐标轴颜色，添加图例\n\n使用建议：\n\n- ✅ 两个变量有明确关联时使用\n- ✅ 用颜色区分两个轴\n- ✅ 清晰标注单位\n- ❌ 避免刻意调整比例误导读者\n- ❌ 当数据复杂时，考虑分面图替代\n\n## 参考资源\n\n- [ggplot2 官方文档 - sec_axis](https://ggplot2.tidyverse.org/reference/sec_axis.html)\n- [ggnewscale 包](https://github.com/eliocamp/ggnewscale)\n- [Why not to use two Y axes](https://blog.datawrapper.de/dualaxis/) - 关于双坐标轴争议的讨论\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"css":["styles.css"],"highlight-style":"github","output-file":"2019-dualaxis.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","theme":{"light":["cosmo","theme.scss"]},"toc-title":"目录","toc-location":"right","code-copy":true,"smooth-scroll":true,"page-layout":"full","title":"双坐标轴：左右两个 Y 轴的绑图技巧","date":"2026-01-10","categories":["可视化","ggplot2","双坐标轴"],"image":"figure/dualaxis-cover.png"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}