---
title: TreeAge Proï¼šå«ç”Ÿç»æµå­¦å†³ç­–åˆ†æè½¯ä»¶æŒ‡å—
date: '2026-01-15'
categories:
- ç‰¹æ®Šåº”ç”¨
- å«ç”Ÿç»æµå­¦
- TreeAge Pro
- è½¯ä»¶æ•™ç¨‹
image: images/treeage_cover.svg
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    warning = FALSE,
    message = FALSE,
    fig.width = 8,
    fig.height = 5,
    fig.retina = 2,
    out.width = "100%",
    dpi = 150
)
```

## ä»€ä¹ˆæ˜¯ TreeAge Pro

TreeAge Pro æ˜¯ä¸€æ¬¾ä¸“ä¸šçš„**å«ç”Ÿç»æµå­¦å†³ç­–åˆ†æè½¯ä»¶**ï¼Œå¹¿æ³›åº”ç”¨äºåŒ»ç–—å«ç”ŸæŠ€æœ¯è¯„ä¼°ï¼ˆHTAï¼‰ã€å«ç”Ÿç»æµå­¦è¯„ä»·å’Œä¸´åºŠå†³ç­–åˆ†æã€‚å®ƒæä¾›ç›´è§‚çš„å›¾å½¢ç•Œé¢æ¥æ„å»ºå†³ç­–æ ‘ã€é©¬å°”å¯å¤«æ¨¡å‹ï¼Œå¹¶è¿›è¡Œæˆæœ¬æ•ˆæœåˆ†æã€‚

### è½¯ä»¶ç‰¹ç‚¹

| ç‰¹ç‚¹ | è¯´æ˜ |
|------|------|
| å¯è§†åŒ–å»ºæ¨¡ | é€šè¿‡æ‹–æ‹½èŠ‚ç‚¹ç›´è§‚æ„å»ºå†³ç­–æ¨¡å‹ |
| é›†æˆåˆ†æ | å†…ç½®æˆæœ¬æ•ˆæœåˆ†æã€æ•æ„Ÿæ€§åˆ†æç­‰åŠŸèƒ½ |
| ä¸“ä¸šè¾“å‡º | ç”Ÿæˆç¬¦åˆ ISPOR æ ‡å‡†çš„æŠ¥å‘Šå’Œå›¾è¡¨ |
| çµæ´»å®šåˆ¶ | æ”¯æŒå˜é‡å®šä¹‰ã€å‡½æ•°è¡¨è¾¾å¼å’Œå¤æ‚é€»è¾‘ |

### ä¸ R è¯­è¨€çš„å…³ç³»

è™½ç„¶ R è¯­è¨€çš„ `heemod`ã€`hesim` ç­‰åŒ…ä¹Ÿèƒ½è¿›è¡Œå«ç”Ÿç»æµå­¦åˆ†æï¼Œä½† TreeAge Pro å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

- **æ›´ç›´è§‚çš„æ¨¡å‹å¯è§†åŒ–**ï¼šå®æ—¶å±•ç¤ºå†³ç­–æ ‘å’Œé©¬å°”å¯å¤«æ¨¡å‹ç»“æ„
- **å†…ç½®éªŒè¯åŠŸèƒ½**ï¼šè‡ªåŠ¨æ£€æŸ¥æ¦‚ç‡æ€»å’Œã€å¾ªç¯ä¾èµ–ç­‰é—®é¢˜
- **é€‚åˆå¤æ‚æ¨¡å‹**ï¼šå¤„ç†å¤§å‹æ¨¡å‹æ—¶æ›´ç¨³å®š
- **å›¢é˜Ÿåä½œ**ï¼šä¾¿äºä¸éç¼–ç¨‹èƒŒæ™¯çš„åˆä½œè€…æ²Ÿé€š

> ğŸ’¡ å»ºè®®å°† TreeAge Pro ä¸ R è¯­è¨€ç»“åˆä½¿ç”¨ï¼šåœ¨ TreeAge ä¸­æ„å»ºæ¨¡å‹é€»è¾‘ï¼Œç”¨ R è¿›è¡Œæ•°æ®é¢„å¤„ç†å’Œç»“æœå¯è§†åŒ–ã€‚

---

## è½¯ä»¶å®‰è£…ä¸ç•Œé¢æ¦‚è§ˆ

### è·å–è½¯ä»¶

TreeAge Pro æ˜¯å•†ä¸šè½¯ä»¶ï¼Œå¯ä» [TreeAge å®˜ç½‘](https://www.treeage.com/) è·å–ã€‚å®˜ç½‘æä¾›ï¼š

- **è¯•ç”¨ç‰ˆ**ï¼š30 å¤©å…¨åŠŸèƒ½è¯•ç”¨
- **æ•™è‚²ç‰ˆ**ï¼šå­¦æœ¯æœºæ„æŠ˜æ‰£
- **å®Œæ•´ç‰ˆ**ï¼šHealthcare æˆ– Pro Suite è®¸å¯

### ä¸»è¦ç•Œé¢ç»„ä»¶

TreeAge Pro çš„å·¥ä½œç•Œé¢ä¸»è¦åŒ…å«ä»¥ä¸‹éƒ¨åˆ†ï¼š

| åŒºåŸŸ | åŠŸèƒ½ |
|------|------|
| **ä¸»èœå•** | æ–‡ä»¶ã€ç¼–è¾‘ã€Treeã€åˆ†æç­‰åŠŸèƒ½å…¥å£ |
| **å·¥å…·æ ** | å¿«æ·æ“ä½œæŒ‰é’®ï¼šèŠ‚ç‚¹ç±»å‹é€‰æ‹©ã€è¿è¡Œåˆ†æç­‰ |
| **æ¨¡å‹ç”»å¸ƒ** | å¯è§†åŒ–å±•ç¤ºå’Œç¼–è¾‘å†³ç­–æ¨¡å‹ |
| **å˜é‡é¢æ¿** | å®šä¹‰å’Œç®¡ç†å…¨å±€å˜é‡ |
| **å±æ€§é¢æ¿** | æŸ¥çœ‹å’Œç¼–è¾‘é€‰ä¸­èŠ‚ç‚¹çš„å±æ€§ |

### èŠ‚ç‚¹ç±»å‹

å†³ç­–æ¨¡å‹ç”±ä¸åŒç±»å‹çš„èŠ‚ç‚¹æ„æˆï¼š

| èŠ‚ç‚¹ | ç¬¦å· | ç”¨é€” |
|------|------|------|
| å†³ç­–èŠ‚ç‚¹ | ğŸ”²ï¼ˆæ–¹å½¢ï¼‰ | å†³ç­–è€…å¯ä»¥é€‰æ‹©çš„ç­–ç•¥ |
| æœºä¼šèŠ‚ç‚¹ | âšªï¼ˆåœ†å½¢ï¼‰ | ä¸ç¡®å®šäº‹ä»¶ï¼Œç”±æ¦‚ç‡å†³å®š |
| ç»ˆç«¯èŠ‚ç‚¹ | â–²ï¼ˆä¸‰è§’å½¢ï¼‰ | è·¯å¾„ç»ˆç‚¹ï¼Œè®°å½•å›æŠ¥å€¼ |
| MarkovèŠ‚ç‚¹ | ğŸ”µï¼ˆç´«è‰²åœ†è§’ï¼‰ | é©¬å°”å¯å¤«è¿‡ç¨‹èµ·ç‚¹ |

---

## æ„å»ºå†³ç­–æ ‘æ¨¡å‹

å†³ç­–æ ‘æ˜¯æœ€åŸºç¡€çš„å†³ç­–åˆ†ææ¨¡å‹ï¼Œé€‚ç”¨äº**ä¸€æ¬¡æ€§**æˆ–**çŸ­æœŸ**å†³ç­–é—®é¢˜ã€‚

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ–°æ¨¡å‹

1. **File > New** æˆ–å¿«æ·é”® `Ctrl+N`
2. é€‰æ‹© **Healthcare** æ¨¡æ¿ç±»åˆ«
3. é€‰æ‹© **Decision Treeï¼ˆCost-Effectivenessï¼‰**
4. æŒ‡å®šä¿å­˜ä½ç½®å’Œæ–‡ä»¶åï¼ˆ`.trex` æ ¼å¼ï¼‰

### ç¬¬äºŒæ­¥ï¼šæ·»åŠ ç­–ç•¥åˆ†æ”¯

å†³ç­–èŠ‚ç‚¹ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰ä»£è¡¨éœ€è¦æ¯”è¾ƒçš„ç­–ç•¥é€‰é¡¹ï¼š

1. å³é”®ç‚¹å‡»å†³ç­–èŠ‚ç‚¹ â†’ **Add Branch**
2. ä¸ºæ¯ä¸ªç­–ç•¥å‘½åï¼ˆä¾‹å¦‚ï¼š"æ ‡å‡†æ²»ç–—"ã€"æ–°è¯æ²»ç–—"ï¼‰
3. é‡å¤ä¸Šè¿°æ­¥éª¤æ·»åŠ æ‰€æœ‰æ¯”è¾ƒç­–ç•¥

**ç¤ºä¾‹ç»“æ„**ï¼š

```
å†³ç­–èŠ‚ç‚¹ [Choice]
â”œâ”€â”€ æ ‡å‡†æ²»ç–— [Strategy]
â””â”€â”€ æ–°è¯æ²»ç–— [Strategy]
```

### ç¬¬ä¸‰æ­¥ï¼šæ„å»ºäº‹ä»¶è·¯å¾„

åœ¨æ¯ä¸ªç­–ç•¥ä¸‹æ·»åŠ æœºä¼šèŠ‚ç‚¹å’Œç»ˆç«¯èŠ‚ç‚¹ï¼š

1. é€‰ä¸­ç­–ç•¥åˆ†æ”¯æœ«ç«¯
2. å³é”® â†’ **Change Type > Chance** æ·»åŠ æœºä¼šèŠ‚ç‚¹
3. æ·»åŠ å¯èƒ½çš„äº‹ä»¶ç»“æœï¼ˆå¦‚"æ²»ç–—æˆåŠŸ"ã€"æ²»ç–—å¤±è´¥"ï¼‰
4. ä¸ºæ¯ä¸ªç»“æœåˆ†æ”¯è®¾ç½®**æ¦‚ç‡å€¼**ï¼ˆæ‰€æœ‰åˆ†æ”¯æ¦‚ç‡ä¹‹å’Œå¿…é¡»ç­‰äº1ï¼‰

**å®Œæ•´ç»“æ„ç¤ºä¾‹**ï¼š

```
å†³ç­–èŠ‚ç‚¹ [Choice]
â”œâ”€â”€ æ ‡å‡†æ²»ç–—
â”‚   â””â”€â”€ [Chance] æ²»ç–—ç»“æœ
â”‚       â”œâ”€â”€ æˆåŠŸ (p=0.6) â†’ [Terminal]
â”‚       â””â”€â”€ å¤±è´¥ (p=0.4) â†’ [Terminal]
â””â”€â”€ æ–°è¯æ²»ç–—
    â””â”€â”€ [Chance] æ²»ç–—ç»“æœ
        â”œâ”€â”€ æˆåŠŸ (p=0.8) â†’ [Terminal]
        â””â”€â”€ å¤±è´¥ (p=0.2) â†’ [Terminal]
```

### ç¬¬å››æ­¥ï¼šè®¾ç½®å›æŠ¥å€¼

åœ¨ç»ˆç«¯èŠ‚ç‚¹è®¾ç½®**æˆæœ¬ï¼ˆCostï¼‰**å’Œ**æ•ˆæœï¼ˆEffectivenessï¼‰**ï¼š

1. ç‚¹å‡»ç»ˆç«¯èŠ‚ç‚¹
2. åœ¨å±æ€§é¢æ¿ä¸­æ‰¾åˆ° **Payoff** åŒºåŸŸ
3. è¾“å…¥æˆæœ¬å€¼ï¼ˆå¦‚ `10000`ï¼‰
4. è¾“å…¥æ•ˆæœå€¼ï¼ˆå¦‚ `0.9` è¡¨ç¤º QALYï¼‰

> ğŸ’¡ **æŠ€å·§**ï¼šå¯ä»¥ä½¿ç”¨å˜é‡ä»£æ›¿å…·ä½“æ•°å€¼ï¼Œä¾¿äºåç»­æ•æ„Ÿæ€§åˆ†æã€‚

### ç¬¬äº”æ­¥ï¼šè¿è¡Œå†³ç­–æ ‘åˆ†æ

1. é€‰ä¸­å†³ç­–æ ‘æ ¹èŠ‚ç‚¹
2. èœå• **Analysis > Roll Back** æˆ–æŒ‰ `F5`
3. æŸ¥çœ‹æ¯ä¸ªç­–ç•¥çš„æœŸæœ›å€¼ï¼ˆExpected Valueï¼‰
4. æœŸæœ›å€¼æœ€ä¼˜çš„ç­–ç•¥ä¼šè¢«æ ‡è®°

---

## å®šä¹‰æ¨¡å‹å˜é‡

ä½¿ç”¨å˜é‡å¯ä»¥è®©æ¨¡å‹æ›´æ¸…æ™°ã€æ›´æ˜“äºç»´æŠ¤å’Œè¿›è¡Œæ•æ„Ÿæ€§åˆ†æã€‚

### åˆ›å»ºå˜é‡

1. èœå• **Tree > Variable Properties** æˆ–å¿«æ·é”® `Ctrl+Shift+V`
2. ç‚¹å‡» **Add** æ·»åŠ æ–°å˜é‡
3. å¡«å†™å˜é‡å±æ€§ï¼š
   - **Name**ï¼šå˜é‡åï¼ˆå¦‚ `p_success`ï¼‰
   - **Definition**ï¼šå˜é‡å€¼æˆ–è¡¨è¾¾å¼ï¼ˆå¦‚ `0.8`ï¼‰
   - **Description**ï¼šå¯é€‰çš„æè¿°è¯´æ˜

### å˜é‡ç±»å‹

| ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| **æ•°å€¼å˜é‡** | å›ºå®šæ•°å€¼ | `c_treatment = 5000` |
| **è¡¨è¾¾å¼** | è®¡ç®—å…¬å¼ | `p_failure = 1 - p_success` |
| **è¡¨æ ¼å˜é‡** | äºŒç»´æŸ¥æ‰¾è¡¨ | å¹´é¾„-æ€§åˆ«æ­»äº¡ç‡è¡¨ |
| **åˆ†å¸ƒå˜é‡** | ç”¨äº PSA çš„æ¦‚ç‡åˆ†å¸ƒ | `Dist(Beta, 40, 60)` |

### å¸¸ç”¨è¡¨è¾¾å¼

```
# è¡¥æ¦‚ç‡
p_failure = 1 - p_success

# æ¡ä»¶è¡¨è¾¾å¼
risk = if(age > 65; high_risk; low_risk)

# è´´ç°
discounted_cost = cost * (1 / (1 + discount_rate))^_stage

# Markov é˜¶æ®µå¼•ç”¨
cumulative_cost = Cost + (1 / (1 + r))^_stage * c_annual
```

---

## æ„å»ºé©¬å°”å¯å¤«æ¨¡å‹

é©¬å°”å¯å¤«æ¨¡å‹é€‚ç”¨äºéœ€è¦æ¨¡æ‹Ÿ**é•¿æœŸç–¾ç—…è¿›å±•**çš„åˆ†æåœºæ™¯ã€‚

### ä»€ä¹ˆæ˜¯é©¬å°”å¯å¤«æ¨¡å‹

é©¬å°”å¯å¤«æ¨¡å‹å°†æ‚£è€…çŠ¶æ€ç¦»æ•£åŒ–ä¸ºæœ‰é™ä¸ª**å¥åº·çŠ¶æ€**ï¼Œå¹¶æ¨¡æ‹Ÿæ‚£è€…åœ¨å„çŠ¶æ€é—´çš„**å‘¨æœŸæ€§è½¬ç§»**ã€‚

| æ¦‚å¿µ | è¯´æ˜ |
|------|------|
| **å¥åº·çŠ¶æ€** | å¦‚"å¥åº·"ã€"ç–¾ç—…"ã€"æ­»äº¡" |
| **å‘¨æœŸ** | æ—¶é—´å•ä½ï¼ˆå¦‚1å¹´ã€1ä¸ªæœˆï¼‰ |
| **è½¬ç§»æ¦‚ç‡** | ä»ä¸€ä¸ªçŠ¶æ€è½¬ç§»åˆ°å¦ä¸€çŠ¶æ€çš„æ¦‚ç‡ |
| **å‘¨æœŸå¥–åŠ±** | åœ¨æŸçŠ¶æ€åœç•™ä¸€ä¸ªå‘¨æœŸçš„æˆæœ¬/æ•ˆæœ |

### ç¬¬ä¸€æ­¥ï¼šæ·»åŠ  Markov èŠ‚ç‚¹

1. åœ¨ç­–ç•¥åˆ†æ”¯æœ«ç«¯å³é”® â†’ **Change Type > Markov**
2. èŠ‚ç‚¹å˜ä¸ºç´«è‰²åœ†è§’çŸ©å½¢
3. åœ¨ Markov ä¿¡æ¯æ¡†ä¸­è®¾ç½®ï¼š
   - **Init Cost**ï¼šåˆå§‹æˆæœ¬
   - **Init Eff**ï¼šåˆå§‹æ•ˆæœ
   - **Term Cond**ï¼šç»ˆæ­¢æ¡ä»¶ï¼ˆå¦‚ `_stage >= 20`ï¼‰
   - **Half-Cycle Correction**ï¼šå¯é€‰çš„åŠå‘¨æœŸæ ¡æ­£

### ç¬¬äºŒæ­¥ï¼šæ·»åŠ å¥åº·çŠ¶æ€

1. å³é”® Markov èŠ‚ç‚¹ â†’ **Add Branch** æ·»åŠ çŠ¶æ€åˆ†æ”¯
2. å°†åˆ†æ”¯ç±»å‹è®¾ä¸º **Markov State**
3. é‡å¤æ·»åŠ æ‰€æœ‰éœ€è¦çš„å¥åº·çŠ¶æ€

**å…¸å‹ä¸‰çŠ¶æ€æ¨¡å‹**ï¼š

```
Markov èŠ‚ç‚¹
â”œâ”€â”€ [State] å¥åº·
â”œâ”€â”€ [State] ç–¾ç—…
â””â”€â”€ [State] æ­»äº¡
```

### ç¬¬ä¸‰æ­¥ï¼šå®šä¹‰çŠ¶æ€è½¬ç§»

åœ¨æ¯ä¸ªçŠ¶æ€ä¸‹å®šä¹‰è½¬ç§»è·¯å¾„ï¼š

1. é€‰ä¸­çŠ¶æ€èŠ‚ç‚¹
2. æ·»åŠ æœºä¼šåˆ†æ”¯è¡¨ç¤ºå¯èƒ½çš„è½¬ç§»
3. è®¾ç½®å„è½¬ç§»çš„æ¦‚ç‡
4. ç”¨ç‰¹æ®Šç»ˆç«¯èŠ‚ç‚¹æ ‡è®°è½¬ç§»ç›®æ ‡

**çŠ¶æ€è½¬ç§»é€»è¾‘**ï¼š

```
[State] å¥åº·
â””â”€â”€ [Chance]
    â”œâ”€â”€ ä¿æŒå¥åº· (p=0.85) â†’ [#healthy]
    â”œâ”€â”€ è¿›å±•ä¸ºç–¾ç—… (p=0.14) â†’ [#disease]
    â””â”€â”€ æ­»äº¡ (p=0.01) â†’ [#dead]
```

> ğŸ’¡ ä½¿ç”¨ `#statename` è¯­æ³•å¼•ç”¨ç›®æ ‡çŠ¶æ€ï¼ˆè·³è½¬æ ‡è®°ï¼‰ã€‚

### ç¬¬å››æ­¥ï¼šè®¾ç½®çŠ¶æ€å¥–åŠ±

æ¯ä¸ªçŠ¶æ€éœ€è¦è®¾ç½®è¿›å…¥æˆ–åœç•™çš„æˆæœ¬å’Œæ•ˆæœï¼š

1. é€‰ä¸­çŠ¶æ€èŠ‚ç‚¹
2. åœ¨å±æ€§é¢æ¿æ‰¾åˆ° **Rewards** åŒºåŸŸ
3. è®¾ç½®ï¼š
   - **Incr Cost**ï¼šæ¯ä¸ªå‘¨æœŸçš„å¢é‡æˆæœ¬
   - **Incr Eff**ï¼šæ¯ä¸ªå‘¨æœŸçš„å¢é‡æ•ˆæœï¼ˆQALYï¼‰
   - **Final Cost/Eff**ï¼šå¯é€‰çš„ç»ˆæœ«å€¼

**ç¤ºä¾‹è®¾ç½®**ï¼š

| çŠ¶æ€ | å‘¨æœŸæˆæœ¬ | å‘¨æœŸæ•ˆæœ (QALY) |
|------|----------|-----------------|
| å¥åº· | 1,000 | 1.0 |
| ç–¾ç—… | 8,000 | 0.6 |
| æ­»äº¡ | 0 | 0 |

### ç¬¬äº”æ­¥ï¼šè®¾ç½®ç»ˆæ­¢æ¡ä»¶

é©¬å°”å¯å¤«æ¨¡å‹éœ€è¦æ˜ç¡®ä½•æ—¶åœæ­¢æ¨¡æ‹Ÿï¼š

```
# æŒ‰å‘¨æœŸæ•°ç»ˆæ­¢ï¼ˆ20å¹´æ—¶é—´èŒƒå›´ï¼‰
_stage >= 20

# æŒ‰å¸æ”¶çŠ¶æ€æ¯”ä¾‹ç»ˆæ­¢ï¼ˆ99%è¿›å…¥æ­»äº¡ï¼‰
_stage_sum[Dead] >= 0.99

# ç»„åˆæ¡ä»¶
_stage >= 50 OR _stage_sum[Dead] >= 0.99
```

### ç¬¬å…­æ­¥ï¼šåŠå‘¨æœŸæ ¡æ­£

é©¬å°”å¯å¤«æ¨¡å‹å‡è®¾çŠ¶æ€è½¬ç§»å‘ç”Ÿåœ¨å‘¨æœŸçš„æŸä¸ªæ—¶ç‚¹ï¼Œå¯èƒ½å¯¼è‡´åå·®ã€‚åŠå‘¨æœŸæ ¡æ­£æ˜¯å¸¸ç”¨çš„è°ƒæ•´æ–¹æ³•ï¼š

1. åœ¨ Markov ä¿¡æ¯æ¡†å‹¾é€‰ **Half-Cycle Correction**
2. æˆ–æ‰‹åŠ¨è®¾ç½®åˆå§‹/ç»ˆæœ«å¥–åŠ±çš„ 0.5 å€

---

## æˆæœ¬æ•ˆæœåˆ†æ (CEA)

### è®¾ç½®åˆ†æå‚æ•°

1. èœå• **Tree > Model Setup Wizard** æˆ–å·¥å…·æ é½¿è½®å›¾æ ‡
2. è®¾ç½®ï¼š
   - **Calculation Method**ï¼šCost-Effectiveness
   - **Willingness to Pay (WTP)**ï¼šæ”¯ä»˜æ„æ„¿é˜ˆå€¼ï¼ˆå¦‚ 50000ï¼‰
   - **Payoffç²¾åº¦**ï¼šæˆæœ¬ä¸ºè´§å¸æ ¼å¼ï¼Œæ•ˆæœä¸º LY æˆ– QALY

### è¿è¡Œæˆæœ¬æ•ˆæœåˆ†æ

1. é€‰ä¸­å†³ç­–èŠ‚ç‚¹
2. èœå• **Analysis > Cost-Effectiveness**
3. æŸ¥çœ‹è¾“å‡ºç»“æœ

### ç†è§£åˆ†æè¾“å‡º

#### æˆæœ¬æ•ˆæœè¡¨

| ç­–ç•¥ | æˆæœ¬ | æ•ˆæœ | å¢é‡æˆæœ¬ | å¢é‡æ•ˆæœ | ICER |
|------|------|------|----------|----------|------|
| æ ‡å‡†æ²»ç–— | 50,000 | 5.2 | - | - | - |
| æ–°è¯A | 80,000 | 6.8 | 30,000 | 1.6 | 18,750 |
| æ–°è¯B | 120,000 | 7.5 | 70,000 | 2.3 | 30,435 |

#### å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | å…¬å¼ | è§£é‡Š |
|------|------|------|
| **ICER** | Î”Cost / Î”Effect | æ¯å¤šè·å¾—1ä¸ªQALYçš„å¢é‡æˆæœ¬ |
| **NMB** | WTP Ã— Effect - Cost | å‡€è´§å¸æ”¶ç›Šï¼Œè¶Šå¤§è¶Šä¼˜ |
| **NHB** | Effect - Cost/WTP | å‡€å¥åº·æ”¶ç›Š |

### ä¼˜åŠ¿æ€§åˆ†æ

TreeAge Pro è‡ªåŠ¨è¯†åˆ«**è¢«æ”¯é…**çš„ç­–ç•¥ï¼š

| ç±»å‹ | å®šä¹‰ | å›¾ç¤º |
|------|------|------|
| **ç»å¯¹ä¼˜åŠ¿** | æˆæœ¬æ›´é«˜ä¸”æ•ˆæœæ›´å·® | åœ¨CEå¹³é¢å³ä¸Šè±¡é™ |
| **æ‰©å±•ä¼˜åŠ¿** | ICER é«˜äºæ›´æœ‰æ•ˆçš„æ›¿ä»£æ–¹æ¡ˆ | åœ¨æ•ˆç‡å‰æ²¿çº¿ä¸‹æ–¹ |

---

## æ•æ„Ÿæ€§åˆ†æ

### å•å› ç´ æ•æ„Ÿæ€§åˆ†æ

æ£€éªŒå•ä¸ªå‚æ•°å˜åŒ–å¯¹ç»“æœçš„å½±å“ï¼š

1. **Analysis > 1-Way Sensitivity Analysis**
2. é€‰æ‹©è¦åˆ†æçš„å˜é‡
3. è®¾ç½®èŒƒå›´ï¼ˆLow, Base, Highï¼‰
4. é€‰æ‹©è¾“å‡ºæŒ‡æ ‡ï¼ˆICER æˆ– NMBï¼‰

**è¾“å‡º**ï¼š
- **é˜ˆå€¼åˆ†æ**ï¼šæ‰¾åˆ°ç­–ç•¥é€‰æ‹©åè½¬çš„ä¸´ç•Œå€¼
- **é¾™å·é£å›¾**ï¼šå±•ç¤ºå„å‚æ•°å½±å“ç¨‹åº¦æ’åº

### åŒå› ç´ æ•æ„Ÿæ€§åˆ†æ

åŒæ—¶å˜åŒ–ä¸¤ä¸ªå‚æ•°ï¼š

1. **Analysis > 2-Way Sensitivity Analysis**
2. é€‰æ‹©ä¸¤ä¸ªå˜é‡åŠå…¶èŒƒå›´
3. ç”ŸæˆäºŒç»´çƒ­å›¾æ˜¾ç¤ºæœ€ä¼˜ç­–ç•¥åŒºåŸŸ

### æ¦‚ç‡æ•æ„Ÿæ€§åˆ†æ (PSA)

è€ƒè™‘å¤šå‚æ•°åŒæ—¶ä¸ç¡®å®šï¼š

1. ä¸ºå…³é”®å‚æ•°å®šä¹‰æ¦‚ç‡åˆ†å¸ƒï¼š
   - æ¦‚ç‡ï¼šBeta åˆ†å¸ƒ
   - æˆæœ¬ï¼šGamma åˆ†å¸ƒ
   - ç›¸å¯¹é£é™©ï¼šLog-normal åˆ†å¸ƒ

2. **Analysis > Probabilistic Sensitivity Analysis**

3. è®¾ç½®æ¨¡æ‹Ÿæ¬¡æ•°ï¼ˆé€šå¸¸ 1000-10000 æ¬¡ï¼‰

4. æŸ¥çœ‹è¾“å‡ºï¼š
   - **CE æ•£ç‚¹å›¾**ï¼šå„æ¨¡æ‹Ÿç»“æœçš„æˆæœ¬-æ•ˆæœåˆ†å¸ƒ
   - **å¢é‡ CE æ•£ç‚¹å›¾**ï¼šç›¸å¯¹äºåŸºå‡†çš„å¢é‡åˆ†å¸ƒ
   - **CEAC**ï¼šæˆæœ¬æ•ˆæœå¯æ¥å—æ›²çº¿

### æˆæœ¬æ•ˆæœå¯æ¥å—æ›²çº¿ (CEAC)

CEAC å±•ç¤ºä¸åŒ WTP é˜ˆå€¼ä¸‹å„ç­–ç•¥å…·æœ‰æˆæœ¬æ•ˆæœçš„æ¦‚ç‡ï¼š

- X è½´ï¼šæ”¯ä»˜æ„æ„¿ï¼ˆWTPï¼‰
- Y è½´ï¼šè¯¥ç­–ç•¥æˆæœ¬æ•ˆæœçš„æ¦‚ç‡
- è§£è¯»ï¼šåœ¨ç»™å®š WTP ä¸‹ï¼Œé€‰æ‹© CEAC å€¼æœ€é«˜çš„ç­–ç•¥

---

## å®ç”¨æŠ€å·§

### æ¨¡å‹è°ƒè¯•

| é—®é¢˜ | æ£€æŸ¥æ–¹æ³• |
|------|----------|
| æ¦‚ç‡ä¸ç­‰äº1 | Trees > Validate Tree |
| å˜é‡æœªå®šä¹‰ | å˜é‡é¢æ¿æ£€æŸ¥çº¢è‰²æ ‡è®° |
| å¾ªç¯å¼•ç”¨ | æŸ¥çœ‹å˜é‡ä¾èµ–å…³ç³»å›¾ |
| Markovä¸æ”¶æ•› | æ£€æŸ¥ç»ˆæ­¢æ¡ä»¶å’Œå¸æ”¶çŠ¶æ€ |

### æ¨¡å‹æ•ˆç‡

- ä½¿ç”¨**å­æ ‘ï¼ˆSubtreeï¼‰**é‡ç”¨ç›¸åŒç»“æ„
- ç”¨**å…‹éš†ï¼ˆCloneï¼‰**å¤åˆ¶å¸¦å˜é‡çš„ç»“æ„
- è®¾ç½®åˆç†çš„ Markov å‘¨æœŸæ•°å’Œ PSA æ¨¡æ‹Ÿæ¬¡æ•°

### æŠ¥å‘Šç”Ÿæˆ

1. **File > Export > Report**
2. é€‰æ‹©è¾“å‡ºæ ¼å¼ï¼ˆWordã€PDFã€HTMLï¼‰
3. è‡ªå®šä¹‰åŒ…å«çš„åˆ†æç»“æœå’Œå›¾è¡¨

---

## R è¯­è¨€ä¸ TreeAge çš„ç»“åˆä½¿ç”¨

è™½ç„¶ TreeAge Pro æ˜¯å›¾å½¢åŒ–è½¯ä»¶ï¼Œä½†å¯ä»¥ä¸ R è¯­è¨€é…åˆä½¿ç”¨æ¥å¢å¼ºåˆ†æèƒ½åŠ›ã€‚

### æ•°æ®å‡†å¤‡é˜¶æ®µï¼ˆRï¼‰

åœ¨ R ä¸­è¿›è¡Œæ•°æ®æ¸…æ´—å’Œå‚æ•°ä¼°è®¡ï¼š

```{r eval=FALSE}
library(dplyr)
library(survival)

# ä»åŸå§‹æ•°æ®ä¼°è®¡è½¬ç§»æ¦‚ç‡
transition_probs <- survival_data %>%
    group_by(from_state) %>%
    summarise(
        p_to_disease = mean(to_state == "disease"),
        p_to_death = mean(to_state == "death"),
        p_stay = 1 - p_to_disease - p_to_death
    )

# å¯¼å‡ºä¸º CSV ä¾› TreeAge ä½¿ç”¨
write.csv(transition_probs, "transition_probs.csv", row.names = FALSE)
```

### ç»“æœå¯è§†åŒ–é˜¶æ®µï¼ˆRï¼‰

å°† TreeAge å¯¼å‡ºçš„ç»“æœåœ¨ R ä¸­è¿›è¡Œé«˜çº§å¯è§†åŒ–ï¼š

```{r}
library(ggplot2)
library(scales)
library(dplyr)

# æ¨¡æ‹Ÿ TreeAge PSA å¯¼å‡ºæ•°æ®
set.seed(42)
psa_results <- data.frame(
    simulation = 1:1000,
    strategy = rep(c("æ ‡å‡†æ²»ç–—", "æ–°è¯æ²»ç–—"), each = 1000),
    cost = c(rnorm(1000, 50000, 5000), rnorm(1000, 75000, 8000)),
    qaly = c(rnorm(1000, 5.2, 0.5), rnorm(1000, 6.5, 0.6))
)

# å¢é‡æˆæœ¬æ•ˆæœæ•£ç‚¹å›¾
ref_data <- psa_results %>%
    filter(strategy == "æ ‡å‡†æ²»ç–—") %>%
    select(simulation, ref_cost = cost, ref_qaly = qaly)

incremental <- psa_results %>%
    filter(strategy == "æ–°è¯æ²»ç–—") %>%
    left_join(ref_data, by = "simulation") %>%
    mutate(
        delta_cost = cost - ref_cost,
        delta_qaly = qaly - ref_qaly
    )

ggplot(incremental, aes(x = delta_qaly, y = delta_cost)) +
    geom_point(alpha = 0.3, color = "#4f46e5") +
    geom_hline(yintercept = 0, linetype = "dashed", color = "gray50") +
    geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
    geom_abline(intercept = 0, slope = 50000, color = "red", linewidth = 1) +
    scale_y_continuous(labels = comma_format()) +
    labs(
        title = "å¢é‡æˆæœ¬æ•ˆæœæ•£ç‚¹å›¾ï¼ˆTreeAge PSA ç»“æœï¼‰",
        subtitle = "çº¢çº¿: WTP = 50,000 å…ƒ/QALY",
        x = "å¢é‡ QALY (Î”QALYs)",
        y = "å¢é‡æˆæœ¬ (Î”å…ƒ)"
    ) +
    theme_bw(base_size = 12) +
    theme(
        plot.title = element_text(hjust = 0.5, face = "bold")
    ) +
    annotate("text",
        x = 1.8, y = -15000, label = "ä¼˜åŠ¿è±¡é™",
        color = "darkgreen", size = 4
    ) +
    annotate("text",
        x = -0.3, y = 45000, label = "åŠ£åŠ¿è±¡é™",
        color = "darkred", size = 4
    )
```

### åˆ¶ä½œ CEAC æ›²çº¿

```{r}
# è®¡ç®—ä¸åŒ WTP ä¸‹çš„ CEAC
calculate_ceac <- function(psa_data, wtp_range) {
    strategies <- unique(psa_data$strategy)
    n_sim <- length(unique(psa_data$simulation))
    results <- data.frame()

    for (wtp in wtp_range) {
        nmb_data <- psa_data %>%
            mutate(nmb = wtp * qaly - cost)

        best_strategy <- nmb_data %>%
            group_by(simulation) %>%
            slice_max(nmb, n = 1) %>%
            ungroup()

        prob_best <- best_strategy %>%
            count(strategy) %>%
            mutate(probability = n / n_sim)

        for (s in strategies) {
            if (!s %in% prob_best$strategy) {
                prob_best <- bind_rows(
                    prob_best,
                    data.frame(strategy = s, n = 0, probability = 0)
                )
            }
        }

        prob_best$wtp <- wtp
        results <- bind_rows(results, prob_best)
    }
    results
}

wtp_range <- seq(0, 150000, by = 5000)
ceac_data <- calculate_ceac(psa_results, wtp_range)

ggplot(ceac_data, aes(x = wtp, y = probability, color = strategy)) +
    geom_line(linewidth = 1.2) +
    geom_vline(xintercept = 50000, linetype = "dashed", color = "gray50") +
    scale_x_continuous(labels = comma_format()) +
    scale_y_continuous(limits = c(0, 1), labels = percent_format()) +
    scale_color_manual(values = c("#4f46e5", "#10b981")) +
    labs(
        title = "æˆæœ¬æ•ˆæœå¯æ¥å—æ›²çº¿ (CEAC)",
        x = "æ”¯ä»˜æ„æ„¿ (WTP, å…ƒ/QALY)",
        y = "æˆæœ¬æ•ˆæœçš„æ¦‚ç‡",
        color = "æ²»ç–—æ–¹æ¡ˆ"
    ) +
    theme_bw(base_size = 12) +
    theme(
        legend.position = "bottom",
        plot.title = element_text(hjust = 0.5, face = "bold")
    ) +
    annotate("text",
        x = 55000, y = 0.95, label = "WTP = 50,000",
        hjust = 0, color = "gray30", size = 3.5
    )
```

---

## å¸¸è§é—®é¢˜è§£ç­”

### æ¨¡å‹éªŒè¯

**Q: å¦‚ä½•éªŒè¯æˆ‘çš„æ¨¡å‹æ˜¯å¦æ­£ç¡®ï¼Ÿ**

1. **æŠ€æœ¯éªŒè¯**ï¼šä½¿ç”¨ `Tree > Validate Tree` æ£€æŸ¥æŠ€æœ¯é”™è¯¯
2. **å†…éƒ¨éªŒè¯**ï¼šæç«¯å€¼æµ‹è¯•ï¼ˆå‚æ•°è®¾ä¸º0æˆ–1æ—¶ç»“æœæ˜¯å¦åˆç†ï¼‰
3. **å¤–éƒ¨éªŒè¯**ï¼šä¸æ–‡çŒ®æŠ¥é“æˆ–å…¶ä»–æ¨¡å‹ç»“æœæ¯”è¾ƒ
4. **æ•æ„Ÿæ€§åˆ†æ**ï¼šæ£€æŸ¥ç»“æœå¯¹å‚æ•°å˜åŒ–çš„æ•æ„Ÿç¨‹åº¦

### å‚æ•°é€‰æ‹©

**Q: æ¦‚ç‡å‚æ•°åº”è¯¥ç”¨ä»€ä¹ˆåˆ†å¸ƒï¼Ÿ**

| å‚æ•°ç±»å‹ | æ¨èåˆ†å¸ƒ | åŸå›  |
|----------|----------|------|
| æ¦‚ç‡ | Beta | èŒƒå›´ [0,1]ï¼Œçµæ´»å½¢çŠ¶ |
| æˆæœ¬ | Gamma | éè´Ÿï¼Œå³å |
| ç›¸å¯¹é£é™©/æ¯”å€¼æ¯” | Log-normal | éè´Ÿï¼Œå¯å¤§äº1 |
| æ•ˆç”¨ | Beta | èŒƒå›´ [0,1] |

### ç»“æœè§£è¯»

**Q: ICER ä¸ºè´Ÿæ•°æ€ä¹ˆè§£é‡Šï¼Ÿ**

- **Î”Cost < 0, Î”Effect > 0**ï¼šæ–°æ–¹æ¡ˆ"ä¼˜åŠ¿"ï¼ˆæ›´ä¾¿å®œä¸”æ›´æœ‰æ•ˆï¼‰
- **Î”Cost > 0, Î”Effect < 0**ï¼šæ–°æ–¹æ¡ˆ"è¢«æ”¯é…"ï¼ˆæ›´è´µä¸”æ›´å·®ï¼‰
- ä¸¤ç§æƒ…å†µéƒ½ä¸éœ€è¦è®¡ç®— ICERï¼Œç›´æ¥åˆ¤æ–­ä¼˜åŠ£

---

## å­¦ä¹ èµ„æº

### å®˜æ–¹èµ„æº

| èµ„æº | é“¾æ¥ |
|------|------|
| TreeAge å¸®åŠ©æ–‡æ¡£ | [TreeAge Help](https://www.treeage.com/help/) |
| æ•™ç¨‹è§†é¢‘ | [TreeAge å®˜æ–¹ YouTube](https://www.youtube.com/@TreeAgeSoftware) |
| ç¤ºä¾‹æ¨¡å‹åº“ | è½¯ä»¶å®‰è£…ç›®å½•çš„ Examples æ–‡ä»¶å¤¹ |

### æ–¹æ³•å­¦å‚è€ƒ

| èµ„æº | è¯´æ˜ |
|------|------|
| [ISPOR](https://www.ispor.org/) | å›½é™…è¯ç‰©ç»æµå­¦å­¦ä¼šï¼Œå‘å¸ƒ HTA æ–¹æ³•æŒ‡å— |
| [DARTH å·¥ä½œç»„](https://darthworkgroup.com/) | å¼€æºå†³ç­–å»ºæ¨¡æ•™ç¨‹å’Œ R ä»£ç  |
| [York HTA Program](https://yhec.co.uk/) | è‹±å›½çº¦å…‹å¤§å­¦ HTA åŸ¹è®­èµ„æº |

### æ¨èä¹¦ç±

- *Decision Modelling for Health Economic Evaluation* - Briggs, Claxton, Sculpher
- *Applied Methods of Cost-effectiveness Analysis in Healthcare* - Gray et al.

---

## æ€»ç»“

TreeAge Pro æ˜¯å«ç”Ÿç»æµå­¦å†³ç­–åˆ†æçš„å¼ºå¤§å·¥å…·ï¼Œæœ¬æ•™ç¨‹æ¶µç›–äº†ï¼š

| ä¸»é¢˜ | å†…å®¹è¦ç‚¹ |
|------|----------|
| å†³ç­–æ ‘æ¨¡å‹ | åˆ›å»ºç­–ç•¥åˆ†æ”¯ã€è®¾ç½®æ¦‚ç‡å’Œå›æŠ¥ã€Roll Back åˆ†æ |
| é©¬å°”å¯å¤«æ¨¡å‹ | å®šä¹‰å¥åº·çŠ¶æ€ã€è½¬ç§»æ¦‚ç‡ã€å‘¨æœŸå¥–åŠ±ã€ç»ˆæ­¢æ¡ä»¶ |
| æˆæœ¬æ•ˆæœåˆ†æ | ICER è®¡ç®—ã€ä¼˜åŠ¿æ€§åˆ¤å®šã€CE å¹³é¢å›¾ |
| æ•æ„Ÿæ€§åˆ†æ | å•å› ç´ ã€åŒå› ç´ ã€æ¦‚ç‡æ•æ„Ÿæ€§åˆ†æã€CEAC |
| ä¸ R ç»“åˆ | æ•°æ®å‡†å¤‡ã€ç»“æœå¯è§†åŒ–ã€é«˜çº§åˆ†æ |

> ğŸ’¡ **æœ€ä½³å®è·µ**ï¼šåœ¨ç®€å•æ¨¡å‹ä¸Šå……åˆ†ç»ƒä¹ ï¼Œç†è§£æ¯ä¸ªåˆ†ææ­¥éª¤çš„å«ä¹‰ï¼Œç„¶åå†åº”ç”¨äºå®é™…ç ”ç©¶é¡¹ç›®ã€‚

### ç›¸å…³æ•™ç¨‹

æœ¬æ•™ç¨‹æ˜¯å«ç”Ÿç»æµå­¦ç³»åˆ—çš„ä¸€éƒ¨åˆ†ï¼Œé…åˆä»¥ä¸‹æ•™ç¨‹ä½¿ç”¨æ•ˆæœæ›´ä½³ï¼š

- [Rè¯­è¨€å«ç”Ÿç»æµå­¦åˆ†æ](1015-health-economics.html) - R è¯­è¨€å®ç°æˆæœ¬æ•ˆæœåˆ†æ
- [å†³ç­–åˆ†ææ–¹æ³•è®ºåŸºç¡€]() - ç†è®ºèƒŒæ™¯å’Œæ–¹æ³•è®ºè¦ç‚¹
