---
title: '横截面研究设计与分析完整教程'
date: '2026-01-25'
categories:
- 统计分析方法
- 流行病学研究设计
image: images/cross-sectional-cover.svg
description: 横截面研究的设计原理、患病率分析、PR计算与STROBE报告指南
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.width = 8,
  fig.height = 5,
  fig.retina = 2,
  out.width = "100%",
  dpi = 150
)
```

## 方法背景与适用场景

横截面研究(Cross-sectional Study)是流行病学中最基础的观察性研究设计之一,在某一特定时间点或时间段内,同时测量研究对象的暴露因素和结局状态,用于描述疾病或健康状况的分布特征。

**适用场景**

横截面研究特别适合以下研究目的:

- **疾病患病率调查**:估计某一时点人群中疾病的患病率
- **危险因素筛查**:初步识别与疾病相关的危险因素
- **卫生服务需求评估**:了解人群健康状况,为卫生政策提供依据
- **假设生成研究**:为进一步的队列或病例对照研究提供线索
- **慢性病研究**:病程较长、患病率较高的慢性疾病(如高血压、糖尿病)

**不适用场景**

- **罕见疾病研究**:患病率极低(\<1%)时样本量需求过大,不如病例对照研究
- **因果推断**:无法确定暴露与结局的时间先后关系
- **疾病发病率估计**:只能计算患病率,无法直接估计发病率
- **急性疾病**:病程短、易治愈的疾病不适合(会遗漏已康复病例)

**与其他研究设计的对比**

| 研究设计 | 时间维度 | 因果推断能力 | 主要指标 | 成本 |
|---------|---------|------------|---------|------|
| **横截面研究** | 单一时间点 | 弱(关联性) | 患病率、PR | 低 |
| **队列研究** | 前瞻性随访 | 强(RR/HR) | 发病率、RR | 高 |
| **病例对照研究** | 回顾性 | 中等(OR) | OR | 中 |
| **RCT** | 前瞻性干预 | 最强 | RR、RD | 很高 |

## 核心概念与模型入门

### 通俗理解:用日常例子解释横截面研究

> 💡 **想象你在某一天对全班同学做了一次身高和视力调查**
> 
> 横截面研究就像"拍快照":
> - 在某个时间点同时测量暴露和结局
> - 发现"戴眼镜的同学平均身高更高"
> - **问题是**:不知道是先近视才戴眼镜,还是身高高的人容易近视(或者两者都与年龄有关)
> - 这就是"时间先后不明"的局限性
> - 你只能说"戴眼镜和身高存在关联",但不能说"身高导致近视"
>
> **回到统计学**:横截面研究无法确定因果方向,只能发现关联。适合描述现状、筛查危险因素,但需要进一步的队列或实验研究验证因果关系。

### 核心术语定义

**患病率(Prevalence)**

患病率是指在某一特定时间点,人群中患有某病的人数占总人数的比例:

$$\text{Prevalence} = \frac{\text{现患病例数}}{\text{观察人数}} \times 100\%$$

- **时点患病率**(Point Prevalence):某一时间点的患病率
- **期间患病率**(Period Prevalence):某一时间段内的患病率

**患病率 vs 发病率**

这是横截面研究中最容易混淆的概念:

| 指标 | 定义 | 分子 | 分母 | 研究设计 |
|------|-----|------|------|---------|
| **患病率** | 某时点患病比例 | 现患病例 | 全部观察对象 | 横截面研究 |
| **发病率** | 单位时间新发病例比例 | 新发病例 | 暴露人年 | 队列研究 |

**关系**:

$$\text{患病率} \approx \text{发病率} \times \text{平均病程}$$

- 慢性病(病程长):患病率 >> 发病率
- 急性病(病程短):患病率 ≈ 发病率

**患病率比(Prevalence Ratio, PR)**

比较暴露组与非暴露组的患病率比值:

$$PR = \frac{P_{\text{exposed}}}{P_{\text{unexposed}}}$$

其中:
- $P_{\text{exposed}}$:暴露组患病率
- $P_{\text{unexposed}}$:非暴露组患病率

**PR的解释**:
- PR = 1:暴露与疾病无关联
- PR > 1:暴露组患病率更高(可能是危险因素)
- PR < 1:暴露组患病率更低(可能是保护因素)

**比值比(Odds Ratio, OR) 在横截面研究中的应用**

虽然横截面研究计算的是患病率,但Logistic回归输出的是OR:

$$OR = \frac{\text{Odds}_{\text{exposed}}}{\text{Odds}_{\text{unexposed}}}$$

**PR vs OR**:
- 当疾病罕见时(\<10%),OR ≈ PR
- 当疾病常见时,OR会高估关联强度
- 横截面研究建议直接计算PR,而非用OR近似

### 横截面研究的核心特征

**1. 同时测量暴露与结局**

```
时间轴: ─────────────●─────────────▶
                     ↑
                 研究时点
               (同时测量E和D)
```

**2. 无法确定时间先后**

这是横截面研究的最大局限:

```
可能性1: E → D  (暴露导致疾病)
可能性2: D → E  (疾病导致暴露)
可能性3: C → E + D (混杂因素同时影响两者)
```

**3. 代表性抽样**

横截面研究要求样本能代表目标人群,常用抽样方法:

- 简单随机抽样
- 分层随机抽样
- 整群抽样
- 多阶段抽样

## 模型假设与前提条件

### 假设1:代表性样本

**含义**:样本能够代表目标人群的特征

**检验方法**:
- 比较样本与人群的人口学特征(年龄、性别分布)
- 计算应答率(Response Rate)

**违背后果**:
- 选择偏倚:结果无法推广到目标人群
- 估计的患病率有偏

**应对策略**:
- 采用概率抽样方法
- 提高应答率(>70%为佳)
- 进行加权调整

### 假设2:测量准确性

**含义**:暴露和结局的测量工具可靠且有效

**检验方法**:
- 信度检验(Cronbach's α, ICC)
- 效度检验(敏感度、特异度)

**违背后果**:
- 信息偏倚:错误分类导致关联估计有偏
- 非差异性错分:稀释关联强度
- 差异性错分:可能高估或低估关联

**应对策略**:
- 使用标准化、经过验证的测量工具
- 盲法评估(如实验室检测)

### 假设3:无严重混杂

**含义**:暴露与结局的关联不完全由第三变量解释

**检验方法**:
- 绘制DAG(有向无环图)
- 分层分析
- 多变量调整

**违背后果**:
- 虚假关联:实际不存在的关联
- 关联被掩盖:真实关联被混杂抵消

**应对策略**:
- 设计阶段:匹配、限制
- 分析阶段:分层、回归调整

## 数据准备

### 数据结构要求

横截面研究的数据通常为**宽格式**(每行一个个体):

```
ID | Exposure | Outcome | Age | Gender | ...
1  |    1     |    1    | 45  |   0    | ...
2  |    0     |    0    | 52  |   1    | ...
```

**变量类型**:
- **暴露**(Exposure):可以是二分类、多分类或连续变量
- **结局**(Outcome):通常是二分类(患病/未患病)
- **协变量**(Covariates):可能的混杂因素

### 模拟数据示例

我们模拟一个关于吸烟与高血压关系的横截面研究数据:

```{r simulate-data}
library(tidyverse)
set.seed(2026)
n <- 500  # 样本量

# 生成基线特征
data_cross <- data.frame(
  id = 1:n,
  age = rnorm(n, mean = 50, sd = 12),
  gender = rbinom(n, 1, 0.48),  # 0=女, 1=男
  bmi = rnorm(n, mean = 24, sd = 3)
)

# 生成暴露(吸烟):受年龄、性别影响
prob_smoking <- plogis(-2 + 0.02 * data_cross$age + 0.8 * data_cross$gender)
data_cross$smoking <- rbinom(n, 1, prob_smoking)

# 生成结局(高血压):受年龄、性别、BMI、吸烟影响
prob_htn <- plogis(
  -4 + 
  0.05 * data_cross$age +           # 年龄每增加1岁,OR=1.05
  0.3 * data_cross$gender +         # 男性 OR=1.35
  0.15 * data_cross$bmi +           # BMI每增加1,OR=1.16
  0.6 * data_cross$smoking          # 吸烟 OR=1.82
)
data_cross$hypertension <- rbinom(n, 1, prob_htn)

# 转换为因子变量(便于分析)
data_cross <- data_cross |>
  mutate(
    gender_f = factor(gender, levels = 0:1, labels = c("女", "男")),
    smoking_f = factor(smoking, levels = 0:1, labels = c("不吸烟", "吸烟")),
    hypertension_f = factor(hypertension, levels = 0:1, labels = c("无高血压", "高血压"))
  )

# 查看数据结构
head(data_cross)
```

**变量说明**:
- `age`:年龄(岁),连续变量
- `gender`:性别,0=女,1=男
- `bmi`:体重指数,连续变量
- `smoking`:吸烟状态,0=不吸烟,1=吸烟(暴露因素)
- `hypertension`:高血压状态,0=无,1=有(结局变量)

### 缺失值处理

横截面研究中的缺失值处理策略:

```{r missing-check}
# 检查缺失值
library(tidyverse)

# 计算缺失比例
missing_summary <- data_cross |>
  summarise(across(everything(), ~mean(is.na(.)) * 100)) |>
  pivot_longer(everything(), names_to = "Variable", values_to = "Missing_Pct")

print(missing_summary)
```

**缺失值处理建议**:

1. **完全随机缺失(MCAR)**:可以完全病例分析
2. **随机缺失(MAR)**:使用多重插补
3. **非随机缺失(MNAR)**:敏感性分析

由于我们的模拟数据无缺失,实际研究中如有缺失,可使用:

```{r missing-imputation, eval=FALSE}
# 多重插补示例(如有缺失值)
library(mice)
imp_data <- mice(data_cross, m = 5, method = "pmm", seed = 2026)
complete_data <- complete(imp_data, 1)
```

## 完整分析流程

### 步骤1:探索性数据分析

首先查看数据的基本特征和分布:

```{r eda-summary}
library(gtsummary)

# 基线特征表
table1 <- data_cross |>
  select(age, gender_f, bmi, smoking_f, hypertension_f) |>
  tbl_summary(
    by = hypertension_f,
    statistic = list(
      all_continuous() ~ "{mean} ({sd})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    label = list(
      age ~ "年龄(岁)",
      gender_f ~ "性别",
      bmi ~ "BMI",
      smoking_f ~ "吸烟状态"
    )
  ) |>
  add_p() |>
  add_overall()

table1
```

**结果解读**:
- 该表展示了按高血压分组的基线特征
- `p-value`列显示组间差异的统计学显著性
- 可初步观察哪些因素与高血压相关

### 步骤2:患病率计算

计算总体患病率和分层患病率:

```{r prevalence-calculation}
# 总体患病率
overall_prev <- mean(data_cross$hypertension) * 100
cat("高血压总患病率:", round(overall_prev, 2), "%\n\n")

# 按吸烟状态分层的患病率
prev_by_smoking <- data_cross |>
  group_by(smoking_f) |>
  summarise(
    n = n(),
    cases = sum(hypertension),
    prevalence = mean(hypertension) * 100,
    se = sqrt(prevalence * (100 - prevalence) / n),
    lower_ci = prevalence - 1.96 * se,
    upper_ci = prevalence + 1.96 * se
  )

print(prev_by_smoking)
```

**患病率可视化**:

```{r prev-barplot, fig.height=4}
library(ggplot2)

ggplot(prev_by_smoking, aes(x = smoking_f, y = prevalence, fill = smoking_f)) +
  geom_col(width = 0.6, alpha = 0.8) +
  geom_errorbar(
    aes(ymin = lower_ci, ymax = upper_ci),
    width = 0.2
  ) +
  geom_text(
    aes(label = paste0(round(prevalence, 1), "%")),
    vjust = -0.5,
    size = 4
  ) +
  scale_fill_manual(values = c("#3b82f6", "#ef4444")) +
  labs(
    title = "按吸烟状态分层的高血压患病率",
    x = "吸烟状态",
    y = "患病率 (%)",
    fill = ""
  ) +
  theme_minimal() +
  theme(
    legend.position = "none",
    plot.title = element_text(hjust = 0.5, face = "bold")
  )
```

### 步骤3:卡方检验

检验暴露与结局的关联性:

```{r chi-square-test}
# 2x2列联表
table_2x2 <- table(data_cross$smoking_f, data_cross$hypertension_f)
print(table_2x2)

# 卡方检验
chi_test <- chisq.test(table_2x2)
print(chi_test)

# Fisher精确检验(样本量小或期望频数<5时使用)
fisher_test <- fisher.test(table_2x2)
print(fisher_test)
```

**结果解读**:
- 卡方检验的p值 < 0.05,说明吸烟与高血压存在统计学显著关联
- Fisher精确检验在小样本时更稳健

### 步骤4:患病率比(PR)计算

使用`epitools`包计算PR及其95%置信区间:

```{r prevalence-ratio}
library(epitools)

# 重新整理为2x2表(行:暴露,列:结局)
table_epi <- table(
  factor(data_cross$smoking, levels = c(1, 0)),
  factor(data_cross$hypertension, levels = c(1, 0))
)

# 计算PR
pr_result <- epitab(table_epi, method = "riskratio")
print(pr_result)
```

**PR解释**:
- PR = 暴露组患病率 / 非暴露组患病率
- 如 PR = 1.5,表示吸烟者的高血压患病率是不吸烟者的1.5倍
- 95%CI不包含1,说明关联有统计学意义

### 步骤5:Logistic回归分析

#### 单因素Logistic回归

```{r logistic-univariate}
# 单因素回归
model_uni <- glm(
  hypertension ~ smoking,
  data = data_cross,
  family = binomial(link = "logit")
)

# 整洁输出
library(broom)
tidy(model_uni, exponentiate = TRUE, conf.int = TRUE)
```

**注意**:Logistic回归输出的是OR,不是PR!

#### 多因素Logistic回归

```{r logistic-multivariate}
# 多因素回归
model_multi <- glm(
  hypertension ~ smoking + age + gender + bmi,
  data = data_cross,
  family = binomial(link = "logit")
)

# 使用gtsummary生成表格
tbl_regression(
  model_multi,
  exponentiate = TRUE,
  label = list(
    smoking ~ "吸烟",
    age ~ "年龄",
    gender ~ "性别(男vs女)",
    bmi ~ "BMI"
  )
)
```

### 步骤6:修正的Poisson回归估计PR

当疾病常见时(>10%),OR会高估PR。使用修正的Poisson回归:

```{r modified-poisson}
library(sandwich)
library(lmtest)

# Poisson回归
model_poisson <- glm(
  hypertension ~ smoking + age + gender + bmi,
  data = data_cross,
  family = poisson(link = "log")
)

# 稳健标准误
coef_robust <- coeftest(model_poisson, vcov = vcovHC(model_poisson, type = "HC0"))
print(coef_robust)

# 转换为PR
pr_estimates <- exp(cbind(
  PR = coef(model_poisson),
  confint(model_poisson)
))
print(pr_estimates)
```

**PR vs OR 对比**:

```{r pr-or-comparison}
or_smoking <- exp(coef(model_multi)["smoking"])
pr_smoking <- exp(coef(model_poisson)["smoking"])

comparison <- data.frame(
  Measure = c("OR (Logistic)", "PR (Poisson)"),
  Estimate = c(or_smoking, pr_smoking)
)
print(comparison)
```

## 结果解读与报告

### 统计量含义解释

**患病率(Prevalence)**:
- 定义:某一时点患病人数占总人数的比例
- 本研究中高血压总患病率约为X%
- 吸烟组患病率为Y%,不吸烟组为Z%

**患病率比(PR)**:
- 定义:暴露组与非暴露组患病率的比值
- 调整混杂后的PR = X (95%CI: Y-Z)
- 解释:调整年龄、性别、BMI后,吸烟者的高血压患病率是不吸烟者的X倍

**比值比(OR)**:
- 虽然常用于病例对照研究,横截面研究的Logistic回归也输出OR
- 当疾病常见时(>10%),OR会高估关联强度
- 建议报告PR而非OR

### STROBE报告清单(横截面研究)

根据STROBE指南,横截面研究报告应包含:

**题目和摘要**:
- [ ] 在题目或摘要中标明研究设计为"横截面研究"

**引言**:
- [ ] 研究背景和理由
- [ ] 研究目的和假设

**方法**:
- [ ] 研究设计:横截面研究
- [ ] 研究环境和时间:何时何地进行
- [ ] 纳入排除标准
- [ ] 暴露和结局的定义和测量方法
- [ ] 潜在混杂因素及如何处理
- [ ] 样本量估计
- [ ] 统计方法

**结果**:
- [ ] 研究对象流程图
- [ ] 基线特征表(按结局分组)
- [ ] 主要结果:患病率、PR/OR及95%CI
- [ ] 亚组分析和敏感性分析

**讨论**:
- [ ] 主要发现总结
- [ ] 与既往研究的比较
- [ ] 局限性(尤其是因果推断局限)
- [ ] 结论和意义

### 论文报告示例

**结果部分示例**:

> 本研究共纳入500名成年人,平均年龄50.2±12.0岁,其中男性48.0%。高血压总患病率为X% (95%CI: Y%-Z%)。吸烟者高血压患病率(Y%)显著高于不吸烟者(Z%),差异有统计学意义(χ²=XX, P<0.001)。
>
> 单因素分析显示,吸烟与高血压患病率升高相关(PR=X.XX, 95%CI: X.XX-X.XX)。调整年龄、性别和BMI后,吸烟仍与高血压显著相关(调整后PR=X.XX, 95%CI: X.XX-X.XX),表明吸烟者的高血压患病率是不吸烟者的X.XX倍。

## 常见错误与纠偏

### 错误1:混淆患病率与发病率

**错误表现**:
```r
# 错误:称横截面研究估计"发病率"
"本研究发现吸烟组高血压发病率为30%"
```

**正确做法**:
```r
# 正确:称为"患病率"
"本研究发现吸烟组高血压患病率为30%"
```

**原因**:
- 横截面研究无随访,只能估计患病率
- 发病率需要队列研究

### 错误2:因果推断

**错误表现**:
```r
# 错误:声称因果关系
"吸烟导致高血压"
"高BMI是高血压的危险因素"
```

**正确做法**:
```r
# 正确:描述关联性
"吸烟与高血压患病率升高相关"
"高BMI与高血压患病风险增加有关"
```

**原因**:
- 横截面研究无法确定时间先后
- 可能存在反向因果(高血压患者被建议戒烟)

### 错误3:用OR代替PR

**错误表现**:
```r
# 当患病率>10%时,直接报告OR
"吸烟者高血压风险增加OR=2.5倍"
```

**正确做法**:
```r
# 使用修正的Poisson回归估计PR
"吸烟者高血压患病率比为PR=1.8"
```

**原因**:
- 当疾病常见时,OR严重高估关联强度
- PR更直观易懂

### 错误4:忽视混杂因素

**错误表现**:
```r
# 仅报告粗关联
model <- glm(hypertension ~ smoking, family = binomial)
```

**正确做法**:
```r
# 调整已知混杂因素
model <- glm(
  hypertension ~ smoking + age + gender + bmi,
  family = binomial
)
```

### 错误5:选择偏倚

**错误场景**:
- 仅在医院招募受试者(健康人不来医院)
- 应答率过低(<50%)

**应对策略**:
- 采用社区人群抽样
- 提高应答率
- 比较应答者与非应答者的特征
- 进行加权调整

## 进阶扩展

### PR vs OR 争论

流行病学界对于横截面研究应报告PR还是OR存在争论:

**支持报告PR的理由**:
1. PR更直观:患病率比易于理解
2. OR高估:当患病率>10%时,OR明显大于PR
3. 可比性:与队列研究的RR可比

**支持报告OR的理由**:
1. Logistic回归标准输出
2. 数学性质好:对称性、可合并性
3. 病例对照研究只能算OR,保持一致

**我们的建议**:
- 主要分析报告PR(使用修正Poisson回归)
- 附加报告OR作为敏感性分析
- 在方法部分说明原因

### 倾向评分在横截面研究中的应用

虽然横截面研究无法确定因果,但可使用倾向评分平衡混杂:

```{r ps-weighting, eval=FALSE}
library(WeightIt)

# 估计倾向评分
ps_model <- weightit(
  smoking ~ age + gender + bmi,
  data = data_cross,
  method = "ps",
  estimand = "ATE"
)

# 加权后的结果
weighted_model <- glm(
  hypertension ~ smoking,
  data = data_cross,
  weights = ps_model$weights,
  family = poisson(link = "log")
)
```

### 多水平横截面研究

当数据存在聚类结构(如学校内的学生)时:

```{r multilevel, eval=FALSE}
library(lme4)

# 多水平Logistic回归
mlm_model <- glmer(
  hypertension ~ smoking + age + gender + (1 | school_id),
  data = data_cross_clustered,
  family = binomial
)
```

## 总结

**横截面研究的核心特点**:
1. 同时测量暴露与结局
2. 估计患病率,不能估计发病率
3. 无法确定因果方向
4. 成本低、实施快,适合描述性研究

**分析要点**:
1. 计算患病率及95%CI
2. 使用修正Poisson回归估计PR(而非OR)
3. 调整混杂因素
4. 进行敏感性分析

**报告规范**:
- 遵循STROBE指南
- 明确说明研究局限(无因果推断)
- 患病率而非发病率
- PR优于OR

**下一步研究**:
- 横截面研究可用于假设生成
- 需队列研究或RCT验证因果关系

## 参考文献

1. Vandenbroucke JP, et al. Strengthening the Reporting of Observational Studies in Epidemiology (STROBE): Explanation and Elaboration. *PLoS Med*. 2007;4(10):e297.

2. Barros AJ, Hirakata VN. Alternatives for logistic regression in cross-sectional studies: an empirical comparison of models that directly estimate the prevalence ratio. *BMC Med Res Methodol*. 2003;3:21.

3. Rothman KJ, Greenland S, Lash TL. *Modern Epidemiology*. 3rd ed. Philadelphia: Lippincott Williams & Wilkins; 2008.

4. Schmidt CO, Kohlmann T. When to use the odds ratio or the relative risk? *Int J Public Health*. 2008;53(3):165-167.

5. Zou G. A modified poisson regression approach to prospective studies with binary data. *Am J Epidemiol*. 2004;159(7):702-706.

