<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-01-15">

<title>缺失值查看与处理完全指南 – R 语言学习笔记</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-8b4baf804e461d9b72633f0de59a0cac.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f04c1bab01eaa4046294d2af630dbbb8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R 语言学习笔记</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">主页</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">入门指南</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="./sections/guide.html#学习路线">
 <span class="dropdown-text">📘 学习路线</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/guide.html#基础知识">
 <span class="dropdown-text">📖 基础知识</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/guide.html#工作流程">
 <span class="dropdown-text">⚙️ 工作流程</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-包" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">实用 R 包</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-包">    
        <li>
    <a class="dropdown-item" href="./sections/packages.html#表格制作">
 <span class="dropdown-text">📊 表格制作</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/packages.html#数据处理">
 <span class="dropdown-text">🔄 数据处理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/packages.html#模型整理">
 <span class="dropdown-text">📈 模型整理</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">统计分析方法</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--1">    
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#基础回归">
 <span class="dropdown-text">📊 基础回归</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#生存分析">
 <span class="dropdown-text">⏱️ 生存分析</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#因果推断">
 <span class="dropdown-text">🎯 因果推断</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#高级建模">
 <span class="dropdown-text">📐 高级建模</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#贝叶斯统计">
 <span class="dropdown-text">📈 贝叶斯统计</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#模型评估">
 <span class="dropdown-text">🎯 模型评估</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/statistics.html#综述方法">
 <span class="dropdown-text">📚 综述方法</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-ai" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">机器学习与AI</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-ai">    
        <li>
    <a class="dropdown-item" href="./sections/machine-learning.html#机器学习框架">
 <span class="dropdown-text">🤖 机器学习框架</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/machine-learning.html#深度学习">
 <span class="dropdown-text">🧠 深度学习</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">实用操作</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--2">    
        <li>
    <a class="dropdown-item" href="./sections/operation.html#数据导入导出">
 <span class="dropdown-text">📥 数据导入导出</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#数据清洗">
 <span class="dropdown-text">🧹 数据清洗</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#数据转换">
 <span class="dropdown-text">🔄 数据转换</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#文档写作">
 <span class="dropdown-text">📝 文档写作</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/operation.html#开发环境">
 <span class="dropdown-text">💻 开发环境</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--3" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">数据可视化</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--3">    
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#图形基础">
 <span class="dropdown-text">🏗️ 图形基础</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#图形组合">
 <span class="dropdown-text">🔀 图形组合</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#分布图">
 <span class="dropdown-text">📊 分布图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#趋势图">
 <span class="dropdown-text">📈 趋势图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#比较图">
 <span class="dropdown-text">📊 比较图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#关系图">
 <span class="dropdown-text">🔄 关系图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#特殊图形">
 <span class="dropdown-text">🎨 特殊图形</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#专题图">
 <span class="dropdown-text">🗺️ 专题图</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/visualization.html#进阶美化">
 <span class="dropdown-text">✨ 进阶美化</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu--4" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">特殊应用</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu--4">    
        <li>
    <a class="dropdown-item" href="./sections/special.html#卫生经济学">
 <span class="dropdown-text">💰 卫生经济学</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/special.html#质性研究">
 <span class="dropdown-text">🔬 质性研究</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./sections/special.html#信号处理">
 <span class="dropdown-text">📡 信号处理</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KangWang42/R_note_for_Epidemiology"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">实用操作</li><li class="breadcrumb-item"><a href="./1046-missing-data.html">🧹 数据清洗</a></li><li class="breadcrumb-item"><a href="./1046-missing-data.html">缺失值处理</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">入门指南</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">📘 学习路线</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0001-guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">新手入门指南</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">📖 基础知识</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMarkdown 入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012-quarto-vs-rmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto vs RMarkdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013-positron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positron IDE 教程</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">⚙️ 工作流程</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3006-reproducible-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">可重复研究工作流</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">实用 R 包</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 表格制作</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1011-rpac_brucer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">bruceR - 统计分析工具</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1012-comparegroups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">compareGroups - 描述性表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1013-scitb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scitb - 快速基线表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1053-gtsummary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gtsummary - 发表级表格</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1067-gt-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">gt - 现代表格系统</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">🔄 数据处理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1014-purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">purrr - 函数式编程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1014-future.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">future - 并行计算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1045-rstatix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rstatix - 管道式统计</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1071-targets-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">targets - 工作流管理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1072-arrow-bigdata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">arrow - 大数据处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3015-tidytable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidytable - 高性能数据处理</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">📈 模型整理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1043-broom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">broom - 模型整理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1064-marginaleffects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">marginaleffects - 边际效应</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">统计分析方法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 基础回归</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1019-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic 回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1021-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多元线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1026-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson/负二项回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1036-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">方差分析 (ANOVA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1074-quantile-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">分位数回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1075-zero-inflated.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">零膨胀模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1093-ordinal-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">有序回归</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">⏱️ 生存分析</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1020-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">生存分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1050-competing-risks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">竞争风险分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1027-rcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">限制性立方样条 (RCS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1017-timeseries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时间序列分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1055-tx-effects-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">治疗效果分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1061-random-survival-forest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">随机生存森林 (RSF)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1077-composite-endpoints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">复合结局分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">🎯 因果推断</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1018-psm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">倾向性得分匹配</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1028-did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双重差分法 (DiD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1023-mediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">中介效应分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1054-subgroup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">亚组分析与交互作用</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1056-dag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DAG 因果图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1057-target-trial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">目标试验模拟</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1058-mendelian-randomization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">孟德尔随机化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1060-instrumental-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">工具变量法 (IV)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1059-evalue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E值敏感性分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1065-tmle-doubly-robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TMLE 双重稳健估计</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1066-causalimpact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CausalImpact 时间序列因果</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1076-ipw-weighting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IPW 倒概率加权</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1092-double-machine-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双重机器学习 (DML)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">📐 高级建模</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1024-multilevel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多水平模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1025-gam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">广义加性模型 (GAM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1085-gee.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">广义估计方程 (GEE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1086-multiple-imputation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多重插补</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1087-msm-iptw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">边际结构模型 (MSM) 与 IPTW</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1088-fine-gray.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fine-Gray 竞争风险模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1089-time-varying-cox.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时变协变量 Cox 模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1090-ps-weight-diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">倾向评分权重诊断</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1091-advanced-target-trial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">目标试验模拟进阶</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1032-sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">结构方程模型 (SEM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1097-clpm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交叉滞后面板模型 (CLPM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1031-lca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">潜类别分析 (LCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1098-gbtm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">基于群组的轨迹模型 (GBTM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1039-pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">主成分分析 (PCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1038-efa-cfa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">因子分析 (EFA/CFA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1037-plspm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PLS-PM 路径模型</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false">
 <span class="menu-text">📈 贝叶斯统计</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1051-bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">贝叶斯统计入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1078-rstanarm-bayesian.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">rstanarm 贝叶斯回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1073-prophet-forecasting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">prophet 时间序列预测</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false">
 <span class="menu-text">🎯 模型评估</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1052-bootstrap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bootstrap与置换检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1047-roc-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ROC 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1100-auc-auprc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AUC 与 AUPRC 对比</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1102-dca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">决策曲线分析 (DCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1048-power-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">样本量计算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1049-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">探索性数据分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false">
 <span class="menu-text">📚 综述方法</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-16" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-16" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1022-meta-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meta 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1041-network-meta.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网状 Meta 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1029-umbrella-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">伞状综述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1040-scoping-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">范围综述</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true">
 <span class="menu-text">机器学习与AI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-17" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-17" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false">
 <span class="menu-text">🤖 机器学习框架</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-18" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-18" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1016-mlr3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">mlr3 机器学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1042-tidymodels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidymodels 机器学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1101-ml-metrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">机器学习预测指标</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1079-kmeans.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">K-means 聚类教程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1094-knn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">KNN 最近邻</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1095-naive-bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">朴素贝叶斯</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1096-gbdt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GBDT 梯度提升树</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1068-xgboost.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">XGBoost 梯度提升</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1070-fairmetrics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">fairmetrics 公平性评估</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1080-random-forest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">随机森林与决策树</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1081-svm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">支持向量机 (SVM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1082-ensemble-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">集成学习 (Bagging/Stacking)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1083-dimensionality-reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">降维 (PCA/UMAP/t-SNE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1084-anomaly-detection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">无监督异常检测</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1099-nested-cv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">嵌套交叉验证</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false">
 <span class="menu-text">🧠 深度学习</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-19" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-19" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1044-lstm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LSTM 深度学习</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1069-torch-deep-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">torch 深度学习</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="true">
 <span class="menu-text">实用操作</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-20" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-20" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false">
 <span class="menu-text">📥 数据导入导出</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-21" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-21" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3001-imports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数据导入导出</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3002-datatable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">data.table 完全指南</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3003-dplyr-tidyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">dplyr/tidyr 数据处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3012-readr-readxl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">readr/readxl - 高效读取</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3013-duckplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">duckplyr - 高性能数据处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3005-pdf-reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PDF文件读取</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="true">
 <span class="menu-text">🧹 数据清洗</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-22" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-22" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1046-missing-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">缺失值处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1063-outlier-detection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">异常值检测与处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3014-janitor-cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">janitor 数据清洗实战</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false">
 <span class="menu-text">🔄 数据转换</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-23" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-23" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3010-stringr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">stringr - 字符串处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3009-datetime.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">日期时间处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3011-forcats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">forcats - 因子处理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3008-regexp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">正则表达式</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false">
 <span class="menu-text">📝 文档写作</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-24" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-24" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMarkdown 入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012-quarto-vs-rmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto vs RMarkdown</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false">
 <span class="menu-text">💻 开发环境</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-25" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-25" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013-positron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positron IDE 教程</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4001-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Shiny Web 应用</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3006-reproducible-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">可重复研究工作流</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3004-web-scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网络爬虫入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3007-research-databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">主流科研数据库指南</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="true">
 <span class="menu-text">数据可视化</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-26" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-26" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false">
 <span class="menu-text">🏗️ 图形基础</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-27" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-27" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2032-ggplot2-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2 可视化入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2033-ggplot2-styling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggplot2 样式设置详解</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2011-viscolor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">配色方案</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2013-legend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">图例自定义</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2061-base-r-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Base R 绑图基础</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="false">
 <span class="menu-text">🔀 图形组合</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-28" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-28" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2012-patchwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">patchwork - 图片拼接</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2021-cowplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">cowplot - 图形组合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2031-bindcomplex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">复杂组合图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 分布图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-29" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-29" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2025-bindboxplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">箱线图与小提琴图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2027-bindhistogram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">直方图与密度图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2043-bindjoyplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Joy Plot 山脊图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2041-bindjitter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">抖动图与蜂群图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false">
 <span class="menu-text">📈 趋势图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-30" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-30" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2026-bindscatterplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">散点图与趋势线</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2029-bindlineplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">折线图与时间序列</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2030-bindareaplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">面积图与堆叠图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2048-bindpeakvalley.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时序峰谷标记图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 比较图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-31" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-31" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2028-bindbarchart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">柱状图与饼图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2035-bindlollipop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">棒棒糖图与排序图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2036-binddivergent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">发散型图表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2039-binddumbbell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">哑铃图与坡度图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2047-bindbullet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">子弹图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false">
 <span class="menu-text">🔄 关系图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-32" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-32" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2040-bindbubblechart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">气泡图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2042-bindmarginal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">边缘分布图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2049-bindcorrplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">相关图矩阵</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2051-bindpairplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">矩阵图与成对图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2057-bindparallel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">平行坐标图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false">
 <span class="menu-text">🎨 特殊图形</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-33" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-33" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2037-bindwaffle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">华夫饼图与树形图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2038-bindpyramid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">人口金字塔图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2045-binddonut.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">环形图与甜甜圈图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2044-bindcalendar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">日历热图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2046-bindwaterfall.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">瀑布图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2058-bindmosaic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">马赛克图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false">
 <span class="menu-text">🗺️ 专题图</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-34" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-34" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2015-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">地图绑制</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2014-sankey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">桑基图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2016-forestplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">森林图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2020-heatmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">热图绑制完全指南</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2024-venn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">韦恩图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2023-radar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">雷达图</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false">
 <span class="menu-text">📊 其他图形</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-35" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-35" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2050-bindcountplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">计数图与分类图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2052-bindacf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">自相关图 ACF/PACF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2053-bindwordcloud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">词云图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2054-bindnetwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网络关系图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2055-bindgantt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">甘特图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2056-bindfunnel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">漏斗图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2059-bindribbon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">置信区间图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2060-ml-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">机器学习可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2064-gganimate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">动态图表与动画可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2062-interactive-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交互式可视化进阶</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false">
 <span class="menu-text">✨ 进阶美化</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-36" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-36" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2017-ggtext.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggtext - 中英文字体混合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2018-tidyplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidyplots - 极简可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2022-ggally.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GGally - 可视化扩展</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2019-dualaxis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双坐标轴</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2034-ggguides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggguides - 图例简化</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="true">
 <span class="menu-text">特殊应用</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-37" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-37" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="false">
 <span class="menu-text">💰 卫生经济学</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-38" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-38" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1015-health-economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">卫生经济学分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1062-treeage-pro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">TreeAge Pro 决策分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-39" role="navigation" aria-expanded="false">
 <span class="menu-text">🔬 质性研究</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-39" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-39" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1030-qualitative-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">质性研究与文本挖掘</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-40" role="navigation" aria-expanded="false">
 <span class="menu-text">📡 信号处理</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-40" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-40" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1096-wavelet-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">小波变换 (Wavelet Transform)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1033-dlnm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">分布滞后非线性模型 (DLNM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1034-nvmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">变分模态分解 (VMD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1035-fft-nvmd-gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FFT + VMD + GMM</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#缺失值问题概述" id="toc-缺失值问题概述" class="nav-link active" data-scroll-target="#缺失值问题概述">缺失值问题概述</a>
  <ul class="collapse">
  <li><a href="#缺失机制分类" id="toc-缺失机制分类" class="nav-link" data-scroll-target="#缺失机制分类">缺失机制分类</a></li>
  <li><a href="#缺失处理策略总览" id="toc-缺失处理策略总览" class="nav-link" data-scroll-target="#缺失处理策略总览">缺失处理策略总览</a></li>
  </ul></li>
  <li><a href="#r-包安装与加载" id="toc-r-包安装与加载" class="nav-link" data-scroll-target="#r-包安装与加载">R 包安装与加载</a></li>
  <li><a href="#创建示例数据" id="toc-创建示例数据" class="nav-link" data-scroll-target="#创建示例数据">创建示例数据</a></li>
  <li><a href="#第一部分缺失值检测" id="toc-第一部分缺失值检测" class="nav-link" data-scroll-target="#第一部分缺失值检测">第一部分：缺失值检测</a>
  <ul class="collapse">
  <li><a href="#基础统计" id="toc-基础统计" class="nav-link" data-scroll-target="#基础统计">基础统计</a></li>
  <li><a href="#使用-naniar-包" id="toc-使用-naniar-包" class="nav-link" data-scroll-target="#使用-naniar-包">使用 naniar 包</a></li>
  <li><a href="#使用-finalfit-包" id="toc-使用-finalfit-包" class="nav-link" data-scroll-target="#使用-finalfit-包">使用 finalfit 包</a></li>
  </ul></li>
  <li><a href="#第二部分缺失值可视化" id="toc-第二部分缺失值可视化" class="nav-link" data-scroll-target="#第二部分缺失值可视化">第二部分：缺失值可视化</a>
  <ul class="collapse">
  <li><a href="#热图可视化" id="toc-热图可视化" class="nav-link" data-scroll-target="#热图可视化">热图可视化</a></li>
  <li><a href="#数据类型与缺失概览" id="toc-数据类型与缺失概览" class="nav-link" data-scroll-target="#数据类型与缺失概览">数据类型与缺失概览</a></li>
  <li><a href="#upset-图缺失模式组合" id="toc-upset-图缺失模式组合" class="nav-link" data-scroll-target="#upset-图缺失模式组合">UpSet 图：缺失模式组合</a></li>
  <li><a href="#变量间缺失关联" id="toc-变量间缺失关联" class="nav-link" data-scroll-target="#变量间缺失关联">变量间缺失关联</a></li>
  <li><a href="#vim-包高级可视化" id="toc-vim-包高级可视化" class="nav-link" data-scroll-target="#vim-包高级可视化">VIM 包高级可视化</a></li>
  <li><a href="#矩阵图" id="toc-矩阵图" class="nav-link" data-scroll-target="#矩阵图">矩阵图</a></li>
  </ul></li>
  <li><a href="#第三部分缺失机制检验" id="toc-第三部分缺失机制检验" class="nav-link" data-scroll-target="#第三部分缺失机制检验">第三部分：缺失机制检验</a>
  <ul class="collapse">
  <li><a href="#littles-mcar-检验" id="toc-littles-mcar-检验" class="nav-link" data-scroll-target="#littles-mcar-检验">Little’s MCAR 检验</a></li>
  <li><a href="#缺失指示变量分析" id="toc-缺失指示变量分析" class="nav-link" data-scroll-target="#缺失指示变量分析">缺失指示变量分析</a></li>
  </ul></li>
  <li><a href="#第四部分简单处理方法" id="toc-第四部分简单处理方法" class="nav-link" data-scroll-target="#第四部分简单处理方法">第四部分：简单处理方法</a>
  <ul class="collapse">
  <li><a href="#删除法" id="toc-删除法" class="nav-link" data-scroll-target="#删除法">删除法</a></li>
  <li><a href="#单值填充" id="toc-单值填充" class="nav-link" data-scroll-target="#单值填充">单值填充</a></li>
  <li><a href="#众数填充分类变量" id="toc-众数填充分类变量" class="nav-link" data-scroll-target="#众数填充分类变量">众数填充（分类变量）</a></li>
  <li><a href="#分组填充" id="toc-分组填充" class="nav-link" data-scroll-target="#分组填充">分组填充</a></li>
  </ul></li>
  <li><a href="#第五部分多重插补-mice" id="toc-第五部分多重插补-mice" class="nav-link" data-scroll-target="#第五部分多重插补-mice">第五部分：多重插补 (mice)</a>
  <ul class="collapse">
  <li><a href="#基本流程" id="toc-基本流程" class="nav-link" data-scroll-target="#基本流程">基本流程</a></li>
  <li><a href="#插补方法选择" id="toc-插补方法选择" class="nav-link" data-scroll-target="#插补方法选择">插补方法选择</a></li>
  <li><a href="#诊断检查收敛性" id="toc-诊断检查收敛性" class="nav-link" data-scroll-target="#诊断检查收敛性">诊断：检查收敛性</a></li>
  <li><a href="#诊断比较插补前后分布" id="toc-诊断比较插补前后分布" class="nav-link" data-scroll-target="#诊断比较插补前后分布">诊断：比较插补前后分布</a></li>
  <li><a href="#提取插补数据" id="toc-提取插补数据" class="nav-link" data-scroll-target="#提取插补数据">提取插补数据</a></li>
  <li><a href="#对多重插补数据建模" id="toc-对多重插补数据建模" class="nav-link" data-scroll-target="#对多重插补数据建模">对多重插补数据建模</a></li>
  </ul></li>
  <li><a href="#第六部分高级插补方法" id="toc-第六部分高级插补方法" class="nav-link" data-scroll-target="#第六部分高级插补方法">第六部分：高级插补方法</a>
  <ul class="collapse">
  <li><a href="#随机森林插补-missranger" id="toc-随机森林插补-missranger" class="nav-link" data-scroll-target="#随机森林插补-missranger">随机森林插补 (missRanger)</a></li>
  <li><a href="#k最近邻插补-vim" id="toc-k最近邻插补-vim" class="nav-link" data-scroll-target="#k最近邻插补-vim">K最近邻插补 (VIM)</a></li>
  </ul></li>
  <li><a href="#第七部分敏感性分析" id="toc-第七部分敏感性分析" class="nav-link" data-scroll-target="#第七部分敏感性分析">第七部分：敏感性分析</a>
  <ul class="collapse">
  <li><a href="#tipping-point-分析" id="toc-tipping-point-分析" class="nav-link" data-scroll-target="#tipping-point-分析">Tipping Point 分析</a></li>
  </ul></li>
  <li><a href="#第八部分完整分析流程" id="toc-第八部分完整分析流程" class="nav-link" data-scroll-target="#第八部分完整分析流程">第八部分：完整分析流程</a>
  <ul class="collapse">
  <li><a href="#实战案例" id="toc-实战案例" class="nav-link" data-scroll-target="#实战案例">实战案例</a></li>
  </ul></li>
  <li><a href="#代码速查表" id="toc-代码速查表" class="nav-link" data-scroll-target="#代码速查表">代码速查表</a></li>
  <li><a href="#报告模板" id="toc-报告模板" class="nav-link" data-scroll-target="#报告模板">报告模板</a></li>
  <li><a href="#总结" id="toc-总结" class="nav-link" data-scroll-target="#总结">总结</a></li>
  <li><a href="#参考资源" id="toc-参考资源" class="nav-link" data-scroll-target="#参考资源">参考资源</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">实用操作</li><li class="breadcrumb-item"><a href="./1046-missing-data.html">🧹 数据清洗</a></li><li class="breadcrumb-item"><a href="./1046-missing-data.html">缺失值处理</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">缺失值查看与处理完全指南</h1>
  <div class="quarto-categories">
    <div class="quarto-category">实用操作</div>
    <div class="quarto-category">数据清洗</div>
    <div class="quarto-category">缺失值</div>
  </div>
  </div>



<div class="quarto-title-meta column-body">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 15, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="缺失值问题概述" class="level2">
<h2 class="anchored" data-anchor-id="缺失值问题概述">缺失值问题概述</h2>
<p>缺失数据是数据分析中最常见的问题之一。正确识别和处理缺失值对于获得可靠的统计推断至关重要。本教程将全面介绍缺失值的检测、可视化和处理方法。</p>
<section id="缺失机制分类" class="level3">
<h3 class="anchored" data-anchor-id="缺失机制分类">缺失机制分类</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>类型</th>
<th>全称</th>
<th>含义</th>
<th>例子</th>
<th>处理难度</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>MCAR</strong></td>
<td>Missing Completely At Random</td>
<td>完全随机缺失，与任何变量无关</td>
<td>问卷随机丢失</td>
<td>易</td>
</tr>
<tr class="even">
<td><strong>MAR</strong></td>
<td>Missing At Random</td>
<td>缺失依赖于其他观测变量</td>
<td>高收入人群更不愿报告收入</td>
<td>中</td>
</tr>
<tr class="odd">
<td><strong>MNAR</strong></td>
<td>Missing Not At Random</td>
<td>缺失依赖于缺失值本身</td>
<td>抑郁严重者更可能不填问卷</td>
<td>难</td>
</tr>
</tbody>
</table>
</section>
<section id="缺失处理策略总览" class="level3">
<h3 class="anchored" data-anchor-id="缺失处理策略总览">缺失处理策略总览</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>策略</th>
<th>适用场景</th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>删除法</td>
<td>MCAR，缺失少</td>
<td>简单</td>
<td>损失信息，可能有偏</td>
</tr>
<tr class="even">
<td>单值填充</td>
<td>快速预览</td>
<td>快速</td>
<td>低估方差</td>
</tr>
<tr class="odd">
<td>多重插补</td>
<td>MAR</td>
<td>保留不确定性</td>
<td>计算复杂</td>
</tr>
<tr class="even">
<td>最大似然</td>
<td>MAR</td>
<td>高效无偏</td>
<td>需特定模型</td>
</tr>
</tbody>
</table>
<hr>
</section>
</section>
<section id="r-包安装与加载" class="level2">
<h2 class="anchored" data-anchor-id="r-包安装与加载">R 包安装与加载</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 核心包</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># 数据处理</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar) <span class="co"># 缺失值可视化（核心）</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VIM) <span class="co"># 高级可视化</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice) <span class="co"># 多重插补</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(finalfit) <span class="co"># 临床研究报告</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 辅助包</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visdat) <span class="co"># 数据概览</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(missRanger) <span class="co"># 随机森林插补</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="创建示例数据" class="level2">
<h2 class="anchored" data-anchor-id="创建示例数据">创建示例数据</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建含多种缺失模式的示例数据</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 基础数据（无缺失）</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df_complete <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n, <span class="dv">55</span>, <span class="dv">12</span>)),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"男"</span>, <span class="st">"女"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">factor</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"初中"</span>, <span class="st">"高中"</span>, <span class="st">"本科"</span>, <span class="st">"研究生"</span>), n,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"初中"</span>, <span class="st">"高中"</span>, <span class="st">"本科"</span>, <span class="st">"研究生"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">income =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n, <span class="dv">8000</span>, <span class="dv">3000</span>)),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">bmi =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n, <span class="dv">24</span>, <span class="dv">4</span>), <span class="dv">1</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">blood_pressure =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n, <span class="dv">130</span>, <span class="dv">20</span>)),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cholesterol =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n, <span class="dv">200</span>, <span class="dv">40</span>)),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">glucose =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(n, <span class="dv">100</span>, <span class="dv">25</span>)),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">exercise_hours =</span> <span class="fu">round</span>(<span class="fu">rpois</span>(n, <span class="dv">3</span>)),</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">smoking =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"从不"</span>, <span class="st">"已戒"</span>, <span class="st">"吸烟"</span>), n,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">disease_score =</span> <span class="fu">round</span>(<span class="dv">50</span> <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> (age <span class="sc">-</span> <span class="dv">55</span>) <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> (bmi <span class="sc">-</span> <span class="dv">24</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 引入不同类型的缺失</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df_complete <span class="sc">%&gt;%</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># MCAR: 完全随机缺失（年龄，约10%）</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.10</span>, <span class="cn">NA</span>, age),</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># MAR: 依赖其他变量（收入缺失与教育水平相关 - 教育低的更不愿报告）</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">income =</span> <span class="fu">ifelse</span>(</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">as.numeric</span>(education) <span class="sc">&lt;=</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.25</span>, <span class="co"># 初中/高中25%缺失</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>            <span class="cn">NA</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="cn">NA</span>, income) <span class="co"># 其他5%缺失</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># MAR: 胆固醇缺失与年龄相关</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">cholesterol =</span> <span class="fu">ifelse</span>(age <span class="sc">&gt;</span> <span class="dv">60</span> <span class="sc">|</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.15</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.3</span>, <span class="cn">NA</span>, cholesterol),</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>            cholesterol</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 血糖：与BMI相关的缺失</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">glucose =</span> <span class="fu">ifelse</span>(bmi <span class="sc">&gt;</span> <span class="dv">28</span> <span class="sc">&amp;</span> <span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.2</span>, <span class="cn">NA</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.08</span>, <span class="cn">NA</span>, glucose)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 教育：少量随机缺失</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">education =</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="cn">NA</span>, <span class="fu">as.character</span>(education)),</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">education =</span> <span class="fu">factor</span>(education, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"初中"</span>, <span class="st">"高中"</span>, <span class="st">"本科"</span>, <span class="st">"研究生"</span>)),</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 吸烟状态：极少缺失</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">smoking =</span> <span class="fu">ifelse</span>(<span class="fu">runif</span>(n) <span class="sc">&lt;</span> <span class="fl">0.03</span>, <span class="cn">NA</span>, <span class="fu">as.character</span>(smoking)),</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">smoking =</span> <span class="fu">factor</span>(smoking, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"从不"</span>, <span class="st">"已戒"</span>, <span class="st">"吸烟"</span>))</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看数据</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 500
Columns: 12
$ id             &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, …
$ age            &lt;dbl&gt; 67, 61, 54, 52, 69, 71, 61, 53, 40, 42, 35, 61, 65, NA,…
$ sex            &lt;fct&gt; 女, 女, 男, 女, 女, 男, 男, 男, 女, 女, 女, 女, 女, 女, 男, 男, 男, 男, 女…
$ education      &lt;fct&gt; 本科, 高中, 研究生, 本科, 初中, 初中, 本科, 高中, 初中, 本科, 高中, 高中, 本科, 高中…
$ income         &lt;dbl&gt; 7845, 6502, 5292, 6884, 7435, 5790, 5371, 3805, 9184, 6…
$ bmi            &lt;dbl&gt; 34.2, 23.3, 26.9, 19.8, 22.8, 24.1, 28.9, 23.0, 30.8, 2…
$ blood_pressure &lt;dbl&gt; 150, 104, 118, 83, 122, 89, 150, 152, 104, 111, 104, 11…
$ cholesterol    &lt;dbl&gt; 121, 232, NA, 212, NA, 177, 247, 187, 138, 238, 171, 17…
$ glucose        &lt;dbl&gt; NA, 107, 113, 96, 104, 122, NA, 57, 100, 108, 80, NA, 1…
$ exercise_hours &lt;dbl&gt; 4, 2, 0, 1, 3, 5, 7, 7, 2, 4, 5, 3, 3, 1, 5, 4, 0, 4, 3…
$ smoking        &lt;fct&gt; 已戒, 从不, 从不, 从不, 从不, 已戒, 已戒, 从不, 吸烟, 从不, 吸烟, 已戒, 从不, 吸烟,…
$ disease_score  &lt;dbl&gt; 115, 42, 50, 4, 55, 62, 88, 53, 90, 71, 48, 73, 40, 45,…</code></pre>
</div>
</div>
<hr>
</section>
<section id="第一部分缺失值检测" class="level2">
<h2 class="anchored" data-anchor-id="第一部分缺失值检测">第一部分：缺失值检测</h2>
<section id="基础统计" class="level3">
<h3 class="anchored" data-anchor-id="基础统计">基础统计</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 总体缺失情况</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===== 缺失值基础统计 =====</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>===== 缺失值基础统计 =====</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"总缺失数:"</span>, <span class="fu">sum</span>(<span class="fu">is.na</span>(df)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>总缺失数: 301 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"总缺失率:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">is.na</span>(df)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>总缺失率: 5.02 %</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 每列缺失数和比例</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    变量 <span class="ot">=</span> <span class="fu">names</span>(df),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    缺失数 <span class="ot">=</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="fu">is.na</span>(x))),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    缺失率 <span class="ot">=</span> <span class="fu">sapply</span>(df, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">is.na</span>(x)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(缺失数 <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(缺失率))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   变量 缺失数 缺失率
cholesterol cholesterol     90   18.0
income           income     80   16.0
glucose         glucose     66   13.2
age                 age     36    7.2
education     education     18    3.6
smoking         smoking     11    2.2</code></pre>
</div>
</div>
</section>
<section id="使用-naniar-包" class="level3">
<h3 class="anchored" data-anchor-id="使用-naniar-包">使用 naniar 包</h3>
<p><code>naniar</code> 包提供了 tidyverse 风格的缺失值处理函数。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 变量级别的缺失摘要</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   variable       n_miss pct_miss
   &lt;chr&gt;           &lt;int&gt;    &lt;num&gt;
 1 cholesterol        90     18  
 2 income             80     16  
 3 glucose            66     13.2
 4 age                36      7.2
 5 education          18      3.6
 6 smoking            11      2.2
 7 id                  0      0  
 8 sex                 0      0  
 9 bmi                 0      0  
10 blood_pressure      0      0  
11 exercise_hours      0      0  
12 disease_score       0      0  </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 样本级别的缺失摘要</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_summary</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
    case n_miss pct_miss
   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1   136      4     33.3
 2   346      4     33.3
 3   413      4     33.3
 4    41      3     25  
 5    68      3     25  
 6    83      3     25  
 7   111      3     25  
 8   122      3     25  
 9   172      3     25  
10   218      3     25  </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 缺失表格（按缺失变量数分组）</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_table</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  n_miss_in_case n_cases pct_cases
           &lt;int&gt;   &lt;int&gt;     &lt;dbl&gt;
1              0     280      56  
2              1     156      31.2
3              2      50      10  
4              3      11       2.2
5              4       3       0.6</code></pre>
</div>
</div>
</section>
<section id="使用-finalfit-包" class="level3">
<h3 class="anchored" data-anchor-id="使用-finalfit-包">使用 finalfit 包</h3>
<p><code>finalfit</code> 包特别适合临床研究报告。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 缺失模式摘要</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ff_glimpse</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Continuous
                        label var_type   n missing_n missing_percent   mean
id                         id    &lt;int&gt; 500         0             0.0  250.5
age                       age    &lt;dbl&gt; 464        36             7.2   55.7
income                 income    &lt;dbl&gt; 420        80            16.0 8126.0
bmi                       bmi    &lt;dbl&gt; 500         0             0.0   24.0
blood_pressure blood_pressure    &lt;dbl&gt; 500         0             0.0  130.7
cholesterol       cholesterol    &lt;dbl&gt; 410        90            18.0  199.1
glucose               glucose    &lt;dbl&gt; 434        66            13.2   99.2
exercise_hours exercise_hours    &lt;dbl&gt; 500         0             0.0    3.0
disease_score   disease_score    &lt;dbl&gt; 500         0             0.0   50.2
                   sd   min quartile_25 median quartile_75     max
id              144.5   1.0       125.8  250.5       375.2   500.0
age              11.6  16.0        48.0   56.0        64.0    90.0
income         2872.1 438.0      6310.5 7830.5      9930.8 15544.0
bmi               3.9  12.2        21.4   24.1        26.8    35.0
blood_pressure   19.2  70.0       118.0  132.0       144.0   190.0
cholesterol      41.0  78.0       170.0  199.0       229.8   300.0
glucose          25.3  16.0        81.0   99.0       116.0   171.0
exercise_hours    1.8   0.0         2.0    3.0         4.0    10.0
disease_score    22.2 -21.0        36.0   50.0        64.2   115.0

$Categorical
              label var_type   n missing_n missing_percent levels_n
sex             sex    &lt;fct&gt; 500         0             0.0        2
education education    &lt;fct&gt; 482        18             3.6        4
smoking     smoking    &lt;fct&gt; 489        11             2.2        3
                                                 levels         levels_count
sex                             "男", "女", "(Missing)"             255, 245
education "初中", "高中", "本科", "研究生", "(Missing)" 76, 166, 176, 64, 18
smoking             "从不", "已戒", "吸烟", "(Missing)"     238, 96, 155, 11
                        levels_percent
sex                             51, 49
education 15.2, 33.2, 35.2, 12.8,  3.6
smoking         47.6, 19.2, 31.0,  2.2</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 与结局变量关联的缺失分析</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>explanatory <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"sex"</span>, <span class="st">"education"</span>, <span class="st">"income"</span>, <span class="st">"bmi"</span>, <span class="st">"cholesterol"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>dependent <span class="ot">&lt;-</span> <span class="st">"disease_score"</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">missing_pattern</span>(dependent, explanatory)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    sex bmi disease_score education age income cholesterol    
329   1   1             1         1   1      1           1   0
48    1   1             1         1   1      1           0   1
67    1   1             1         1   1      0           1   1
5     1   1             1         1   1      0           0   2
1     1   1             1         1   0      1           1   1
28    1   1             1         1   0      1           0   2
4     1   1             1         1   0      0           0   3
11    1   1             1         0   1      1           1   1
1     1   1             1         0   1      1           0   2
2     1   1             1         0   1      0           1   2
1     1   1             1         0   1      0           0   3
2     1   1             1         0   0      1           0   3
1     1   1             1         0   0      0           0   4
      0   0             0        18  36     80          90 224</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="第二部分缺失值可视化" class="level2">
<h2 class="anchored" data-anchor-id="第二部分缺失值可视化">第二部分：缺失值可视化</h2>
<p>可视化是理解缺失模式的关键步骤。</p>
<section id="热图可视化" class="level3">
<h3 class="anchored" data-anchor-id="热图可视化">热图可视化</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 naniar</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(df, <span class="at">sort_miss =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"缺失值热图"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"黑色表示缺失，按缺失率排序"</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="数据类型与缺失概览" class="level3">
<h3 class="anchored" data-anchor-id="数据类型与缺失概览">数据类型与缺失概览</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 visdat</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_dat</span>(df) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"数据类型与缺失值概览"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="upset-图缺失模式组合" class="level3">
<h3 class="anchored" data-anchor-id="upset-图缺失模式组合">UpSet 图：缺失模式组合</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 显示变量缺失的组合模式</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_upset</span>(df, <span class="at">nsets =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"缺失模式 UpSet 图"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<p><strong>解读</strong>: UpSet 图显示不同变量缺失的组合。例如，某些样本可能同时缺失收入和胆固醇。</p>
</section>
<section id="变量间缺失关联" class="level3">
<h3 class="anchored" data-anchor-id="变量间缺失关联">变量间缺失关联</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 缺失值的相关性</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_fct</span>(df, <span class="at">fct =</span> sex) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"缺失率与性别的关系"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 按教育水平查看缺失</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gg_miss_fct</span>(df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(education)), <span class="at">fct =</span> education) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"缺失率与教育水平的关系"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="vim-包高级可视化" class="level3">
<h3 class="anchored" data-anchor-id="vim-包高级可视化">VIM 包高级可视化</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 聚合图：展示变量组合的缺失模式</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>aggr_plot <span class="ot">&lt;-</span> <span class="fu">aggr</span>(df,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#4f46e5"</span>, <span class="st">"#ef4444"</span>),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">numbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sortVars =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">names</span>(df),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.7</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">gap =</span> <span class="dv">3</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="fu">c</span>(<span class="st">"缺失比例"</span>, <span class="st">"缺失模式"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Variables sorted by number of missings: 
       Variable Count
    cholesterol 0.180
         income 0.160
        glucose 0.132
            age 0.072
      education 0.036
        smoking 0.022
             id 0.000
            sex 0.000
            bmi 0.000
 blood_pressure 0.000
 exercise_hours 0.000
  disease_score 0.000</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 边际图：展示两个变量的缺失关系</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">marginplot</span>(df[<span class="fu">c</span>(<span class="st">"income"</span>, <span class="st">"cholesterol"</span>)],</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"#4f46e5"</span>, <span class="st">"#ef4444"</span>, <span class="st">"#22c55e"</span>),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"收入与胆固醇的缺失边际图"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>解读</strong>: 边际图中，红色点表示一个变量缺失时另一个变量的分布。如果分布与蓝色（完整数据）明显不同，说明缺失可能不是 MCAR。</p>
</section>
<section id="矩阵图" class="level3">
<h3 class="anchored" data-anchor-id="矩阵图">矩阵图</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 矩阵图：变量对之间的缺失关系</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">matrixplot</span>(df, <span class="at">sortby =</span> <span class="st">"income"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="第三部分缺失机制检验" class="level2">
<h2 class="anchored" data-anchor-id="第三部分缺失机制检验">第三部分：缺失机制检验</h2>
<section id="littles-mcar-检验" class="level3">
<h3 class="anchored" data-anchor-id="littles-mcar-检验">Little’s MCAR 检验</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 naniar 的 mcar_test</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mcar_result <span class="ot">&lt;-</span> <span class="fu">mcar_test</span>(df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mcar_result)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic    df p.value missing.patterns
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;            &lt;int&gt;
1      105.    77  0.0192               12</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 解读</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (mcar_result<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">p &lt; 0.05: 拒绝 MCAR 假设，缺失可能是 MAR 或 MNAR</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">p &gt;= 0.05: 不能拒绝 MCAR 假设</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
p &lt; 0.05: 拒绝 MCAR 假设，缺失可能是 MAR 或 MNAR</code></pre>
</div>
</div>
</section>
<section id="缺失指示变量分析" class="level3">
<h3 class="anchored" data-anchor-id="缺失指示变量分析">缺失指示变量分析</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建缺失指示变量，检验缺失与其他变量的关联</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df_shadow <span class="ot">&lt;-</span> <span class="fu">bind_shadow</span>(df)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 检验收入缺失是否与教育相关</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(df<span class="sc">$</span>education, <span class="fu">is.na</span>(df<span class="sc">$</span>income)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table(df$education, is.na(df$income))
X-squared = 32.796, df = 3, p-value = 3.556e-07</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化缺失与其他变量的关系</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df_shadow <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(education)) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> education, <span class="at">fill =</span> income_NA)) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4f46e5"</span>, <span class="st">"#ef4444"</span>),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"有数据"</span>, <span class="st">"缺失"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"收入缺失与教育水平的关系"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"比例"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">"收入状态"</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="第四部分简单处理方法" class="level2">
<h2 class="anchored" data-anchor-id="第四部分简单处理方法">第四部分：简单处理方法</h2>
<section id="删除法" class="level3">
<h3 class="anchored" data-anchor-id="删除法">删除法</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 完整案例分析（listwise deletion）</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df_complete_cases <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"原始样本量:"</span>, <span class="fu">nrow</span>(df), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>原始样本量: 500 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"完整案例样本量:"</span>, <span class="fu">nrow</span>(df_complete_cases), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>完整案例样本量: 280 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"损失比例:"</span>, <span class="fu">round</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">nrow</span>(df_complete_cases) <span class="sc">/</span> <span class="fu">nrow</span>(df)) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>损失比例: 44 %</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 只删除关键变量的缺失</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df_partial_drop <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_na</span>(age, disease_score)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"删除关键变量缺失后样本量:"</span>, <span class="fu">nrow</span>(df_partial_drop), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>删除关键变量缺失后样本量: 464 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><strong>警告</strong>: 删除法仅在 MCAR 时无偏，且会损失大量信息。</p>
</blockquote>
</section>
<section id="单值填充" class="level3">
<h3 class="anchored" data-anchor-id="单值填充">单值填充</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 均值/中位数填充</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df_mean_imputed <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> <span class="fu">replace_na</span>(age, <span class="fu">round</span>(<span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">income =</span> <span class="fu">replace_na</span>(income, <span class="fu">round</span>(<span class="fu">median</span>(income, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">cholesterol =</span> <span class="fu">replace_na</span>(cholesterol, <span class="fu">round</span>(<span class="fu">mean</span>(cholesterol, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">glucose =</span> <span class="fu">replace_na</span>(glucose, <span class="fu">round</span>(<span class="fu">mean</span>(glucose, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查结果</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df_mean_imputed <span class="sc">%&gt;%</span> <span class="fu">select</span>(age, income, cholesterol, glucose)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 tidyr::replace_na</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>df_filled <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">bmi =</span> <span class="fu">replace_na</span>(bmi, <span class="fu">median</span>(bmi, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="众数填充分类变量" class="level3">
<h3 class="anchored" data-anchor-id="众数填充分类变量">众数填充（分类变量）</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义众数函数</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>get_mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    ux <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    ux[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(x, ux)))]</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 填充分类变量</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>df_mode_filled <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">education =</span> <span class="fu">replace_na</span>(education, <span class="fu">get_mode</span>(education)),</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">smoking =</span> <span class="fu">replace_na</span>(smoking, <span class="fu">get_mode</span>(smoking))</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="分组填充" class="level3">
<h3 class="anchored" data-anchor-id="分组填充">分组填充</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 按性别分组填充年龄</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>df_group_filled <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(sex) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">age =</span> <span class="fu">replace_na</span>(age, <span class="fu">round</span>(<span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="第五部分多重插补-mice" class="level2">
<h2 class="anchored" data-anchor-id="第五部分多重插补-mice">第五部分：多重插补 (mice)</h2>
<p>多重插补是处理 MAR 缺失的<strong>推荐方法</strong>，它通过生成多个插补数据集来保留估计的不确定性。</p>
<section id="基本流程" class="level3">
<h3 class="anchored" data-anchor-id="基本流程">基本流程</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 准备数据（只保留需要分析的变量）</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df_mice <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>        age, sex, education, income, bmi, cholesterol, glucose,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>        exercise_hours, smoking, disease_score</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行多重插补</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    df_mice,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> <span class="dv">5</span>, <span class="co"># 生成5个插补数据集</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"pmm"</span>, <span class="co"># 默认方法：预测均值匹配</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">10</span>, <span class="co"># 迭代次数</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">42</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">print =</span> <span class="cn">FALSE</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看插补模型摘要</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>imp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Class: mids
Number of multiple imputations:  5 
Imputation methods:
           age            sex      education         income            bmi 
         "pmm"             ""          "pmm"          "pmm"             "" 
   cholesterol        glucose exercise_hours        smoking  disease_score 
         "pmm"          "pmm"             ""          "pmm"             "" 
PredictorMatrix:
            age sex education income bmi cholesterol glucose exercise_hours
age           0   1         1      1   1           1       1              1
sex           1   0         1      1   1           1       1              1
education     1   1         0      1   1           1       1              1
income        1   1         1      0   1           1       1              1
bmi           1   1         1      1   0           1       1              1
cholesterol   1   1         1      1   1           0       1              1
            smoking disease_score
age               1             1
sex               1             1
education         1             1
income            1             1
bmi               1             1
cholesterol       1             1</code></pre>
</div>
</div>
</section>
<section id="插补方法选择" class="level3">
<h3 class="anchored" data-anchor-id="插补方法选择">插补方法选择</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>方法</th>
<th>代码</th>
<th>适用类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>预测均值匹配</td>
<td><code>pmm</code></td>
<td>数值型</td>
<td>默认，保持原始分布</td>
</tr>
<tr class="even">
<td>贝叶斯线性回归</td>
<td><code>norm</code></td>
<td>连续数值</td>
<td>正态分布假设</td>
</tr>
<tr class="odd">
<td>逻辑回归</td>
<td><code>logreg</code></td>
<td>二分类</td>
<td>0/1 变量</td>
</tr>
<tr class="even">
<td>多项式回归</td>
<td><code>polyreg</code></td>
<td>多分类</td>
<td>有序/无序分类</td>
</tr>
<tr class="odd">
<td>随机森林</td>
<td><code>rf</code></td>
<td>通用</td>
<td>复杂关系</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看使用的插补方法</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>imp<span class="sc">$</span>method</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           age            sex      education         income            bmi 
         "pmm"             ""          "pmm"          "pmm"             "" 
   cholesterol        glucose exercise_hours        smoking  disease_score 
         "pmm"          "pmm"             ""          "pmm"             "" </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 自定义插补方法</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>method_custom <span class="ot">&lt;-</span> <span class="fu">make.method</span>(df_mice)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>method_custom[<span class="st">"education"</span>] <span class="ot">&lt;-</span> <span class="st">"polyreg"</span> <span class="co"># 多分类用多项式</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>method_custom[<span class="st">"smoking"</span>] <span class="ot">&lt;-</span> <span class="st">"polyreg"</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 重新插补</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>imp_custom <span class="ot">&lt;-</span> <span class="fu">mice</span>(df_mice,</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> <span class="dv">5</span>, <span class="at">method =</span> method_custom,</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">42</span>, <span class="at">print =</span> <span class="cn">FALSE</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>imp_custom<span class="sc">$</span>method</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           age            sex      education         income            bmi 
         "pmm"             ""      "polyreg"          "pmm"             "" 
   cholesterol        glucose exercise_hours        smoking  disease_score 
         "pmm"          "pmm"             ""      "polyreg"             "" </code></pre>
</div>
</div>
</section>
<section id="诊断检查收敛性" class="level3">
<h3 class="anchored" data-anchor-id="诊断检查收敛性">诊断：检查收敛性</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看迭代轨迹（应该稳定收敛）</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(imp, <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"income"</span>, <span class="st">"cholesterol"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="诊断比较插补前后分布" class="level3">
<h3 class="anchored" data-anchor-id="诊断比较插补前后分布">诊断：比较插补前后分布</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 密度图比较</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(imp, <span class="sc">~</span> age <span class="sc">+</span> income <span class="sc">+</span> cholesterol)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 条带图</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stripplot</span>(imp, age <span class="sc">+</span> income <span class="sc">~</span> .imp, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>解读</strong>: 蓝色点是观测值，红色点是插补值。如果分布合理重叠，说明插补质量好。</p>
</section>
<section id="提取插补数据" class="level3">
<h3 class="anchored" data-anchor-id="提取插补数据">提取插补数据</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取第1个插补数据集</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>complete_1 <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="dv">1</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(complete_1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age sex education income  bmi cholesterol glucose exercise_hours smoking
1  67  女      本科   7845 34.2         121      66              4    已戒
2  61  女      高中   6502 23.3         232     107              2    从不
3  54  男    研究生   5292 26.9         178     113              0    从不
4  52  女      本科   6884 19.8         212      96              1    从不
5  69  女      初中   7435 22.8         180     104              3    从不
6  71  男      初中   5790 24.1         177     122              5    已戒
  disease_score
1           115
2            42
3            50
4             4
5            55
6            62</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 提取所有插补数据（长格式）</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>complete_long <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="at">action =</span> <span class="st">"long"</span>, <span class="at">include =</span> <span class="cn">TRUE</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(complete_long)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age sex education income  bmi cholesterol glucose exercise_hours smoking
1  67  女      本科   7845 34.2         121      NA              4    已戒
2  61  女      高中   6502 23.3         232     107              2    从不
3  54  男    研究生   5292 26.9          NA     113              0    从不
4  52  女      本科   6884 19.8         212      96              1    从不
5  69  女      初中   7435 22.8          NA     104              3    从不
6  71  男      初中   5790 24.1         177     122              5    已戒
  disease_score .imp .id
1           115    0   1
2            42    0   2
3            50    0   3
4             4    0   4
5            55    0   5
6            62    0   6</code></pre>
</div>
</div>
</section>
<section id="对多重插补数据建模" class="level3">
<h3 class="anchored" data-anchor-id="对多重插补数据建模">对多重插补数据建模</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 在每个插补数据集上拟合模型</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, <span class="fu">lm</span>(disease_score <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> education <span class="sc">+</span> income <span class="sc">+</span> bmi <span class="sc">+</span> cholesterol))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 查看各数据集的结果</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 45 × 7
   term               estimate std.error statistic   p.value  nobs df.residual
   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;       &lt;dbl&gt;
 1 (Intercept)     -88.8        4.42       -20.1   6.84e- 66   500         491
 2 age               0.325      0.0380       8.55  1.56e- 16   500         491
 3 sex女             0.110      0.874        0.126 9.00e-  1   500         491
 4 education高中    -0.417      1.33        -0.314 7.54e-  1   500         491
 5 education本科     0.642      1.31         0.489 6.25e-  1   500         491
 6 education研究生  -0.436      1.61        -0.271 7.87e-  1   500         491
 7 income            0.0000859  0.000152     0.567 5.71e-  1   500         491
 8 bmi               5.04       0.111       45.3   1.39e-177   500         491
 9 cholesterol      -0.00579    0.0108      -0.538 5.91e-  1   500         491
10 (Intercept)     -87.3        4.55       -19.2   1.26e- 61   500         491
# ℹ 35 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 Rubin 规则合并结果</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>pooled <span class="ot">&lt;-</span> <span class="fu">pool</span>(fit)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             term      estimate    std.error    statistic        df
1     (Intercept) -8.711482e+01 4.6396675465 -18.77609113 289.11817
2             age  3.166707e-01 0.0385649516   8.21135891 397.69676
3           sex女  7.586828e-02 0.8792622419   0.08628629 481.75735
4   education高中 -2.728449e-01 1.3677285572  -0.19948763 365.81528
5   education本科  4.447314e-01 1.3452444928   0.33059520 406.03454
6 education研究生 -3.386356e-01 1.7137413023  -0.19760020 210.22579
7          income  9.915020e-05 0.0001622097   0.61124699 203.73630
8             bmi  5.033286e+00 0.1131169347  44.49630520 433.33042
9     cholesterol -1.143134e-02 0.0119734350  -0.95472509  79.13605
        p.value
1  5.613713e-52
2  3.091819e-15
3  9.312747e-01
4  8.419922e-01
5  7.411208e-01
6  8.435488e-01
7  5.417175e-01
8 1.098290e-163
9  3.426241e-01</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 更完整的汇总表</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>pool_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(pooled) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"["</span>, <span class="fu">round</span>(estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error, <span class="dv">3</span>), <span class="st">", "</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error, <span class="dv">3</span>), <span class="st">"]"</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, std.error, <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>, p.value)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>pool_summary</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             term      estimate    std.error             95% CI  p.value
1     (Intercept) -8.711482e+01 4.6396675465 [-96.209, -78.021]  &lt; 2e-16
2             age  3.166707e-01 0.0385649516     [0.241, 0.392] 3.09e-15
3           sex女  7.586828e-02 0.8792622419    [-1.647, 1.799]    0.931
4   education高中 -2.728449e-01 1.3677285572    [-2.954, 2.408]    0.842
5   education本科  4.447314e-01 1.3452444928    [-2.192, 3.081]    0.741
6 education研究生 -3.386356e-01 1.7137413023     [-3.698, 3.02]    0.844
7          income  9.915020e-05 0.0001622097             [0, 0]    0.542
8             bmi  5.033286e+00 0.1131169347     [4.812, 5.255]  &lt; 2e-16
9     cholesterol -1.143134e-02 0.0119734350    [-0.035, 0.012]    0.343</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="第六部分高级插补方法" class="level2">
<h2 class="anchored" data-anchor-id="第六部分高级插补方法">第六部分：高级插补方法</h2>
<section id="随机森林插补-missranger" class="level3">
<h3 class="anchored" data-anchor-id="随机森林插补-missranger">随机森林插补 (missRanger)</h3>
<p><code>missRanger</code> 使用随机森林进行插补，适合复杂非线性关系。</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 随机森林插补</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df_rf_imputed <span class="ot">&lt;-</span> <span class="fu">missRanger</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    df_mice,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">num.trees =</span> <span class="dv">100</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="dv">0</span>,</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">42</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 检查结果</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df_rf_imputed))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 比较原始数据和插补数据的分布</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>compare_dist <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="st">"income"</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">original =</span> df_mice<span class="sc">$</span>income,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">imputed =</span> df_rf_imputed<span class="sc">$</span>income</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>variable, <span class="at">names_to =</span> <span class="st">"type"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(compare_dist, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4f46e5"</span>, <span class="st">"#22c55e"</span>),</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"插补后"</span>, <span class="st">"原始"</span>)</span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"收入分布：原始 vs 随机森林插补"</span>,</span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"收入"</span>, <span class="at">y =</span> <span class="st">"密度"</span>, <span class="at">fill =</span> <span class="st">""</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k最近邻插补-vim" class="level3">
<h3 class="anchored" data-anchor-id="k最近邻插补-vim">K最近邻插补 (VIM)</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># KNN 插补</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>df_knn_imputed <span class="ot">&lt;-</span> <span class="fu">kNN</span>(df_mice, <span class="at">k =</span> <span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        income            bmi    cholesterol        glucose exercise_hours 
         438.0           12.2           78.0           16.0            0.0 
 disease_score         income            bmi    cholesterol        glucose 
         -21.0        15544.0           35.0          300.0          171.0 
exercise_hours  disease_score 
          10.0          115.0 
           age         income            bmi    cholesterol        glucose 
          16.0          438.0           12.2           78.0           16.0 
exercise_hours  disease_score            age         income            bmi 
           0.0          -21.0           90.0        15544.0           35.0 
   cholesterol        glucose exercise_hours  disease_score 
         300.0          171.0           10.0          115.0 
           age            bmi    cholesterol        glucose exercise_hours 
          16.0           12.2           78.0           16.0            0.0 
 disease_score            age            bmi    cholesterol        glucose 
         -21.0           90.0           35.0          300.0          171.0 
exercise_hours  disease_score 
          10.0          115.0 
           age         income            bmi        glucose exercise_hours 
          16.0          438.0           12.2           16.0            0.0 
 disease_score            age         income            bmi        glucose 
         -21.0           90.0        15544.0           35.0          171.0 
exercise_hours  disease_score 
          10.0          115.0 
           age         income            bmi    cholesterol exercise_hours 
          16.0          438.0           12.2           78.0            0.0 
 disease_score            age         income            bmi    cholesterol 
         -21.0           90.0        15544.0           35.0          300.0 
exercise_hours  disease_score 
          10.0          115.0 
           age         income            bmi    cholesterol        glucose 
          16.0          438.0           12.2           78.0           16.0 
exercise_hours  disease_score            age         income            bmi 
           0.0          -21.0           90.0        15544.0           35.0 
   cholesterol        glucose exercise_hours  disease_score 
         300.0          171.0           10.0          115.0 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kNN 会添加指示变量，需要移除</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>df_knn_imputed <span class="ot">&lt;-</span> df_knn_imputed <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">"_imp"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
</section>
<section id="第七部分敏感性分析" class="level2">
<h2 class="anchored" data-anchor-id="第七部分敏感性分析">第七部分：敏感性分析</h2>
<p>由于无法直接验证 MAR 假设，敏感性分析非常重要。</p>
<section id="tipping-point-分析" class="level3">
<h3 class="anchored" data-anchor-id="tipping-point-分析">Tipping Point 分析</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 模拟 MNAR 场景：假设缺失的收入实际上偏低</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>delta_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">1000</span>, <span class="sc">-</span><span class="dv">2000</span>, <span class="sc">-</span><span class="dv">3000</span>) <span class="co"># 偏移量</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>sensitivity_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(delta_values, <span class="cf">function</span>(delta) {</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 对第一个插补数据集进行敏感性调整</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    imp_adj <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp, <span class="dv">1</span>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 找出原始缺失的位置</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>    missing_idx <span class="ot">&lt;-</span> <span class="fu">is.na</span>(df_mice<span class="sc">$</span>income)</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 对插补值进行偏移</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    imp_adj<span class="sc">$</span>income[missing_idx] <span class="ot">&lt;-</span> imp_adj<span class="sc">$</span>income[missing_idx] <span class="sc">+</span> delta</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 拟合模型</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(disease_score <span class="sc">~</span> age <span class="sc">+</span> income <span class="sc">+</span> bmi, <span class="at">data =</span> imp_adj)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 返回收入系数</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">delta =</span> delta,</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate =</span> <span class="fu">coef</span>(fit)[<span class="st">"income"</span>],</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">se =</span> <span class="fu">summary</span>(fit)<span class="sc">$</span>coefficients[<span class="st">"income"</span>, <span class="st">"Std. Error"</span>],</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">p.value =</span> <span class="fu">summary</span>(fit)<span class="sc">$</span>coefficients[<span class="st">"income"</span>, <span class="st">"Pr(&gt;|t|)"</span>]</span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>sensitivity_results</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  delta  estimate       se p.value
  &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;
1     0 0.0000784 0.000150   0.603
2 -1000 0.0000974 0.000149   0.514
3 -2000 0.000112  0.000146   0.441
4 -3000 0.000122  0.000140   0.384</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化敏感性分析</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sensitivity_results, <span class="fu">aes</span>(<span class="at">x =</span> delta, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#4f46e5"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#4f46e5"</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymin =</span> estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">ymax =</span> estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">width =</span> <span class="dv">100</span>, <span class="at">color =</span> <span class="st">"#4f46e5"</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"敏感性分析：收入效应随 MNAR 偏移的变化"</span>,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"假设的 MNAR 偏移量 (元)"</span>,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">"收入系数估计"</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="第八部分完整分析流程" class="level2">
<h2 class="anchored" data-anchor-id="第八部分完整分析流程">第八部分：完整分析流程</h2>
<section id="实战案例" class="level3">
<h3 class="anchored" data-anchor-id="实战案例">实战案例</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ========== 完整缺失值分析流程 ==========</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 缺失概览</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"===== Step 1: 缺失值概览 =====</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>===== Step 1: 缺失值概览 =====</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(df_mice)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 3
   variable       n_miss pct_miss
   &lt;chr&gt;           &lt;int&gt;    &lt;num&gt;
 1 cholesterol        90     18  
 2 income             80     16  
 3 glucose            66     13.2
 4 age                36      7.2
 5 education          18      3.6
 6 smoking            11      2.2
 7 sex                 0      0  
 8 bmi                 0      0  
 9 exercise_hours      0      0  
10 disease_score       0      0  </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 可视化缺失模式</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(df_mice, <span class="at">sort_miss =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Step 2: 缺失热图"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. MCAR 检验</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">===== Step 3: MCAR 检验 =====</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===== Step 3: MCAR 检验 =====</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcar_test</span>(df_mice <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
  statistic    df p.value missing.patterns
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;            &lt;int&gt;
1      85.8    55 0.00491               12</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 多重插补</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">===== Step 4: 多重插补 =====</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===== Step 4: 多重插补 =====</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>imp_final <span class="ot">&lt;-</span> <span class="fu">mice</span>(df_mice,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">m =</span> <span class="dv">10</span>, <span class="at">method =</span> <span class="st">"pmm"</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">20</span>, <span class="at">seed =</span> <span class="dv">2024</span>, <span class="at">print =</span> <span class="cn">FALSE</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 诊断</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(imp_final, <span class="sc">~</span> age <span class="sc">+</span> income)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1046-missing-data_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. 建模与合并</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>fit_final <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    imp_final,</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(disease_score <span class="sc">~</span> age <span class="sc">+</span> sex <span class="sc">+</span> income <span class="sc">+</span> bmi <span class="sc">+</span> cholesterol)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>pooled_final <span class="ot">&lt;-</span> <span class="fu">pool</span>(fit_final)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. 结果报告</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pooled_final) <span class="sc">%&gt;%</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">3</span>),</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">3</span>),</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"["</span>, <span class="fu">round</span>(estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error, <span class="dv">3</span>), <span class="st">", "</span>,</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> std.error, <span class="dv">3</span>), <span class="st">"]"</span></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">p.value =</span> <span class="fu">format.pval</span>(p.value, <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, std.error, <span class="st">`</span><span class="at">95% CI</span><span class="st">`</span>, p.value) <span class="sc">%&gt;%</span></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"多重插补后的回归结果"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>多重插补后的回归结果</caption>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: left;">95% CI</th>
<th style="text-align: left;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-86.697</td>
<td style="text-align: right;">4.789</td>
<td style="text-align: left;">[-96.083, -77.311]</td>
<td style="text-align: left;">&lt; 2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.314</td>
<td style="text-align: right;">0.039</td>
<td style="text-align: left;">[0.238, 0.39]</td>
<td style="text-align: left;">5.96e-15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sex女</td>
<td style="text-align: right;">0.028</td>
<td style="text-align: right;">0.880</td>
<td style="text-align: left;">[-1.697, 1.753]</td>
<td style="text-align: left;">0.974</td>
</tr>
<tr class="even">
<td style="text-align: left;">income</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: left;">[0, 0]</td>
<td style="text-align: left;">0.796</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bmi</td>
<td style="text-align: right;">5.035</td>
<td style="text-align: right;">0.111</td>
<td style="text-align: left;">[4.817, 5.253]</td>
<td style="text-align: left;">&lt; 2e-16</td>
</tr>
<tr class="even">
<td style="text-align: left;">cholesterol</td>
<td style="text-align: right;">-0.010</td>
<td style="text-align: right;">0.013</td>
<td style="text-align: left;">[-0.035, 0.015]</td>
<td style="text-align: left;">0.425</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
</section>
</section>
<section id="代码速查表" class="level2">
<h2 class="anchored" data-anchor-id="代码速查表">代码速查表</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ========== 缺失值处理速查 ==========</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 检测</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df)) <span class="co"># 总缺失数</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(df)) <span class="co"># 每列缺失数</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>naniar<span class="sc">::</span><span class="fu">miss_var_summary</span>(df) <span class="co"># 变量摘要</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>naniar<span class="sc">::</span><span class="fu">miss_case_summary</span>(df) <span class="co"># 样本摘要</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 可视化</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>naniar<span class="sc">::</span><span class="fu">vis_miss</span>(df) <span class="co"># 缺失热图</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>naniar<span class="sc">::</span><span class="fu">gg_miss_upset</span>(df) <span class="co"># UpSet 图</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">aggr</span>(df) <span class="co"># 聚合图</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>VIM<span class="sc">::</span><span class="fu">marginplot</span>(df[<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)]) <span class="co"># 边际图</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a><span class="co"># MCAR 检验</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>naniar<span class="sc">::</span><span class="fu">mcar_test</span>(df)</span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 简单处理</span></span>
<span id="cb94-19"><a href="#cb94-19" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="co"># 删除法</span></span>
<span id="cb94-20"><a href="#cb94-20" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">x =</span> <span class="fu">replace_na</span>(x, <span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))) <span class="co"># 均值填充</span></span>
<span id="cb94-21"><a href="#cb94-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-22"><a href="#cb94-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 多重插补</span></span>
<span id="cb94-23"><a href="#cb94-23" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(df, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">method =</span> <span class="st">"pmm"</span>) <span class="co"># 插补</span></span>
<span id="cb94-24"><a href="#cb94-24" aria-hidden="true" tabindex="-1"></a><span class="fu">complete</span>(imp, <span class="dv">1</span>) <span class="co"># 提取单个数据集</span></span>
<span id="cb94-25"><a href="#cb94-25" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">with</span>(imp, <span class="fu">lm</span>(y <span class="sc">~</span> x)) <span class="co"># 建模</span></span>
<span id="cb94-26"><a href="#cb94-26" aria-hidden="true" tabindex="-1"></a><span class="fu">pool</span>(fit) <span class="co"># 合并结果</span></span>
<span id="cb94-27"><a href="#cb94-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-28"><a href="#cb94-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 随机森林插补</span></span>
<span id="cb94-29"><a href="#cb94-29" aria-hidden="true" tabindex="-1"></a>missRanger<span class="sc">::</span><span class="fu">missRanger</span>(df)</span>
<span id="cb94-30"><a href="#cb94-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-31"><a href="#cb94-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用 finalfit</span></span>
<span id="cb94-32"><a href="#cb94-32" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">missing_pattern</span>(dependent, explanatory)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
</section>
<section id="报告模板" class="level2">
<h2 class="anchored" data-anchor-id="报告模板">报告模板</h2>
<p>在论文中报告缺失值处理：</p>
<blockquote class="blockquote">
<p><strong>缺失数据处理</strong>: 本研究中，收入变量有 X% 的缺失，胆固醇有 Y% 的缺失。Little’s MCAR 检验显示缺失不满足完全随机假设 (χ² = xx, p &lt; 0.05)。我们采用多重插补法 (mice 包，m = 10) 处理缺失数据，使用预测均值匹配法 (PMM) 进行插补。插补后的分布与原始数据分布相似。敏感性分析显示结论在不同 MNAR 假设下保持稳健。</p>
</blockquote>
<hr>
</section>
<section id="总结" class="level2">
<h2 class="anchored" data-anchor-id="总结">总结</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>情况</th>
<th>推荐方法</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>缺失 &lt; 5%，MCAR</td>
<td>删除法可接受</td>
</tr>
<tr class="even">
<td>缺失适中，MAR</td>
<td>多重插补 (mice) ★推荐</td>
</tr>
<tr class="odd">
<td>非线性关系</td>
<td>随机森林插补 (missRanger)</td>
</tr>
<tr class="even">
<td>需要快速预览</td>
<td>均值/中位数填充</td>
</tr>
<tr class="odd">
<td>MNAR 担忧</td>
<td>敏感性分析必做</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>最佳实践</strong>： 1. 始终报告缺失情况 2. 可视化缺失模式 3. 检验 MCAR 假设 4. 多重插补优于单值填充 5. 进行敏感性分析</p>
</blockquote>
<hr>
</section>
<section id="参考资源" class="level2">
<h2 class="anchored" data-anchor-id="参考资源">参考资源</h2>
<ul>
<li><a href="https://amices.org/mice/">mice 包文档</a></li>
<li><a href="https://naniar.njtierney.com/">naniar 包文档</a></li>
<li><a href="https://cran.r-project.org/web/packages/VIM/">VIM 包文档</a></li>
<li>van Buuren S. <em>Flexible Imputation of Missing Data</em> (在线免费书籍)</li>
<li>Little RJA, Rubin DB. <em>Statistical Analysis with Missing Data</em></li>
</ul>


</section>

</main> <!-- /main -->
<!-- Hypothesis 文字划线评论功能 -->

<!-- 用户可以选中任意文字添加批注，所有人都能看到 -->

<script>

    window.hypothesisConfig = function () {

        return {

            branding: {

                appBackgroundColor: 'white',

                ctaBackgroundColor: '#4f46e5',

                ctaTextColor: 'white',

                selectionFontFamily: 'inherit'

            },

            enableExperimentalNewNoteButton: true,

            showHighlights: 'always'

        };

    };

</script>

<script async="" src="https://hypothes.is/embed.js"></script>



<!-- Hypothesis 使用提示 -->

<style>

    .hypothesis-hint {

        position: fixed;

        bottom: 100px;

        right: 20px;

        background: linear-gradient(135deg, #4f46e5, #7c3aed);

        color: white;

        padding: 12px 16px;

        border-radius: 12px;

        font-size: 0.85rem;

        box-shadow: 0 4px 20px rgba(79, 70, 229, 0.3);

        z-index: 999;

        opacity: 0;

        transform: translateY(20px);

        transition: all 0.3s ease;

        pointer-events: none;

        max-width: 200px;

        line-height: 1.4;

    }

    

    .hypothesis-hint.show {

        opacity: 1;

        transform: translateY(0);

    }

    

    .hypothesis-hint::before {

        content: "💡";

        margin-right: 6px;

    }

    

    @media (max-width: 768px) {

        .hypothesis-hint {

            bottom: 80px;

            right: 10px;

            left: 10px;

            max-width: none;

        }

    }

</style>



<div class="hypothesis-hint" id="hypothesis-hint">

    选中文字可以添加批注，与其他读者互动！

</div>



<script>

    // 首次访问时显示提示

    document.addEventListener('DOMContentLoaded', function() {

        const hint = document.getElementById('hypothesis-hint');

        const hintShown = localStorage.getItem('hypothesis_hint_shown');

        

        if (!hintShown && hint) {

            setTimeout(() => {

                hint.classList.add('show');

                setTimeout(() => {

                    hint.classList.remove('show');

                    localStorage.setItem('hypothesis_hint_shown', 'true');

                }, 5000);

            }, 3000);

        }

    });

</script>



<!-- Back to Top Button -->

<button id="back-to-top" aria-label="Back to Top">

    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">

        <path d="M18 15l-6-6-6 6"></path>

    </svg>

</button>



<!-- Floating TOC Button (Mobile Only) -->

<button id="toc-floating-btn" aria-label="Table of Contents">

    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">

        <line x1="8" y1="6" x2="21" y2="6"></line>

        <line x1="8" y1="12" x2="21" y2="12"></line>

        <line x1="8" y1="18" x2="21" y2="18"></line>

        <line x1="3" y1="6" x2="3.01" y2="6"></line>

        <line x1="3" y1="12" x2="3.01" y2="12"></line>

        <line x1="3" y1="18" x2="3.01" y2="18"></line>

    </svg>

</button>



<!-- TOC Modal -->

<div class="toc-modal-overlay">

    <div class="toc-modal-content">

        <div class="toc-modal-header">

            <div class="toc-modal-title">目录</div>

            <button class="toc-modal-close" aria-label="Close">×</button>

        </div>

        <div class="toc-modal-body" id="toc-modal-body">

            <!-- TOC content will be injected here -->

        </div>

    </div>

</div>



<script>

    // Back to Top Logic

    const backToTopBtn = document.getElementById('back-to-top');



    window.addEventListener('scroll', () => {

        if (window.scrollY > 300) {

            backToTopBtn.classList.add('visible');

        } else {

            backToTopBtn.classList.remove('visible');

        }

    });



    backToTopBtn.addEventListener('click', () => {

        window.scrollTo({

            top: 0,

            behavior: 'smooth'

        });

    });



    // Mobile Table Scrolling Logic

    document.addEventListener("DOMContentLoaded", function () {

        const tables = document.querySelectorAll('table');

        tables.forEach(table => {

            if (!table.parentElement.classList.contains('table-responsive')) {

                const wrapper = document.createElement('div');

                wrapper.className = 'table-responsive';

                wrapper.style.overflowX = 'auto'; // Force scroll

                table.parentNode.insertBefore(wrapper, table);

                wrapper.appendChild(table);

            }

        });



        // Floating TOC Logic

        const tocBtn = document.getElementById('toc-floating-btn');

        const tocOverlay = document.querySelector('.toc-modal-overlay');

        const tocClose = document.querySelector('.toc-modal-close');

        const tocBody = document.getElementById('toc-modal-body');

        const originalToc = document.getElementById('TOC');



        if (originalToc && tocBtn) {

            // Check if TOC has content

            const tocLinks = originalToc.querySelectorAll('a');

            if (tocLinks.length > 0) {

                tocBtn.style.display = 'flex';



                // Function to populate modal

                const populateToc = () => {

                    tocBody.innerHTML = '';

                    const tocClone = originalToc.querySelector('ul').cloneNode(true);

                    tocBody.appendChild(tocClone);



                    // Add click listeners to close modal on link click

                    tocBody.querySelectorAll('a').forEach(link => {

                        link.addEventListener('click', () => {

                            tocOverlay.classList.remove('active');

                            // Smooth scroll to target (handled by browser usually, but ensure modal closes first)

                        });

                    });

                };



                tocBtn.addEventListener('click', () => {

                    populateToc();

                    tocOverlay.classList.add('active');

                });



                tocClose.addEventListener('click', () => {

                    tocOverlay.classList.remove('active');

                });



                tocOverlay.addEventListener('click', (e) => {

                    if (e.target === tocOverlay) {

                        tocOverlay.classList.remove('active');

                    }

                });

            } else {

                tocBtn.style.display = 'none';

            }

        } else if (tocBtn) {

            tocBtn.style.display = 'none';

        }



        // Article Footer Random Recommendation

        // Only run on article pages (has sidebar and main content)

        const sidebar = document.querySelector('#quarto-sidebar') || document.querySelector('.sidebar');

        const mainContent = document.querySelector('main');



        if (sidebar && mainContent) {

            const links = Array.from(sidebar.querySelectorAll('a.sidebar-item-text'));



            // If no links found with specific class, try generic anchor in sidebar

            const allLinks = links.length > 0 ? links : Array.from(sidebar.querySelectorAll('a'));



            // Filter out section headers if they are just toggles (usually href is # or empty)

            const validLinks = allLinks.filter(a => a.href && !a.href.endsWith('#') && !a.href.includes('javascript:'));



            // Article Footer Navigation (Prev/Next + Random)

            const currentUrl = window.location.href.split('#')[0];

            let currentIndex = -1;



            // Find current article index

            for (let i = 0; i < validLinks.length; i++) {

                if (validLinks[i].href.split('#')[0] === currentUrl) {

                    currentIndex = i;

                    break;

                }

            }



            // Create Container

            const footerNav = document.createElement('div');

            footerNav.className = 'article-footer-nav-container';

            footerNav.style.marginTop = '4rem';

            footerNav.style.paddingTop = '2rem';

            footerNav.style.borderTop = '1px solid #e5e7eb';



            // 1. Prev/Next Navigation

            if (currentIndex !== -1) {

                let navHtml = '<div class="article-footer-nav">';



                // Previous

                if (currentIndex > 0) {

                    const prevLink = validLinks[currentIndex - 1];

                    const prevTitle = prevLink.innerText.trim();

                    navHtml += `

                        <a href="${prevLink.href}" class="article-nav-link">

                            <span class="nav-label">上一篇</span>

                            <span class="nav-title">« ${prevTitle}</span>

                        </a>

                    `;

                } else {

                    navHtml += `<div></div>`;

                }



                // Next

                if (currentIndex < validLinks.length - 1) {

                    const nextLink = validLinks[currentIndex + 1];

                    const nextTitle = nextLink.innerText.trim();

                    navHtml += `

                        <a href="${nextLink.href}" class="article-nav-link" style="text-align: right;">

                            <span class="nav-label">下一篇</span>

                            <span class="nav-title">${nextTitle} »</span>

                        </a>

                    `;

                } else {

                    navHtml += `<div></div>`;

                }



                navHtml += '</div>';



                // Append Prev/Next HTML

                const navDiv = document.createElement('div');

                navDiv.innerHTML = navHtml;

                footerNav.appendChild(navDiv);

            }



            // 2. Random Recommendation

            const otherLinks = validLinks.filter((_, idx) => idx !== currentIndex);

            if (otherLinks.length > 0) {

                const randomIdx = Math.floor(Math.random() * otherLinks.length);

                const randomLink = otherLinks[randomIdx];

                const randomTitle = randomLink.innerText.trim(); // Use innerText for title



                if (randomTitle) {

                    const randomDiv = document.createElement('div');

                    randomDiv.innerHTML = `

                        <div class="random-recommendation">

                            <h4>👋 随便看看</h4>

                            <p>探索更多 R 语言精彩内容</p>

                            <a href="${randomLink.href}" class="random-btn">

                                🎲 ${randomTitle}

                            </a>

                        </div>

                    `;

                    footerNav.appendChild(randomDiv);

                }

            }



            mainContent.appendChild(footerNav);

        }

    });

</script>



<!-- Like Button Styles -->

<style>

    .article-like-container {

        display: flex;

        justify-content: flex-start;

        margin: 1.5rem 0 2rem 0;

        padding: 0;

    }



    .like-wrapper {

        display: flex;

        flex-direction: column;

        align-items: flex-start;

        gap: 0.4rem;

    }



    .like-btn {

        display: inline-flex;

        align-items: center;

        gap: 0.5rem;

        padding: 0.6rem 1.2rem;

        border: 2px solid #e5e7eb;

        border-radius: 50px;

        background: white;

        color: #6b7280;

        font-size: 0.95rem;

        font-weight: 500;

        cursor: pointer;

        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);

        user-select: none;

    }



    .like-btn:hover {

        border-color: #f472b6;

        color: #ec4899;

        background: #fdf2f8;

    }



    .like-btn.liked {

        border-color: #ec4899;

        color: #ec4899;

        background: #fdf2f8;

    }



    .like-btn.pop {

        animation: pop-animation 0.3s ease;

    }



    @keyframes pop-animation {

        0% {

            transform: scale(1);

        }



        50% {

            transform: scale(1.15);

        }



        100% {

            transform: scale(1);

        }

    }



    .like-icon {

        width: 20px;

        height: 20px;

        transition: transform 0.2s;

    }



    .like-btn:hover .like-icon {

        transform: scale(1.1);

    }



    .like-icon .heart-outline {

        fill: none;

        stroke: currentColor;

        stroke-width: 2;

    }



    .like-icon .heart-fill {

        fill: currentColor;

        opacity: 0;

        transition: opacity 0.2s;

    }



    .like-btn.liked .heart-fill {

        opacity: 1;

    }



    .like-btn.liked .heart-outline {

        stroke: none;

    }



    .like-text {

        font-size: 0.9rem;

    }



    .like-count {

        font-size: 0.85rem;

        min-width: 1rem;

        text-align: center;

    }



    .like-hint {

        font-size: 0.75rem;

        color: #9ca3af;

        padding-left: 0.25rem;

    }



    /* Mobile optimization */

    @media (max-width: 768px) {

        .article-like-container {

            margin: 1rem 0 1.5rem 0;

        }



        .like-btn {

            padding: 0.5rem 1rem;

            font-size: 0.9rem;

        }



        .like-icon {

            width: 18px;

            height: 18px;

        }

    }

</style>



<!-- Like Section Script with Supabase Backend -->

<script>

    // Supabase Configuration

    const SUPABASE_URL = 'https://zyfdzyifhvglibpganxt.supabase.co';

    const SUPABASE_ANON_KEY = 'sb_publishable_XhaP4hFZ30sHZybEjVRQxg_iwlPTxz8';



    document.addEventListener('DOMContentLoaded', async function () {

        const mainContent = document.querySelector('main');



        // Only show on article pages (not index, not sections)

        const isArticlePage = !window.location.pathname.includes('index.html') &&

            !window.location.pathname.includes('sections/') &&

            !window.location.pathname.endsWith('/');



        if (!isArticlePage || !mainContent) return;



        const articleId = window.location.pathname.replace(/[^a-zA-Z0-9]/g, '_');

        const likeKey = `article_like_${articleId}`; // localStorage key for current user's like state



        // Create Like Section (at page bottom)

        const likeSection = document.createElement('div');

        likeSection.className = 'article-like-section';



        // Initial state from localStorage (for immediate UI feedback)

        const isLiked = localStorage.getItem(likeKey) === 'true';

        let likeCount = 0;



        likeSection.innerHTML = `

            <div class="like-section-inner">

                <p class="like-prompt">觉得有帮助？点赞支持一下 👇</p>

                <button class="like-btn ${isLiked ? 'liked' : ''}" id="article-like-btn" aria-label="点赞">

                    <svg class="like-icon" viewBox="0 0 24 24" width="24" height="24">

                        <path class="heart-outline" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>

                        <path class="heart-fill" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>

                    </svg>

                    <span class="like-text">${isLiked ? '已喜欢' : '喜欢这篇文章'}</span>

                    <span class="like-count" id="like-count"><span class="loading-dots">...</span></span>

                </button>

            </div>

        `;



        mainContent.appendChild(likeSection);



        const likeBtn = document.getElementById('article-like-btn');

        const likeCountSpan = document.getElementById('like-count');

        const likeText = likeBtn.querySelector('.like-text');



        // Supabase API helper

        async function supabaseRequest(method, endpoint, body = null) {

            const options = {

                method: method,

                headers: {

                    'apikey': SUPABASE_ANON_KEY,

                    'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,

                    'Content-Type': 'application/json',

                    'Prefer': method === 'POST' ? 'return=representation' : 'return=minimal'

                }

            };

            if (body) options.body = JSON.stringify(body);



            try {

                const response = await fetch(`${SUPABASE_URL}/rest/v1/${endpoint}`, options);

                if (!response.ok) throw new Error(`HTTP ${response.status}`);

                const text = await response.text();

                return text ? JSON.parse(text) : null;

            } catch (error) {

                console.error('Supabase error:', error);

                return null;

            }

        }



        // Fetch current like count from Supabase

        async function fetchLikeCount() {

            const data = await supabaseRequest('GET', `article_likes?article_id=eq.${articleId}&select=like_count`);

            if (data && data.length > 0) {

                return data[0].like_count;

            }

            return 0;

        }



        // Update like count in Supabase

        async function updateLikeCount(newCount) {

            // Try to update existing record

            const existing = await supabaseRequest('GET', `article_likes?article_id=eq.${articleId}&select=id`);



            if (existing && existing.length > 0) {

                // Update existing

                await supabaseRequest('PATCH', `article_likes?article_id=eq.${articleId}`, {

                    like_count: newCount

                });

            } else {

                // Insert new record

                await supabaseRequest('POST', 'article_likes', {

                    article_id: articleId,

                    like_count: newCount

                });

            }

        }



        // Load initial like count

        try {

            likeCount = await fetchLikeCount();

            likeCountSpan.textContent = likeCount > 0 ? likeCount : '';

        } catch (e) {

            console.error('Failed to fetch likes:', e);

            likeCountSpan.textContent = '';

        }



        // Like button click handler

        likeBtn.addEventListener('click', async function () {

            const currentlyLiked = this.classList.contains('liked');



            // Optimistic UI update

            if (currentlyLiked) {

                this.classList.remove('liked');

                likeCount = Math.max(0, likeCount - 1);

                likeText.textContent = '喜欢这篇文章';

                localStorage.setItem(likeKey, 'false');

            } else {

                this.classList.add('liked');

                likeCount++;

                likeText.textContent = '已喜欢';

                localStorage.setItem(likeKey, 'true');



                this.classList.add('pop');

                setTimeout(() => this.classList.remove('pop'), 300);

            }



            likeCountSpan.textContent = likeCount > 0 ? likeCount : '';



            // Sync with Supabase in background

            try {

                await updateLikeCount(likeCount);

            } catch (e) {

                console.error('Failed to sync like:', e);

            }

        });



        // ============================================

        // Comment Section with Supabase

        // ============================================



        // Create comment section HTML

        const commentSection = document.createElement('div');

        commentSection.className = 'comment-section';

        commentSection.innerHTML = `

            <h4 class="comment-title">💬 评论区</h4>

            <div class="comment-form">

                <input type="text" id="comment-nickname" class="comment-nickname" placeholder="昵称（可选）" maxlength="20">

                <textarea id="comment-content" class="comment-textarea" placeholder="写下你的想法..." maxlength="500" rows="3"></textarea>

                <div class="comment-form-footer">

                    <span class="char-count"><span id="char-count">0</span>/500</span>

                    <button id="submit-comment" class="comment-submit-btn">发表评论</button>

                </div>

            </div>

            <div id="comment-list" class="comment-list">

                <div class="loading-comments">加载评论中...</div>

            </div>

        `;



        // Append comment section after like section

        const likeSectionEl = document.querySelector('.article-like-section');

        if (likeSectionEl) {

            likeSectionEl.after(commentSection);

        } else {

            mainContent.appendChild(commentSection);

        }



        const commentNickname = document.getElementById('comment-nickname');

        const commentContent = document.getElementById('comment-content');

        const submitBtn = document.getElementById('submit-comment');

        const commentList = document.getElementById('comment-list');

        const charCount = document.getElementById('char-count');



        // Visitor ID for identifying own comments

        let visitorId = localStorage.getItem('visitor_id');

        if (!visitorId) {

            visitorId = 'v_' + Math.random().toString(36).substr(2, 9) + Date.now().toString(36);

            localStorage.setItem('visitor_id', visitorId);

        }



        // Character counter

        commentContent.addEventListener('input', () => {

            charCount.textContent = commentContent.value.length;

        });



        // Format time helper

        function formatTime(timestamp) {

            const date = new Date(timestamp);

            const now = new Date();

            const diff = now - date;



            if (diff < 60000) return '刚刚';

            if (diff < 3600000) return Math.floor(diff / 60000) + ' 分钟前';

            if (diff < 86400000) return Math.floor(diff / 3600000) + ' 小时前';

            if (diff < 604800000) return Math.floor(diff / 86400000) + ' 天前';



            return date.toLocaleDateString('zh-CN');

        }



        // Escape HTML to prevent XSS

        function escapeHtml(text) {

            const div = document.createElement('div');

            div.textContent = text;

            return div.innerHTML;

        }



        // Fetch comments from Supabase

        async function fetchComments() {

            const data = await supabaseRequest('GET', `article_comments?article_id=eq.${articleId}&order=created_at.desc`);

            return data || [];

        }



        // Post new comment

        async function postComment(nickname, content) {

            return await supabaseRequest('POST', 'article_comments', {

                article_id: articleId,

                nickname: nickname || '匿名用户',

                content: content,

                visitor_id: visitorId

            });

        }



        // Delete comment

        async function deleteComment(commentId) {

            await supabaseRequest('DELETE', `article_comments?id=eq.${commentId}&visitor_id=eq.${visitorId}`);

        }



        // Render comments

        function renderComments(comments) {

            if (!comments || comments.length === 0) {

                commentList.innerHTML = '<div class="no-comments">暂无评论，来做第一个留言的人吧 🎉</div>';

                return;

            }



            commentList.innerHTML = comments.map(c => `

                <div class="comment-item" data-id="${c.id}">

                    <div class="comment-header">

                        <span class="comment-author">${escapeHtml(c.nickname || '匿名用户')}</span>

                        <span class="comment-time">${formatTime(c.created_at)}</span>

                        ${c.visitor_id === visitorId ? `<button class="comment-delete" data-id="${c.id}">删除</button>` : ''}

                    </div>

                    <div class="comment-body">${escapeHtml(c.content)}</div>

                </div>

            `).join('');



            // Add delete handlers

            commentList.querySelectorAll('.comment-delete').forEach(btn => {

                btn.addEventListener('click', async function () {

                    const id = this.dataset.id;

                    await deleteComment(id);

                    loadComments();

                });

            });

        }



        // Load and display comments

        async function loadComments() {

            try {

                const comments = await fetchComments();

                renderComments(comments);

            } catch (e) {

                console.error('Failed to load comments:', e);

                commentList.innerHTML = '<div class="no-comments">加载评论失败</div>';

            }

        }



        // Submit comment handler

        submitBtn.addEventListener('click', async function () {

            const content = commentContent.value.trim();

            if (!content) {

                alert('请输入评论内容');

                return;

            }



            submitBtn.disabled = true;

            submitBtn.textContent = '发送中...';



            try {

                await postComment(commentNickname.value.trim(), content);

                commentContent.value = '';

                charCount.textContent = '0';

                await loadComments();

            } catch (e) {

                console.error('Failed to post comment:', e);

                alert('评论发送失败，请重试');

            }



            submitBtn.disabled = false;

            submitBtn.textContent = '发表评论';

        });



        // Initial load

        loadComments();

    });

</script>



<!-- Interaction Section Styles -->

<style>

    .article-interaction-section {

        margin-top: 3rem;

        padding-top: 2rem;

        border-top: 2px solid #e5e7eb;

    }



    .interaction-header {

        text-align: center;

        margin-bottom: 2rem;

    }



    .interaction-header h3 {

        font-size: 1.4rem;

        color: #1f2937;

        margin: 0 0 0.5rem 0;

    }



    .interaction-header p {

        color: #6b7280;

        font-size: 0.95rem;

        margin: 0;

    }



    /* Like Section at Bottom */

    .article-like-section {

        margin-top: 3rem;

        padding: 2rem 0;

        border-top: 2px solid #e5e7eb;

        text-align: center;

    }



    .like-section-inner {

        display: flex;

        flex-direction: column;

        align-items: center;

        gap: 1rem;

    }



    .like-prompt {

        color: #6b7280;

        font-size: 0.95rem;

        margin: 0;

    }



    .article-like-section .like-btn {

        padding: 0.75rem 2rem;

        font-size: 1rem;

    }



    .article-like-section .like-icon {

        width: 22px;

        height: 22px;

    }



    /* Mobile */

    @media (max-width: 768px) {

        .article-like-section {

            margin-top: 2rem;

            padding: 1.5rem 0;

        }



        .like-prompt {

            font-size: 0.9rem;

        }

    }



    /* Comment Section */

    .comment-section {

        margin-top: 2rem;

        padding: 1.5rem;

        background: #f9fafb;

        border-radius: 12px;

    }



    .comment-title {

        font-size: 1.1rem;

        color: #1f2937;

        margin: 0 0 1rem 0;

    }



    .comment-form {

        margin-bottom: 1.5rem;

    }



    .comment-nickname {

        width: 200px;

        padding: 0.5rem 0.75rem;

        border: 1px solid #e5e7eb;

        border-radius: 8px;

        font-size: 0.9rem;

        margin-bottom: 0.75rem;

        background: white;

    }



    .comment-textarea {

        width: 100%;

        padding: 0.75rem;

        border: 1px solid #e5e7eb;

        border-radius: 8px;

        font-size: 0.95rem;

        resize: vertical;

        min-height: 80px;

        background: white;

        font-family: inherit;

        box-sizing: border-box;

        margin-bottom: 0.5rem;

    }



    .comment-nickname:focus,

    .comment-textarea:focus {

        outline: none;

        border-color: #4f46e5;

        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);

    }



    .comment-form-footer {

        display: flex;

        justify-content: space-between;

        align-items: center;

    }



    .char-count {

        font-size: 0.8rem;

        color: #9ca3af;

    }



    .comment-submit-btn {

        padding: 0.6rem 1.5rem;

        background: #4f46e5;

        color: white;

        border: none;

        border-radius: 8px;

        font-size: 0.9rem;

        font-weight: 500;

        cursor: pointer;

        transition: all 0.2s;

    }



    .comment-submit-btn:hover:not(:disabled) {

        background: #4338ca;

        transform: translateY(-1px);

    }



    .comment-submit-btn:disabled {

        opacity: 0.6;

        cursor: not-allowed;

    }



    .comment-list {

        margin-top: 1rem;

    }



    .loading-comments,

    .no-comments {

        text-align: center;

        color: #9ca3af;

        padding: 1.5rem;

        font-size: 0.95rem;

    }



    .comment-item {

        background: white;

        border-radius: 8px;

        padding: 1rem;

        margin-bottom: 0.75rem;

        border: 1px solid #e5e7eb;

    }



    .comment-header {

        display: flex;

        align-items: center;

        gap: 0.75rem;

        margin-bottom: 0.5rem;

    }



    .comment-author {

        font-weight: 600;

        color: #1f2937;

        font-size: 0.9rem;

    }



    .comment-time {

        font-size: 0.8rem;

        color: #9ca3af;

    }



    .comment-delete {

        margin-left: auto;

        background: none;

        border: none;

        color: #ef4444;

        font-size: 0.8rem;

        cursor: pointer;

        padding: 0.2rem 0.5rem;

        border-radius: 4px;

    }



    .comment-delete:hover {

        background: #fef2f2;

    }



    .comment-body {

        color: #374151;

        font-size: 0.95rem;

        line-height: 1.6;

        white-space: pre-wrap;

        word-break: break-word;

    }



    /* Mobile Comment Styles */

    @media (max-width: 768px) {

        .comment-section {

            padding: 1rem;

        }



        .comment-nickname {

            width: 100%;

        }



        .comment-title {

            font-size: 1rem;

        }

    }

</style>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Made with <a href="https://quarto.org/">Quarto</a> | © 2024-2026</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>