{
  "hash": "9e6d203fcca974520cabae7936990489",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"伞状综述 (Umbrella Review) 完全指南\"\ndate: \"2026-01-12\"\ncategories: [R包, Meta分析, 综述方法]\n\ndescription: \"从数据准备到证据分级，使用 R 语言 metaumbrella 包进行伞状综述的全流程教学。\"\n---\n\n\n\n## 1. 什么是伞状综述？\n\n**伞状综述 (Umbrella Review)**，也称为系统评价的系统评价 (Review of Reviews)，处于循证医学证据金字塔的顶端。\n\n传统的 **Meta 分析** 整合了多个独立研究的结果，而 **伞状综述** 则整合了针对同一主题（或广泛主题）的多个 Meta 分析结果。\n\n### 为什么需要它？\n-   **解决矛盾**：当不同的 Meta 分析得出不一致的结论时。\n-   **全面概览**：提供比单一 Meta 分析更广阔的视野（例如，“体育锻炼对**所有**健康结局的影响”）。\n-   **证据分级**：不仅关注是否显著，更关注证据的**可信度**和**强度**。\n\n## 2. 工具介绍：metaumbrella\n\n在 R 语言中，`metaumbrella` 是目前最全面的伞状综述自动化工具。它能够：\n-   自动计算效应量（OR, RR, HR, Mean Difference 等）。\n-   进行异质性检验 (I^2^)。\n-   检测小样本效应 (Egger's test)。\n-   计算超额显著性偏差 (Excess Significance Bias)。\n-   **基于 Ioannidis 等标准自动进行证据分级**。\n\n### 安装\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"metaumbrella\")\ninstall.packages(\"ggplot2\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(metaumbrella)\nlibrary(ggplot2)\n```\n:::\n\n\n## 3. 数据准备\n\n进行伞状综述，数据通常来源于已发表的 Meta 分析文章。我们需要整理出一个标准的数据框。\n\n我们使用包中自带的数据集 `df.OR` 作为示例。这是一个关于**基因多态性与疾病风险**的 Meta 分析集合。\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"df.OR\")\n# 查看数据结构的前几行\nhead(df.OR)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  meta_review factor   author year measure    value     ci_lo    ci_up n_cases\n1     Dalager   ADHD   Burris 1995      OR 2.647059 1.3884096 5.046724     117\n2     Dalager   ADHD  Talbott 2016      OR 1.127907 0.6032607 2.108830     111\n3     Dalager   ADHD al-Mussa 1989      OR 2.229465 1.2235551 4.062356      95\n4     Dalager   ADHD  al-Rauf 2011      OR 1.102941 0.5622246 2.163689      93\n5     Dalager   ADHD     Rand 2015      OR 0.937500 0.5154349 1.705174     100\n6     Dalager   ADHD    Prawl 1999      OR 1.177885 0.6400561 2.167641      90\n  n_controls n_exp n_nexp n_cases_exp n_cases_nexp n_controls_exp\n1        107    56    168          39           78             17\n2        122    50    183          25           86             25\n3        121    62    154          36           59             26\n4         84    46    131          25           68             21\n5        102    62    140          30           70             32\n6        130    57    163          25           65             32\n  n_controls_nexp\n1              90\n2              97\n3              95\n4              63\n5              70\n6              98\n```\n\n\n:::\n:::\n\n\n### 数据字段说明\n通常需要以下关键列：\n-   `meta_review`:  所属的 Meta 分析或因素名称（如 \"Gene A vs Disease\"）。\n-   `author`: 纳入的原始研究第一作者。\n-   `year`: 发表年份。\n-   `n_cases_exp`, `n_cases_nexp`: 病例组的暴露/非暴露人数。\n-   `n_controls_exp`, `n_controls_nexp`: 对照组的暴露/非暴露人数。\n\n> [!TIP]\n> 如果你的数据是连续变量（均值差），则需要 `n_group1`, `mean_group1`, `sd_group1` 等列。\n\n## 4. 核心分析：umbrella()\n\n`umbrella()` 函数是该包的核心，它一次性完成所有统计工作。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 执行伞状综述分析\n# method.var = \"REML\" 推荐使用限制性极大似然法估计异质性\numb.results <- umbrella(df.OR, method.var = \"REML\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalyzing factor: ADHD \nAnalyzing factor: ASD \nAnalyzing factor: dyslexia \nAnalyzing factor: ID \n```\n\n\n:::\n:::\n\n\n这个对象包含了大量信息，包括每个因素的汇总效应量、95% 置信区间、p 值、I2 统计量、Egger 检验结果等。\n\n## 5. 证据分级 (Evidence Stratification)\n\n这是伞状综述最关键的一步。我们不仅仅看 P 值是否小于 0.05，还要看证据是否“稳健”。通常使用 Ioannidis (2011) 的标准。\n\n**Ioannidis 分级标准通常包括：**\n-   **Class I (Convincing)**: P < 10^-6^, I2 < 50%, 无小样本效应, 样本量充足 (>1000例或>10%研究), 95%预测区间不包含无效值。\n-   **Class II (Highly Suggestive)**: P < 10^-6^, 最大研究显著, 但可能存在一定异质性。\n-   **Class III (Suggestive)**: P < 10^-3^.\n-   **Class IV (Weak)**: P < 0.05.\n-   **ns**: P > 0.05.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 依据 \"Ioannidis\" 标准进行分级\nevid.res <- add.evidence(umb.results, criteria = \"Ioannidis\")\n\n# 查看针对每个因素的分级结果\nsummary(evid.res)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Factor  Criteria Class measure value       value_CI    eG           eG_CI\n1     ADHD Ioannidis    IV      OR 1.526 [1.043, 2.231] 0.233  [0.023, 0.443]\n3 dyslexia Ioannidis    IV      OR 1.498 [1.004, 2.236] 0.223  [0.002, 0.444]\n4       ID Ioannidis    IV      OR 1.355 [1.078, 1.703] 0.167  [0.041, 0.293]\n2      ASD Ioannidis    ns      OR 1.020 [0.778, 1.339] 0.011 [-0.139, 0.161]\n    eOR         eOR_CI  p_value n_studies n_cases n_controls           PI_eG\n1 1.526 [1.043, 2.231] 2.94e-02        10     987       1120 [-0.456, 0.922]\n3 1.498 [1.004, 2.236] 4.80e-02         7     626        656 [-0.409, 0.855]\n4 1.355 [1.078, 1.703] 9.21e-03        25    2586       2653 [-0.393, 0.727]\n2 1.020 [0.778, 1.339] 8.84e-01        18    1967       1872 [-0.572, 0.594]\n          PI_eOR PI_sign     I2  egger_p egger_sign    ESB_p ESB_sign\n1 [0.437, 5.327]    null 70.886 4.84e-01         ns 3.75e-01       ns\n3 [0.476, 4.714]    null 60.556 2.29e-01         ns 5.47e-01       ns\n4 [0.491, 3.741]    null 67.231 6.00e-01         ns 4.61e-01       ns\n2 [0.354, 2.939]    null 67.742 5.06e-01         ns 1.68e-01       ns\n    largest_CI_eG largest_CI_eOR largest_sign\n1 [-0.354, 0.376] [0.527, 1.978]         null\n3   [0.026, 0.72] [1.048, 3.692]      notnull\n4  [-0.06, 0.597] [0.897, 2.952]         null\n2 [-0.569, 0.198] [0.356, 1.433]         null\n```\n\n\n:::\n:::\n\n\n## 6. 结果可视化\n\n一张清晰的森林图可以展示所有因素的证据等级。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 绘制分层证据图\n# print_score = TRUE 显示具体证据得分（可选）\nchart <- forest(evid.res,\n    print_score = FALSE,\n    layout = \"JAMA\"\n) # 使用 JAMA 风格布局\n```\n\n::: {.cell-output-display}\n![](1029-umbrella-review_files/figure-html/unnamed-chunk-6-1.png){width=3000}\n:::\n:::\n\n\n**图形解读：**\n-   纵轴列出了所有分析的因素。\n-   点的颜色或形状代表了证据等级（Class I - IV）。\n-   横轴通常是效应量（如 OR 值）。\n-   你可以一眼看出哪些因素具有**确凿 (Convincing)** 的证据支持。\n\n## 7. 导出结果\n\n分析完成后，我们通常需要将详细的统计指标导出到 Excel 或 CSV 中制作表格。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 提取汇总表\nresults_table <- summary(evid.res)\n\n# 仅展示前几列重要信息\nknitr::kable(head(results_table[, c(\"Factor\", \"Class\", \"eOR\", \"p_value\", \"egger_p\", \"I2\")]))\n```\n\n::: {.cell-output-display}\n\n\n|   |Factor   |Class |   eOR|p_value  |egger_p  |     I2|\n|:--|:--------|:-----|-----:|:--------|:--------|------:|\n|1  |ADHD     |IV    | 1.526|2.94e-02 |4.84e-01 | 70.886|\n|3  |dyslexia |IV    | 1.498|4.80e-02 |2.29e-01 | 60.556|\n|4  |ID       |IV    | 1.355|9.21e-03 |6.00e-01 | 67.231|\n|2  |ASD      |ns    | 1.020|8.84e-01 |5.06e-01 | 67.742|\n\n\n:::\n:::\n\n\n## 8. 总结\n\n通过 `metaumbrella`，我们可以快速完成复杂的证据整合工作。一个高质量的伞状综述应该：\n1.  **全面检索**：确保没有遗漏重要的 Meta 分析。\n2.  **严格清洗**：数据提取必须准确。\n3.  **多维评估**：不仅看效应量，更要看异质性和发表偏倚。\n4.  **清晰呈现**：使用分级图展示证据强度。\n\n## 参考文献\n\n-   Ioannidis, J. P. (2009). Integration of evidence from multiple meta-analyses: a primer on umbrella reviews, treatment networks and multiple treatments meta-analyses. *CMAJ*.\n-   Balduzzi, S., et al. (2023). metaumbrella: An R Package for Conducting Umbrella Reviews.\n",
    "supporting": [
      "1029-umbrella-review_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}