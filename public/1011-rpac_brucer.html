<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-01-10">

<title>bruceR - 统计分析工具 – R 语言学习笔记</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-374967827064a263f620006ef06629b3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R 语言学习笔记</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">主页</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sections/packages.html"> 
<span class="menu-text">实用 R 包</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sections/visualization.html"> 
<span class="menu-text">可视化教程</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sections/methods.html"> 
<span class="menu-text">R 语言方法</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./sections/operation.html"> 
<span class="menu-text">实用操作</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/KangWang42/R_note_for_Epidemiology"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1011-rpac_brucer.html">实用 R 包</a></li><li class="breadcrumb-item"><a href="./1011-rpac_brucer.html">bruceR - 统计分析工具</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">实用 R 包</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1011-rpac_brucer.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">bruceR - 统计分析工具</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1012-comparegroups.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">compareGroups - 描述性表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1013-scitb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">scitb - 快速基线表</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1014-purrr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">purrr - 函数式编程</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">可视化教程</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2021-cowplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">cowplot - 图形组合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2018-tidyplots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">tidyplots - 极简可视化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2017-ggtext.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ggtext - 中英文字体混合</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2019-dualaxis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双坐标轴</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2011-viscolor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">配色方案</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2012-patchwork.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">patchwork - 图片拼接</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2013-legend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">图例自定义</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2014-sankey.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">桑基图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2015-map.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">地图绑制</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2016-forestplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">森林图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2022-ggally.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GGally - 可视化扩展</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2023-radar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">雷达图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2024-venn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">韦恩图</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">R 语言方法</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1015-health-economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">卫生经济学分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1017-timeseries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">时间序列分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1018-psm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">倾向性得分匹配</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1019-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic 回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1020-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">生存分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1021-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多元线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1022-meta-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meta 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1023-mediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">中介效应分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1024-multilevel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">多水平模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1025-gam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">广义加性模型 (GAM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1026-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson/负二项回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1027-rcs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">限制性立方样条 (RCS)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1028-did.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">双重差分法 (DiD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1029-umbrella-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">伞状综述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1030-qualitative-research.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">质性研究与文本挖掘</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1031-lca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">潜类别分析 (LCA)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1032-sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">结构方程模型 (SEM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1033-dlnm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">分布滞后非线性模型 (DLNM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1034-nvmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">变分模态分解 (VMD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1035-fft-nvmd-gmm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FFT + VMD + GMM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1036-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">方差分析 (ANOVA)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">实用操作</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3001-imports.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数据导入导出</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0011-rmarkdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMarkdown 入门</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0012-quarto-vs-rmd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto vs RMarkdown</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0013-positron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Positron IDE 教程</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">目录</h2>
   
  <ul>
  <li><a href="#r包介绍" id="toc-r包介绍" class="nav-link active" data-scroll-target="#r包介绍">R包介绍</a>
  <ul class="collapse">
  <li><a href="#核心功能" id="toc-核心功能" class="nav-link" data-scroll-target="#核心功能">核心功能</a></li>
  <li><a href="#依赖包自动加载" id="toc-依赖包自动加载" class="nav-link" data-scroll-target="#依赖包自动加载">依赖包自动加载</a></li>
  </ul></li>
  <li><a href="#r包安装" id="toc-r包安装" class="nav-link" data-scroll-target="#r包安装">R包安装</a></li>
  <li><a href="#基础编程功能" id="toc-基础编程功能" class="nav-link" data-scroll-target="#基础编程功能">基础编程功能</a>
  <ul class="collapse">
  <li><a href="#set.wd智能设置工作目录" id="toc-set.wd智能设置工作目录" class="nav-link" data-scroll-target="#set.wd智能设置工作目录">set.wd()：智能设置工作目录</a></li>
  <li><a href="#import-export万能数据导入导出" id="toc-import-export万能数据导入导出" class="nav-link" data-scroll-target="#import-export万能数据导入导出">import() / export()：万能数据导入导出</a></li>
  <li><a href="#cc快速创建字符向量" id="toc-cc快速创建字符向量" class="nav-link" data-scroll-target="#cc快速创建字符向量">cc()：快速创建字符向量</a></li>
  <li><a href="#print_table生成三线表" id="toc-print_table生成三线表" class="nav-link" data-scroll-target="#print_table生成三线表">print_table()：生成三线表</a></li>
  </ul></li>
  <li><a href="#数据计算功能" id="toc-数据计算功能" class="nav-link" data-scroll-target="#数据计算功能">数据计算功能</a>
  <ul class="collapse">
  <li><a href="#mean-sum横向计算支持反向计分" id="toc-mean-sum横向计算支持反向计分" class="nav-link" data-scroll-target="#mean-sum横向计算支持反向计分">MEAN() / SUM()：横向计算（支持反向计分）</a></li>
  <li><a href="#recode变量重编码" id="toc-recode变量重编码" class="nav-link" data-scroll-target="#recode变量重编码">RECODE()：变量重编码</a></li>
  <li><a href="#rescale变量标准化" id="toc-rescale变量标准化" class="nav-link" data-scroll-target="#rescale变量标准化">RESCALE()：变量标准化</a></li>
  </ul></li>
  <li><a href="#信度与因子分析" id="toc-信度与因子分析" class="nav-link" data-scroll-target="#信度与因子分析">信度与因子分析</a>
  <ul class="collapse">
  <li><a href="#alpha信度分析" id="toc-alpha信度分析" class="nav-link" data-scroll-target="#alpha信度分析">Alpha()：信度分析</a></li>
  <li><a href="#efa探索性因子分析" id="toc-efa探索性因子分析" class="nav-link" data-scroll-target="#efa探索性因子分析">EFA()：探索性因子分析</a></li>
  </ul></li>
  <li><a href="#描述统计与相关分析" id="toc-描述统计与相关分析" class="nav-link" data-scroll-target="#描述统计与相关分析">描述统计与相关分析</a>
  <ul class="collapse">
  <li><a href="#describe描述统计" id="toc-describe描述统计" class="nav-link" data-scroll-target="#describe描述统计">Describe()：描述统计</a></li>
  <li><a href="#freq频率分析" id="toc-freq频率分析" class="nav-link" data-scroll-target="#freq频率分析">Freq()：频率分析</a></li>
  <li><a href="#corr相关分析" id="toc-corr相关分析" class="nav-link" data-scroll-target="#corr相关分析">Corr()：相关分析</a></li>
  </ul></li>
  <li><a href="#统计检验" id="toc-统计检验" class="nav-link" data-scroll-target="#统计检验">统计检验</a>
  <ul class="collapse">
  <li><a href="#ttestt检验" id="toc-ttestt检验" class="nav-link" data-scroll-target="#ttestt检验">TTEST()：t检验</a></li>
  <li><a href="#manova多因素方差分析" id="toc-manova多因素方差分析" class="nav-link" data-scroll-target="#manova多因素方差分析">MANOVA()：多因素方差分析</a></li>
  <li><a href="#emmeans边际均值与事后比较" id="toc-emmeans边际均值与事后比较" class="nav-link" data-scroll-target="#emmeans边际均值与事后比较">EMMEANS()：边际均值与事后比较</a></li>
  </ul></li>
  <li><a href="#回归分析" id="toc-回归分析" class="nav-link" data-scroll-target="#回归分析">回归分析</a>
  <ul class="collapse">
  <li><a href="#model_summary模型汇总" id="toc-model_summary模型汇总" class="nav-link" data-scroll-target="#model_summary模型汇总">model_summary()：模型汇总</a></li>
  </ul></li>
  <li><a href="#中介与调节分析" id="toc-中介与调节分析" class="nav-link" data-scroll-target="#中介与调节分析">中介与调节分析</a>
  <ul class="collapse">
  <li><a href="#process中介调节分析" id="toc-process中介调节分析" class="nav-link" data-scroll-target="#process中介调节分析">PROCESS()：中介调节分析</a></li>
  </ul></li>
  <li><a href="#其他实用功能" id="toc-其他实用功能" class="nav-link" data-scroll-target="#其他实用功能">其他实用功能</a>
  <ul class="collapse">
  <li><a href="#运算符" id="toc-运算符" class="nav-link" data-scroll-target="#运算符">运算符</a></li>
  <li><a href="#theme_bruceggplot2-主题" id="toc-theme_bruceggplot2-主题" class="nav-link" data-scroll-target="#theme_bruceggplot2-主题">theme_bruce()：ggplot2 主题</a></li>
  </ul></li>
  <li><a href="#导出到-word" id="toc-导出到-word" class="nav-link" data-scroll-target="#导出到-word">导出到 Word</a></li>
  <li><a href="#函数速查表" id="toc-函数速查表" class="nav-link" data-scroll-target="#函数速查表">函数速查表</a></li>
  <li><a href="#参考资源" id="toc-参考资源" class="nav-link" data-scroll-target="#参考资源">参考资源</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1011-rpac_brucer.html">实用 R 包</a></li><li class="breadcrumb-item"><a href="./1011-rpac_brucer.html">bruceR - 统计分析工具</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">bruceR - 统计分析工具</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R包</div>
    <div class="quarto-category">统计分析</div>
    <div class="quarto-category">数据处理</div>
  </div>
  </div>



<div class="quarto-title-meta column-body">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 10, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="r包介绍" class="level2">
<h2 class="anchored" data-anchor-id="r包介绍">R包介绍</h2>
<p><strong>bruceR</strong> 全称 “<strong>BR</strong>oadly <strong>U</strong>seful <strong>C</strong>onvenient and <strong>E</strong>fficient <strong>R</strong> functions”，由包寒吴霜博士开发，是一个集成了众多实用功能的 R 包，专为科研数据分析设计。</p>
<p>链接：<a href="https://cran.r-project.org/package=bruceR">CRAN</a> | <a href="https://github.com/psychbruce/bruceR">GitHub</a> | <a href="https://zhuanlan.zhihu.com/p/281150493">中文教程</a></p>
<section id="核心功能" class="level3">
<h3 class="anchored" data-anchor-id="核心功能">核心功能</h3>
<p>bruceR 涵盖了数据分析的完整流程：</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th>模块</th>
<th>功能</th>
<th>主要函数</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>基础编程</td>
<td>路径设置、数据导入导出、表格打印</td>
<td><code>set.wd()</code>, <code>import()</code>, <code>export()</code>, <code>print_table()</code></td>
</tr>
<tr class="even">
<td>数据计算</td>
<td>量表计算、反向计分、重编码</td>
<td><code>MEAN()</code>, <code>SUM()</code>, <code>RECODE()</code>, <code>RESCALE()</code></td>
</tr>
<tr class="odd">
<td>信效度分析</td>
<td>信度分析、因子分析</td>
<td><code>Alpha()</code>, <code>EFA()</code>, <code>PCA()</code>, <code>CFA()</code></td>
</tr>
<tr class="even">
<td>描述统计</td>
<td>描述统计、频率分析、相关分析</td>
<td><code>Describe()</code>, <code>Freq()</code>, <code>Corr()</code></td>
</tr>
<tr class="odd">
<td>方差分析</td>
<td>t检验、ANOVA、简单效应、事后比较</td>
<td><code>TTEST()</code>, <code>MANOVA()</code>, <code>EMMEANS()</code></td>
</tr>
<tr class="even">
<td>回归模型</td>
<td>模型汇总、多层模型</td>
<td><code>model_summary()</code>, <code>HLM_summary()</code></td>
</tr>
<tr class="odd">
<td>中介调节</td>
<td>PROCESS 宏</td>
<td><code>PROCESS()</code>, <code>med_summary()</code></td>
</tr>
</tbody>
</table>
</section>
<section id="依赖包自动加载" class="level3">
<h3 class="anchored" data-anchor-id="依赖包自动加载">依赖包自动加载</h3>
<p>加载 bruceR 时会自动加载常用包：</p>
<ul>
<li><strong>数据处理</strong>：<code>data.table</code>, <code>dplyr</code>, <code>tidyr</code>, <code>stringr</code></li>
<li><strong>可视化</strong>：<code>ggplot2</code></li>
<li><strong>统计分析</strong>：<code>psych</code>, <code>emmeans</code>, <code>lmerTest</code>, <code>effectsize</code>, <code>performance</code></li>
</ul>
</section>
</section>
<section id="r包安装" class="level2">
<h2 class="anchored" data-anchor-id="r包安装">R包安装</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法1：从 CRAN 安装（推荐）</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"bruceR"</span>, <span class="at">dep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 方法2：从 GitHub 安装最新版</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"psychbruce/bruceR"</span>, <span class="at">dep =</span> <span class="cn">TRUE</span>, <span class="at">force =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bruceR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="基础编程功能" class="level2">
<h2 class="anchored" data-anchor-id="基础编程功能">基础编程功能</h2>
<section id="set.wd智能设置工作目录" class="level3">
<h3 class="anchored" data-anchor-id="set.wd智能设置工作目录">set.wd()：智能设置工作目录</h3>
<p>自动将工作目录设置为当前脚本所在路径：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.wd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-export万能数据导入导出" class="level3">
<h3 class="anchored" data-anchor-id="import-export万能数据导入导出">import() / export()：万能数据导入导出</h3>
<p>支持几乎所有常见数据格式，自动识别文件类型：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 支持的格式：</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - 文本：.txt, .csv, .tsv</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - Excel：.xls, .xlsx</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - SPSS：.sav</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Stata：.dta</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># - R对象：.rda, .rds, .RData</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 导入数据</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"data.xlsx"</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"data.sav"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"data.dta"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 导出数据</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">export</span>(data, <span class="at">file =</span> <span class="st">"output.xlsx"</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">export</span>(data, <span class="at">file =</span> <span class="st">"output.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cc快速创建字符向量" class="level3">
<h3 class="anchored" data-anchor-id="cc快速创建字符向量">cc()：快速创建字符向量</h3>
<p>比 <code>c()</code> 更简洁，无需引号：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 传统写法</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"gender"</span>, <span class="st">"education"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "age"       "gender"    "education"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bruceR 写法</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cc</span>(<span class="st">"age, gender, education"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "age"       "gender"    "education"</code></pre>
</div>
</div>
</section>
<section id="print_table生成三线表" class="level3">
<h3 class="anchored" data-anchor-id="print_table生成三线表">print_table()：生成三线表</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Income"</span>, <span class="st">"Score"</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fl">35.2</span>, <span class="dv">5000</span>, <span class="fl">78.5</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">c</span>(<span class="fl">8.3</span>, <span class="dv">1200</span>, <span class="fl">12.1</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">100</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print_table</span>(summary_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>─────────────────────────────────────
   Variable     Mean       SD       N
─────────────────────────────────────
1    Age      35.200    8.300 100.000
2    Income 5000.000 1200.000 100.000
3    Score    78.500   12.100 100.000
─────────────────────────────────────</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="数据计算功能" class="level2">
<h2 class="anchored" data-anchor-id="数据计算功能">数据计算功能</h2>
<section id="mean-sum横向计算支持反向计分" class="level3">
<h3 class="anchored" data-anchor-id="mean-sum横向计算支持反向计分">MEAN() / SUM()：横向计算（支持反向计分）</h3>
<p>心理学量表经常需要计算多个题目的均值或总分，并处理反向计分：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建模拟问卷数据（5点量表，共6题）</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>questionnaire <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">q1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">q2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">q3 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">q4 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">q5 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">q6 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>questionnaire</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id q1 q2 q3 q4 q5 q6
1  1  1  4  1  3  5  4
2  2  5  2  5  1  5  3
3  3  1  2  4  1  5  2
4  4  1  1  2  3  4  1
5  5  2  4  2  4  2  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算均值（q3、q6 反向计分，量表范围1-5）</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>questionnaire<span class="sc">$</span>score_mean <span class="ot">&lt;-</span> <span class="fu">MEAN</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  questionnaire, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">varrange =</span> <span class="st">"q1:q6"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">rev =</span> <span class="fu">c</span>(<span class="st">"q3"</span>, <span class="st">"q6"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">likert =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算总分</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>questionnaire<span class="sc">$</span>score_sum <span class="ot">&lt;-</span> <span class="fu">SUM</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  questionnaire, </span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">varrange =</span> <span class="st">"q1:q6"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">rev =</span> <span class="fu">c</span>(<span class="st">"q3"</span>, <span class="st">"q6"</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">likert =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>questionnaire[, <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"score_mean"</span>, <span class="st">"score_sum"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id score_mean score_sum
1  1   3.333333        20
2  2   2.833333        17
3  3   2.500000        15
4  4   3.000000        18
5  5   3.333333        20</code></pre>
</div>
</div>
</section>
<section id="recode变量重编码" class="level3">
<h3 class="anchored" data-anchor-id="recode变量重编码">RECODE()：变量重编码</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">75</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>age_group <span class="ot">&lt;-</span> <span class="fu">RECODE</span>(d<span class="sc">$</span>age, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lo:29 = '青年'; </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="st">   30:59 = '中年'; </span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="st">   60:hi = '老年'"</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age age_group
1  18      青年
2  25      青年
3  35      中年
4  45      中年
5  55      中年
6  65      老年
7  75      老年</code></pre>
</div>
</div>
</section>
<section id="rescale变量标准化" class="level3">
<h3 class="anchored" data-anchor-id="rescale变量标准化">RESCALE()：变量标准化</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">RESCALE</span>(scores, <span class="at">to =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   0.00000  16.66667  33.33333  50.00000  66.66667  83.33333 100.00000</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="信度与因子分析" class="level2">
<h2 class="anchored" data-anchor-id="信度与因子分析">信度与因子分析</h2>
<section id="alpha信度分析" class="level3">
<h3 class="anchored" data-anchor-id="alpha信度分析">Alpha()：信度分析</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"bfi"</span>, <span class="at">package =</span> <span class="st">"psych"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Alpha 需要指定数据和变量名</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Alpha</span>(bfi, <span class="at">var =</span> <span class="st">"A"</span>, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability Analysis

Summary:
Total Items: 5
Scale Range: 1 ~ 6
Total Cases: 2800
Valid Cases: 2709 (96.8%)

Scale Statistics:
Mean = 4.208
S.D. = 0.735
Cronbach’s α = 0.431
McDonald’s ω = 0.592

Warning: Scale reliability is low. You may check item codings.
Item A1 correlates negatively with the scale and may be reversed.
You can specify this argument: rev=c("A1")

Item Statistics (Cronbach’s α If Item Deleted):
─────────────────────────────────────────────
     Mean    S.D. Item-Rest Cor. Cronbach’s α
─────────────────────────────────────────────
A1  2.412 (1.405)         -0.311        0.718
A2  4.797 (1.176)          0.372        0.278
A3  4.599 (1.305)          0.478        0.174
A4  4.682 (1.486)          0.365        0.252
A5  4.551 (1.262)          0.448        0.207
─────────────────────────────────────────────
Item-Rest Cor. = Corrected Item-Total Correlation</code></pre>
</div>
</div>
</section>
<section id="efa探索性因子分析" class="level3">
<h3 class="anchored" data-anchor-id="efa探索性因子分析">EFA()：探索性因子分析</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"bfi"</span>, <span class="at">package =</span> <span class="st">"psych"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 探索性因子分析：使用 var + items 格式</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 分析外向性(E)量表的5个题目</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">EFA</span>(bfi, <span class="at">var =</span> <span class="st">"E"</span>, <span class="at">items =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">nfactors =</span> <span class="dv">2</span>, <span class="at">plot.scree =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Principal Component Analysis

Summary:
Total Items: 5
Scale Range: 1 ~ 6
Total Cases: 2800
Valid Cases: 2713 (96.9%)

Extraction Method:
- Principal Component Analysis
Rotation Method:
- Varimax (with Kaiser Normalization)

KMO and Bartlett's Test:
- Kaiser-Meyer-Olkin (KMO) Measure of Sampling Adequacy: MSA = 0.799
- Bartlett's Test of Sphericity: Approx. χ²(10) = 3011.40, p &lt; 1e-99 ***

Total Variance Explained:
──────────────────────────────────────────────────────────────────────────────────
             Eigenvalue Variance % Cumulative % SS Loading Variance % Cumulative %
──────────────────────────────────────────────────────────────────────────────────
Component 1       2.565     51.298       51.298      1.884     37.680       37.680
Component 2       0.768     15.368       66.666      1.449     28.986       66.666
Component 3       0.643     12.851       79.517                                   
Component 4       0.561     11.211       90.728                                   
Component 5       0.464      9.272      100.000                                   
──────────────────────────────────────────────────────────────────────────────────

Component Loadings (Rotated) (Sorted by Size):
─────────────────────────────
       RC1    RC2 Communality
─────────────────────────────
E1   0.812 -0.098       0.668
E2   0.752 -0.304       0.658
E4  -0.736  0.290       0.625
E5  -0.145  0.860       0.761
E3  -0.312  0.723       0.620
─────────────────────────────
Communality = Sum of Squared (SS) Factor Loadings
(Uniqueness = 1 - Communality)</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="描述统计与相关分析" class="level2">
<h2 class="anchored" data-anchor-id="描述统计与相关分析">描述统计与相关分析</h2>
<section id="describe描述统计" class="level3">
<h3 class="anchored" data-anchor-id="describe描述统计">Describe()：描述统计</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Describe</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Descriptive Statistics:
────────────────────────────────────────────────────────────────
                N Mean   SD | Median  Min  Max Skewness Kurtosis
────────────────────────────────────────────────────────────────
Sepal.Length  150 5.84 0.83 |   5.80 4.30 7.90     0.31    -0.61
Sepal.Width   150 3.06 0.44 |   3.00 2.00 4.40     0.31     0.14
Petal.Length  150 3.76 1.77 |   4.35 1.00 6.90    -0.27    -1.42
Petal.Width   150 1.20 0.76 |   1.30 0.10 2.50    -0.10    -1.36
────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</section>
<section id="freq频率分析" class="level3">
<h3 class="anchored" data-anchor-id="freq频率分析">Freq()：频率分析</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Freq</span>(iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Frequency Statistics:
───────────────────
             N    %
───────────────────
setosa      50 33.3
versicolor  50 33.3
virginica   50 33.3
───────────────────
Total N = 150</code></pre>
</div>
</div>
</section>
<section id="corr相关分析" class="level3">
<h3 class="anchored" data-anchor-id="corr相关分析">Corr()：相关分析</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Corr</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pearson's r and 95% confidence intervals:
─────────────────────────────────────────────────────────────
                               r       [95% CI]     p       N
─────────────────────────────────────────────────────────────
Sepal.Length-Sepal.Width   -0.12 [-0.27,  0.04]  .152     150
Sepal.Length-Petal.Length   0.87 [ 0.83,  0.91] &lt;.001 *** 150
Sepal.Length-Petal.Width    0.82 [ 0.76,  0.86] &lt;.001 *** 150
Sepal.Width-Petal.Length   -0.43 [-0.55, -0.29] &lt;.001 *** 150
Sepal.Width-Petal.Width    -0.37 [-0.50, -0.22] &lt;.001 *** 150
Petal.Length-Petal.Width    0.96 [ 0.95,  0.97] &lt;.001 *** 150
─────────────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1011-rpac_brucer_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="统计检验" class="level2">
<h2 class="anchored" data-anchor-id="统计检验">统计检验</h2>
<section id="ttestt检验" class="level3">
<h3 class="anchored" data-anchor-id="ttestt检验">TTEST()：t检验</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 独立样本 t 检验（需要两水平因子）</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>iris_subset <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"versicolor"</span>, <span class="st">"virginica"</span>), ]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>iris_subset<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(iris_subset<span class="sc">$</span>Species)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">TTEST</span>(iris_subset, <span class="at">y =</span> <span class="st">"Sepal.Length"</span>, <span class="at">x =</span> <span class="st">"Species"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Independent-Samples t-test

Hypothesis: two-sided (μ2 - μ1 ≠ 0)

Descriptives:
───────────────────────────────────────────────
     Variable  Factor      Level  N Mean (S.D.)
───────────────────────────────────────────────
 Sepal.Length Species versicolor 50 5.94 (0.52)
 Sepal.Length Species virginica  50 6.59 (0.64)
───────────────────────────────────────────────

Levene’s test for homogeneity of variance:
────────────────────────────────────────────────────────────────────────────
                                                Levene’s F df1 df2     p    
────────────────────────────────────────────────────────────────────────────
Sepal.Length: Species (virginica - versicolor)        1.42   1  98  .236    
────────────────────────────────────────────────────────────────────────────
Note: H0 = equal variance (homoscedasticity).
If significant (violation of the assumption),
then you should better set `var.equal=FALSE`.

Results of t-test:
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────
                                                   t df     p     Difference [95% CI] Cohen’s d [95% CI]     BF10
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Sepal.Length: Species (virginica - versicolor)  5.63 98 &lt;.001 ***   0.65 [0.42, 0.88]  1.13 [0.73, 1.52] 7.04e+04
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</section>
<section id="manova多因素方差分析" class="level3">
<h3 class="anchored" data-anchor-id="manova多因素方差分析">MANOVA()：多因素方差分析</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">MANOVA</span>(<span class="at">data =</span> npk, <span class="at">dv =</span> <span class="st">"yield"</span>, <span class="at">between =</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"P"</span>, <span class="st">"K"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
====== ANOVA (Between-Subjects Design) ======

Descriptives:
─────────────────────────────
 "N" "P" "K"   Mean    S.D. n
─────────────────────────────
  N0  P0  K0 51.433 (4.600) 3
  N0  P0  K1 52.000 (5.635) 3
  N0  P1  K0 54.333 (9.411) 3
  N0  P1  K1 50.500 (2.364) 3
  N1  P0  K0 63.767 (5.086) 3
  N1  P0  K1 54.667 (4.216) 3
  N1  P1  K0 57.933 (5.478) 3
  N1  P1  K1 54.367 (5.006) 3
─────────────────────────────
Total sample size: N = 24

ANOVA Table:
Dependent variable(s):      yield
Between-subjects factor(s): N, P, K
Within-subjects factor(s):  –
Covariate(s):               –
──────────────────────────────────────────────────────────────────────────
                MS    MSE df1 df2     F     p     η²p [90% CI of η²p]  η²G
──────────────────────────────────────────────────────────────────────────
N          189.282 30.724   1  16 6.161  .025 *     .278 [.024, .529] .278
P            8.402 30.724   1  16 0.273  .608       .017 [.000, .220] .017
K           95.202 30.724   1  16 3.099  .097 .     .162 [.000, .427] .162
N * P       21.282 30.724   1  16 0.693  .418       .041 [.000, .277] .041
N * K       33.135 30.724   1  16 1.078  .314       .063 [.000, .312] .063
P * K        0.482 30.724   1  16 0.016  .902       .001 [.000, .078] .001
N * P * K   37.002 30.724   1  16 1.204  .289       .070 [.000, .322] .070
──────────────────────────────────────────────────────────────────────────
MSE = mean square error (the residual variance of the linear model)
η²p = partial eta-squared = SS / (SS + SSE) = F * df1 / (F * df1 + df2)
ω²p = partial omega-squared = (F - 1) * df1 / (F * df1 + df2 + 1)
η²G = generalized eta-squared (see Olejnik &amp; Algina, 2003)
Cohen’s f² = η²p / (1 - η²p)

Levene’s Test for Homogeneity of Variance:
───────────────────────────────────────
           Levene’s F df1 df2     p    
───────────────────────────────────────
DV: yield       0.986   7  16  .475    
───────────────────────────────────────</code></pre>
</div>
</div>
</section>
<section id="emmeans边际均值与事后比较" class="level3">
<h3 class="anchored" data-anchor-id="emmeans边际均值与事后比较">EMMEANS()：边际均值与事后比较</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">MANOVA</span>(npk, <span class="at">dv =</span> <span class="st">"yield"</span>, <span class="at">between =</span> <span class="fu">c</span>(<span class="st">"N"</span>, <span class="st">"P"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
====== ANOVA (Between-Subjects Design) ======

Descriptives:
─────────────────────────
 "N" "P"   Mean    S.D. n
─────────────────────────
  N0  P0 51.717 (4.611) 6
  N0  P1 52.417 (6.486) 6
  N1  P0 59.217 (6.504) 6
  N1  P1 56.150 (5.084) 6
─────────────────────────
Total sample size: N = 24

ANOVA Table:
Dependent variable(s):      yield
Between-subjects factor(s): N, P
Within-subjects factor(s):  –
Covariate(s):               –
──────────────────────────────────────────────────────────────────────
            MS    MSE df1 df2     F     p     η²p [90% CI of η²p]  η²G
──────────────────────────────────────────────────────────────────────
N      189.282 32.870   1  20 5.758  .026 *     .224 [.017, .460] .224
P        8.402 32.870   1  20 0.256  .619       .013 [.000, .181] .013
N * P   21.282 32.870   1  20 0.647  .430       .031 [.000, .230] .031
──────────────────────────────────────────────────────────────────────
MSE = mean square error (the residual variance of the linear model)
η²p = partial eta-squared = SS / (SS + SSE) = F * df1 / (F * df1 + df2)
ω²p = partial omega-squared = (F - 1) * df1 / (F * df1 + df2 + 1)
η²G = generalized eta-squared (see Olejnik &amp; Algina, 2003)
Cohen’s f² = η²p / (1 - η²p)

Levene’s Test for Homogeneity of Variance:
───────────────────────────────────────
           Levene’s F df1 df2     p    
───────────────────────────────────────
DV: yield       0.160   3  20  .922    
───────────────────────────────────────</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">EMMEANS</span>(result, <span class="at">effect =</span> <span class="st">"N"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>------ EMMEANS (effect = "N") ------

Joint Tests of "N":
───────────────────────────────────────────────────
 Effect df1 df2     F     p     η²p [90% CI of η²p]
───────────────────────────────────────────────────
  N       1  20 5.758  .026 *     .224 [.017, .460]
  P       1  20 0.256  .619       .013 [.000, .181]
  N * P   1  20 0.647  .430       .031 [.000, .230]
───────────────────────────────────────────────────
Note. Simple effects of repeated measures with 3 or more levels
are different from the results obtained with SPSS MANOVA syntax.

Univariate Tests of "N":
────────────────────────────────────────────────────────
           Sum of Squares df Mean Square     F     p    
────────────────────────────────────────────────────────
Mean: "N"         189.282  1     189.282 5.758  .026 *  
Residuals         657.400 20      32.870                
────────────────────────────────────────────────────────
Note. Identical to the results obtained with SPSS GLM EMMEANS syntax.

Estimated Marginal Means of "N":
────────────────────────────────────
 "N"   Mean [95% CI of Mean]    S.E.
────────────────────────────────────
  N0 52.067 [48.614, 55.519] (1.655)
  N1 57.683 [54.231, 61.136] (1.655)
────────────────────────────────────

Pairwise Comparisons of "N":
─────────────────────────────────────────────────────────────────────
 Contrast Estimate    S.E. df     t     p     Cohen’s d [95% CI of d]
─────────────────────────────────────────────────────────────────────
  N1 - N0    5.617 (2.341) 20 2.400  .026 *      0.980 [0.128, 1.831]
─────────────────────────────────────────────────────────────────────
Pooled SD for computing Cohen’s d: 5.733
Results are averaged over the levels of: P
No need to adjust p values.

Disclaimer:
By default, pooled SD is Root Mean Square Error (RMSE).
There is much disagreement on how to compute Cohen’s d.
You are completely responsible for setting `sd.pooled`.
You might also use `effectsize::t_to_d()` to compute d.</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="回归分析" class="level2">
<h2 class="anchored" data-anchor-id="回归分析">回归分析</h2>
<section id="model_summary模型汇总" class="level3">
<h3 class="anchored" data-anchor-id="model_summary模型汇总">model_summary()：模型汇总</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Sepal.Width, <span class="at">data =</span> iris)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Sepal.Width <span class="sc">+</span> Petal.Length, <span class="at">data =</span> iris)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Sepal.Width <span class="sc">+</span> Petal.Length <span class="sc">+</span> Petal.Width, <span class="at">data =</span> iris)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 多个模型对比</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">model_summary</span>(<span class="fu">list</span>(lm1, lm2, lm3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Summary

──────────────────────────────────────────────────────────────────
              (1) Sepal.Length  (2) Sepal.Length  (3) Sepal.Length
──────────────────────────────────────────────────────────────────
(Intercept)     6.526 ***         2.249 ***         1.856 ***     
               (0.479)           (0.248)           (0.251)        
Sepal.Width    -0.223             0.596 ***         0.651 ***     
               (0.155)           (0.069)           (0.067)        
Petal.Length                      0.472 ***         0.709 ***     
                                 (0.017)           (0.057)        
Petal.Width                                        -0.556 ***     
                                                   (0.128)        
──────────────────────────────────────────────────────────────────
R^2             0.014             0.840             0.859         
Adj. R^2        0.007             0.838             0.856         
Num. obs.     150               150               150             
──────────────────────────────────────────────────────────────────
Note. * p &lt; .05, ** p &lt; .01, *** p &lt; .001.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出标准化系数</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_summary</span>(lm3, <span class="at">std =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Model Summary

──────────────────────────────
              (1) Sepal.Length
──────────────────────────────
Sepal.Width      .343 ***     
                (.035)        
Petal.Length    1.512 ***     
                (.121)        
Petal.Width     -.512 ***     
                (.117)        
──────────────────────────────
R^2              .859         
Adj. R^2         .856         
Num. obs.     150             
──────────────────────────────
Note. * p &lt; .05, ** p &lt; .01, *** p &lt; .001.

# Check for Multicollinearity

Low Correlation

        Term  VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
 Sepal.Width 1.27 [ 1.11,  1.65]     1.13      0.79     [0.61, 0.90]

High Correlation

         Term   VIF     VIF 95% CI adj. VIF Tolerance Tolerance 95% CI
 Petal.Length 15.10 [11.27, 20.36]     3.89      0.07     [0.05, 0.09]
  Petal.Width 14.23 [10.63, 19.19]     3.77      0.07     [0.05, 0.09]</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="中介与调节分析" class="level2">
<h2 class="anchored" data-anchor-id="中介与调节分析">中介与调节分析</h2>
<section id="process中介调节分析" class="level3">
<h3 class="anchored" data-anchor-id="process中介调节分析">PROCESS()：中介调节分析</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>mediation_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">M =</span> <span class="fu">rnorm</span>(n),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>mediation_data<span class="sc">$</span>M <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> mediation_data<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>mediation_data<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fl">0.4</span> <span class="sc">*</span> mediation_data<span class="sc">$</span>M <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> mediation_data<span class="sc">$</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 简单中介模型</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">PROCESS</span>(mediation_data, <span class="at">y =</span> <span class="st">"Y"</span>, <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">meds =</span> <span class="st">"M"</span>, </span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">ci =</span> <span class="st">"boot"</span>, <span class="at">nsim =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
****************** PART 1. Regression Model Summary ******************

PROCESS Model ID : 4
Model Type : Simple Mediation
-    Outcome (Y) : Y
-  Predictor (X) : X
-  Mediators (M) : M
- Moderators (W) : -
- Covariates (C) : -
-   HLM Clusters : -

All numeric predictors have been grand-mean centered.
(For details, please see the help page of PROCESS.)

Formula of Mediator:
-    M ~ X
Formula of Outcome:
-    Y ~ X + M

CAUTION:
  Fixed effect (coef.) of a predictor involved in an interaction
  denotes its "simple effect/slope" at the other predictor = 0.
  Only when all predictors in an interaction are mean-centered
  can the fixed effect be interpreted as "main effect"!
  
Model Summary

──────────────────────────────────────────────────
             (1) Y        (2) M        (3) Y      
──────────────────────────────────────────────────
(Intercept)    0.010       -0.015        0.010    
              (0.039)      (0.036)      (0.037)   
X              0.462 ***    0.475 ***    0.302 ***
              (0.041)      (0.039)      (0.052)   
M                                        0.336 ***
                                        (0.072)   
──────────────────────────────────────────────────
R^2            0.391        0.434        0.452    
Adj. R^2       0.388        0.431        0.446    
Num. obs.    200          200          200        
──────────────────────────────────────────────────
Note. * p &lt; .05, ** p &lt; .01, *** p &lt; .001.

************ PART 2. Mediation/Moderation Effect Estimate ************

Package Use : ‘mediation’ (v4.5.1)
Effect Type : Simple Mediation (Model 4)
Sample Size : 200
Random Seed : set.seed()
Simulations : 100 (Bootstrap)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Running 100 simulations...
Indirect Path: "X" (X) ==&gt; "M" (M) ==&gt; "Y" (Y)
─────────────────────────────────────────────────────────────
               Effect    S.E.      z     p      [Boot 95% CI]
─────────────────────────────────────────────────────────────
Indirect (ab)   0.160 (0.034)  4.692 &lt;.001 *** [0.107, 0.235]
Direct (c')     0.302 (0.051)  5.932 &lt;.001 *** [0.194, 0.386]
Total (c)       0.462 (0.041) 11.288 &lt;.001 *** [0.368, 0.529]
─────────────────────────────────────────────────────────────
Percentile Bootstrap Confidence Interval
(SE and CI are estimated based on 100 Bootstrap samples.)

Note. The results based on bootstrapping or other random processes
are unlikely identical to other statistical software (e.g., SPSS).
To make results reproducible, you need to set a seed (any number).
Please see the help page for details: help(PROCESS)
Ignore this note if you have already set a seed. :)</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="其他实用功能" class="level2">
<h2 class="anchored" data-anchor-id="其他实用功能">其他实用功能</h2>
<section id="运算符" class="level3">
<h3 class="anchored" data-anchor-id="运算符">运算符</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %notin%：不在其中</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">%notin%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %allin%：全部在其中</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">%allin%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="theme_bruceggplot2-主题" class="level3">
<h3 class="anchored" data-anchor-id="theme_bruceggplot2-主题">theme_bruce()：ggplot2 主题</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length, <span class="at">y =</span> Sepal.Width, <span class="at">color =</span> Species)) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"鸢尾花数据可视化"</span>) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bruce</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="1011-rpac_brucer_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="导出到-word" class="level2">
<h2 class="anchored" data-anchor-id="导出到-word">导出到 Word</h2>
<p>bruceR 的一大特色是可以将结果直接导出到 Word 文档：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 描述统计</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Describe</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">file =</span> <span class="st">"descriptives.doc"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 相关矩阵</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">Corr</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">file =</span> <span class="st">"correlation.doc"</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 回归模型</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">model_summary</span>(<span class="fu">list</span>(lm1, lm2, lm3), <span class="at">file =</span> <span class="st">"regression.doc"</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 中介分析</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="fu">PROCESS</span>(data, <span class="at">y =</span> <span class="st">"Y"</span>, <span class="at">x =</span> <span class="st">"X"</span>, <span class="at">meds =</span> <span class="st">"M"</span>, <span class="at">file =</span> <span class="st">"mediation.doc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="函数速查表" class="level2">
<h2 class="anchored" data-anchor-id="函数速查表">函数速查表</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>类别</th>
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>基础</strong></td>
<td><code>set.wd()</code></td>
<td>设置工作目录到当前脚本位置</td>
</tr>
<tr class="even">
<td></td>
<td><code>import()</code> / <code>export()</code></td>
<td>万能数据导入/导出</td>
</tr>
<tr class="odd">
<td></td>
<td><code>cc()</code></td>
<td>快速创建字符向量</td>
</tr>
<tr class="even">
<td></td>
<td><code>print_table()</code></td>
<td>打印三线表</td>
</tr>
<tr class="odd">
<td><strong>计算</strong></td>
<td><code>MEAN()</code> / <code>SUM()</code></td>
<td>横向计算（支持反向计分）</td>
</tr>
<tr class="even">
<td></td>
<td><code>RECODE()</code></td>
<td>变量重编码</td>
</tr>
<tr class="odd">
<td></td>
<td><code>RESCALE()</code></td>
<td>变量标准化</td>
</tr>
<tr class="even">
<td><strong>信效度</strong></td>
<td><code>Alpha()</code></td>
<td>Cronbach’s α 信度分析</td>
</tr>
<tr class="odd">
<td></td>
<td><code>EFA()</code> / <code>PCA()</code></td>
<td>探索性因子分析/主成分分析</td>
</tr>
<tr class="even">
<td></td>
<td><code>CFA()</code></td>
<td>验证性因子分析</td>
</tr>
<tr class="odd">
<td><strong>描述</strong></td>
<td><code>Describe()</code></td>
<td>描述统计</td>
</tr>
<tr class="even">
<td></td>
<td><code>Freq()</code></td>
<td>频率分析与交叉表</td>
</tr>
<tr class="odd">
<td></td>
<td><code>Corr()</code></td>
<td>相关分析与热力图</td>
</tr>
<tr class="even">
<td><strong>检验</strong></td>
<td><code>TTEST()</code></td>
<td>t检验（单样本/独立/配对）</td>
</tr>
<tr class="odd">
<td></td>
<td><code>MANOVA()</code></td>
<td>多因素方差分析</td>
</tr>
<tr class="even">
<td></td>
<td><code>EMMEANS()</code></td>
<td>边际均值与事后比较</td>
</tr>
<tr class="odd">
<td><strong>回归</strong></td>
<td><code>model_summary()</code></td>
<td>回归模型整洁输出</td>
</tr>
<tr class="even">
<td></td>
<td><code>GLM_summary()</code></td>
<td>广义线性模型汇总</td>
</tr>
<tr class="odd">
<td></td>
<td><code>HLM_summary()</code></td>
<td>多层线性模型汇总</td>
</tr>
<tr class="even">
<td><strong>中介</strong></td>
<td><code>PROCESS()</code></td>
<td>中介/调节效应分析</td>
</tr>
<tr class="odd">
<td></td>
<td><code>med_summary()</code></td>
<td>中介效应汇总</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="参考资源" class="level2">
<h2 class="anchored" data-anchor-id="参考资源">参考资源</h2>
<ul>
<li><a href="https://github.com/psychbruce/bruceR">bruceR GitHub 主页</a></li>
<li><a href="https://cran.r-project.org/package=bruceR">CRAN 官方页面</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/281150493">中文教程：概述篇</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/432931518">中文教程：常见问题</a></li>
<li>引用：Bao, H. W. S. (2021). bruceR: Broadly useful convenient and efficient R functions. https://doi.org/10.32614/CRAN.package.bruceR</li>
</ul>


</section>

</main> <!-- /main -->
<!-- Back to Top Button -->

<button id="back-to-top" aria-label="Back to Top">

    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">

        <path d="M18 15l-6-6-6 6"></path>

    </svg>

</button>



<script>

    // Back to Top Logic

    const backToTopBtn = document.getElementById('back-to-top');



    window.addEventListener('scroll', () => {

        if (window.scrollY > 300) {

            backToTopBtn.classList.add('visible');

        } else {

            backToTopBtn.classList.remove('visible');

        }

    });



    backToTopBtn.addEventListener('click', () => {

        window.scrollTo({

            top: 0,

            behavior: 'smooth'

        });

    });



    // Mobile Table Scrolling Logic

    document.addEventListener("DOMContentLoaded", function () {

        const tables = document.querySelectorAll('table');

        tables.forEach(table => {

            if (!table.parentElement.classList.contains('table-responsive')) {

                const wrapper = document.createElement('div');

                wrapper.className = 'table-responsive';

                wrapper.style.overflowX = 'auto'; // Force scroll

                table.parentNode.insertBefore(wrapper, table);

                wrapper.appendChild(table);

            }

        });

    });

</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Made with <a href="https://quarto.org/">Quarto</a> | © 2024-2026</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>