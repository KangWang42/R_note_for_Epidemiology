---
title: "变分模态分解 (VMD) 信号处理指南"
date: "2026-01-13"
categories: [R包, 信号处理, 时间序列]
image: "images/1034_cover.svg"
description: "处理非线性非平稳信号的利器：完全非递归的 VMD 分解算法 R 语言实现。"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    warning = FALSE,
    message = FALSE,
    fig.width = 10,
    fig.height = 7,
    dpi = 300
)
```

## 1. VMD vs EMD：为什么要用 VMD？

在处理生物医学信号（EEG, ECG）或金融时间序列时，我们经常遇到**非平稳**和**非线性**信号。

-   **EMD (经验模态分解)**：经典方法，但由递归筛选过程决定，容易受到噪声干扰（"模态混叠"）。
-   **VMD (变分模态分解)**：基于坚实的数学理论（维纳滤波、希尔伯特变换）。它将分解问题构建为一个约束变分问题，**完全非递归**，抗噪性强，能有效分离频率接近的成分。

### VMD vs EMD 对比

| 特性 | VMD | EMD |
|------|-----|-----|
| **理论基础** | 变分优化理论 | 经验算法，无严格数学基础 |
| **分解方式** | 非递归，同时分解 | 递归筛选 |
| **模态混叠** | 有效避免 | 容易发生 |
| **噪声敏感性** | 低 | 高 |
| **模态数K** | 需预先设定 | 自适应确定 |
| **计算速度** | 较慢 | 较快 |

> [!NOTE]
> VMD 的主要优势在于其"带宽限制"的变分框架，能够将频率相近的成分有效分离。

## 2. 工具：VMDecomp

```{r eval=FALSE}
# 由于不在 CRAN，需从 GitHub 安装
install.packages("devtools")
devtools::install_github("lampros-mouselimis/VMDecomp")
```

```{r}
library(VMDecomp)
library(ggplot2)
```

## 3. 构造仿真信号

为了验证 VMD 的能力，我们构造一个已知成分的信号：
$$ S(t) = S_{low}(10Hz) + S_{mid}(50Hz) + S_{high}(100Hz) + Noise $$

```{r}
# 采样频率
fs <- 1000
t <- seq(0, 1, length.out = fs)

# 频率分量
f1 <- 10 # 低频
f2 <- 50 # 中频
f3 <- 100 # 高频

# 构造信号 (正弦波叠加 + 高斯白噪声)
set.seed(123)
sig <- 2 * sin(2 * pi * f1 * t) +
    1.5 * sin(2 * pi * f2 * t) +
    1 * sin(2 * pi * f3 * t) +
    rnorm(length(t), 0, 0.5) # 噪声

# 绘制原始信号
plot(t, sig,
    type = "l", col = "darkgrey",
    main = "Raw Synthetic Signal (with Noise)", xlab = "Time (s)", ylab = "Amplitude"
)
```

## 4. 参数设置与分解

VMD 需要预先设定几个关键参数，其中最重要的是 **K (模态数)** 和 **alpha (带宽限制)**。

### 参数选择指南

| 参数 | 含义 | 推荐值/选择方法 |
|------|------|-----------------|
| **K** | 模态数量 | 先用FFT估计主要频率成分数 |
| **alpha** | 带宽限制因子 | 2000（中等），越大带宽越窄 |
| **tau** | 噪声容限 | 0（无严格约束）或 0.01 |
| **DC** | 是否包含直流分量 | FALSE（通常无需） |
| **tol** | 收敛容差 | 1e-6 或 1e-7 |

> [!TIP]
> **如何确定K值**：
> 1. 先对信号做FFT，识别明显的频率峰
> 2. K = 峰的数量 + 1（为噪声预留一个模态）
> 3. 过大的K会导致过拟合，过小会丢失信息

### alpha 参数的影响

```{r}
# 不同 alpha 值的效果对比
par(mfrow = c(1, 2))

# alpha 较小（带宽宽）
vmd_low_alpha <- VMDecomp::vmd(sig, alpha = 500, tau = 0, K = 3, DC = FALSE, init = 1, tol = 1e-6)
plot(t, vmd_low_alpha$u[, 1], type = "l", main = "alpha=500 (宽带宽)", ylab = "IMF 1", xlab = "Time")

# alpha 较大（带宽窄）
vmd_high_alpha <- VMDecomp::vmd(sig, alpha = 5000, tau = 0, K = 3, DC = FALSE, init = 1, tol = 1e-6)
plot(t, vmd_high_alpha$u[, 1], type = "l", main = "alpha=5000 (窄带宽)", ylab = "IMF 1", xlab = "Time")
```

### 执行分解

```{r}
# VMD 参数
alpha <- 2000 # 适中的带宽限制
tau <- 0 # 噪声容限 (0 表示无严格去噪，或依靠 alpha)
K <- 3 # 我们知道有 3 个主要成分
DC <- FALSE # 无直流偏移
init <- 1 # 初始化模式 (1 = 均匀分布)
tol <- 1e-6 # 收敛容差

# 执行分解
# 输出结果包含了分解出的模态 (u) 和中心频率 (omega) 等
vmd_res <- VMDecomp::vmd(sig, alpha, tau, K, DC, init, tol)

# 提取模态分量矩阵 (K 行 x N 列)
imfs <- vmd_res$u
```

## 5. 结果可视化与验证

我们将分解出的 3 个 IMF 分量与原始信号的真实成分进行对比。

```{r fig.height=10}
par(mfrow = c(4, 1), mar = c(2, 4, 2, 1))

# 原始信号
plot(t, sig, type = "l", main = "Original Noisy Signal", col = "gray")

# 分解出的 IMF 1 (对应低频 10Hz)
plot(t, imfs[, 1],
    type = "l", col = "blue", lwd = 1.5,
    main = "IMF 1 (Extracted Low Freq)"
)

# 分解出的 IMF 2 (对应中频 50Hz)
plot(t, imfs[, 2],
    type = "l", col = "green", lwd = 1.5,
    main = "IMF 2 (Extracted Mid Freq)"
)

# 分解出的 IMF 3 (对应高频 100Hz)
plot(t, imfs[, 3],
    type = "l", col = "red", lwd = 1.5,
    main = "IMF 3 (Extracted High Freq)"
)
```

**观察**:
即使存在噪声，VMD 也能非常干净地还原出原始的 10Hz, 50Hz, 100Hz 正弦波，表现优于许多传统滤波器。

## 6. 频谱验证

使用FFT验证分解出的各模态确实对应预期的频率：

```{r}
# 计算各 IMF 的频谱
par(mfrow = c(3, 1), mar = c(4, 4, 2, 1))

for (i in 1:3) {
    imf_fft <- fft(imfs[, i])
    P <- abs(imf_fft / length(imfs[, i]))
    P1 <- P[1:(length(imfs[, i]) / 2 + 1)]
    f <- fs * (0:(length(imfs[, i]) / 2)) / length(imfs[, i])

    plot(f, P1,
        type = "l", xlim = c(0, 150),
        main = paste("IMF", i, "频谱"),
        xlab = "Frequency (Hz)", ylab = "Amplitude",
        col = c("blue", "green", "red")[i]
    )
}
```

## 7. 实际应用场景

### 7.1 生物医学信号处理

| 应用 | 信号类型 | VMD 作用 |
|------|----------|----------|
| **心电图 (ECG)** | 心跳节律 | 分离心率变异性(HRV)成分 |
| **脑电图 (EEG)** | 脑波 | 提取 α, β, θ, δ 波 |
| **肌电图 (EMG)** | 肌肉活动 | 去除运动伪迹 |

### 7.2 金融时间序列

- **股票价格分解**：分离长期趋势、周期波动和噪声
- **波动率分析**：提取不同频率的波动成分

### 7.3 故障诊断

- **轴承振动信号**：提取特征频率，识别故障类型
- **电机电流分析**：检测异常振动成分

## 8. 常见问题与解决方案

| 问题 | 可能原因 | 解决方案 |
|------|----------|----------|
| 模态混叠 | K 值过小 | 增加 K 值 |
| 过分解 | K 值过大 | 减少 K 值或增加 alpha |
| 边缘效应 | 信号不对称 | 使用镜像延拓预处理 |
| 收敛慢/不收敛 | tol 过小或 alpha 不当 | 调整参数 |

> [!WARNING]
> VMD 对参数敏感！建议先用仿真信号确定最佳参数组合，再应用于真实数据。

## 参考文献

-   Dragomiretskiy, K., & Zosso, D. (2014). Variational Mode Decomposition. *IEEE Transactions on Signal Processing*, 62(3), 531-544.
-   Nazari, M., & Sakhaei, S. M. (2020). Variational Mode Decomposition: Applications in biomedical signal processing. *Computers in Biology and Medicine*.

