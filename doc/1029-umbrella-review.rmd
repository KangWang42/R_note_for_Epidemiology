---
title: "伞状综述 (Umbrella Review)"
date: "2025-01-12"
categories: [R包, Meta分析, 循证医学]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    warning = FALSE,
    message = FALSE,
    fig.width = 8,
    fig.height = 6,
    dpi = 150
)
```

## 简介

**伞状综述 (Umbrella Review)**，也称为系统评价的系统评价 (Review of Reviews)，旨在整合针对特定主题的多个系统评价或 Meta 分析的结果。它提供了比单一 Meta 分析更顶层的证据汇总。

在 R 语言中，`metaumbrella` 是一个专门用于执行伞状综述的强大包，它可以帮助我们进行证据分层、可视化和统计分析。

## 安装

```{r eval=FALSE}
install.packages("metaumbrella")
```

```{r}
library(metaumbrella)
library(ggplot2)
```

## 核心流程

使用 `metaumbrella` 进行分析主要包含以下步骤：

1.  **数据准备**：整理各个 Meta 分析的数据。
2.  **执行分析**：使用 `umbrella()` 函数进行计算。
3.  **证据分层**：根据 Ioannidis 等人的标准或其他标准对证据强度进行分级。
4.  **可视化**：绘制森林图等图形。

## 实例演示

我们使用包中自带的数据集 `df.proteomics` 作为示例。

### 1. 自动执行 Umbrella Review

`umbrella()` 函数不仅进行 Meta 分析，还自动计算用于证据分级的各种统计量（如 Egger 检验、I2、ESB 等）。

```{r}
# 加载数据
data("df.proteomics")

# 进行伞状综述分析
umb.results <- umbrella(df.proteomics)

# 查看摘要
summary(umb.results)
```

### 2. 证据分层 (Evidence Stratification)

我们可以使用 `add.evidence()` 函数根据特定标准对关联进行分级。这里使用标准的 Ioannidis 分级标准。

```{r}
# 添加证据分级
evid.res <- add.evidence(umb.results, criteria = "Ioannidis")

# 查看分级结果摘要
summary(evid.res)
```

### 3. 可视化结果

`forest()` 函数可以生成展示所有因素结果及其证据等级的森林图。

```{r fig.height=10, fig.width=10}
# 绘制森林图
forest(evid.res)
```

## 结果解读

-   **Class I (Convincing)**: 证据最强，通常要求 P < 10^-6^，I2 < 50%，无小样本效应等。
-   **Class II (Highly Suggestive)**: 证据较强，P < 10^-6^，最大研究显著等。
-   **Class III (Suggestive)**: 提示性证据，P < 10^-3^。
-   **Class IV (Weak)**: 弱证据，P < 0.05。
-   **ns (Not Significant)**: 无统计学意义。

## 导出结果

可以将结果导出为 CSV 文件以便后续整理。

```{r eval=FALSE}
# 提取详细结果
results_df <- summary(evid.res)
write.csv(results_df, "umbrella_results.csv")
```

## 参考文献

-   Fusar-Poli, P., & Radua, J. (2018). Ten simple rules for conducting umbrella reviews. *Evidence-Based Mental Health*.
-   Balduzzi, S., et al. (2023). metaumbrella: An R Package for Conducting Umbrella Reviews.
