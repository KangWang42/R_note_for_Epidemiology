---
title: "R 语言学习笔记"
title-block-banner: false
listing:
  contents: 
    - "*.rmd"
    - "00*.md"
    - "!index.qmd"
  type: grid
  sort: "date desc" 
  fields: [image, title, reading-time]
  grid-item-border: false
  page-size: 12
  grid-columns: 3
  image-height: 180px
toc: true
toc-title: "随机笔记"
---

<style>
#title-block-header { display: none; }
</style>

## 最新更新

<script>
const tips = [
  { 
    title: "bruceR：一站式统计分析", 
    sections: [
      { h: "频数统计 Freq()", text: "自动计算频数、百分比、累积百分比，支持卡方检验，输出可直接用于论文表格。" },
      { h: "方差分析 MANOVA()", text: "支持单因素、多因素、重复测量方差分析，自动进行事后多重比较，输出效应量。" },
      { h: "相关分析 Corr()", text: "计算 Pearson/Spearman 相关系数，自动标注显著性星号，支持热图可视化。" }
    ],
    url: "1011-rpac_brucer.html" 
  },
  { 
    title: "compareGroups：基线表神器", 
    sections: [
      { h: "自动识别变量类型", text: "连续变量报告均值±标准差或中位数(IQR)，分类变量报告频数(百分比)。" },
      { h: "分组比较", text: "自动选择 t 检验、Mann-Whitney U、卡方检验或 Fisher 精确检验。" },
      { h: "多格式导出", text: "export2word()、export2excel()、export2latex() 一键导出发表级表格。" }
    ],
    url: "1012-comparegroups.html" 
  },
  { 
    title: "purrr：函数式编程", 
    sections: [
      { h: "map() 系列函数", text: "map() 返回列表，map_dbl() 返回数值向量，map_dfr() 直接合并为数据框。" },
      { h: "safely() 错误处理", text: "将函数包装为安全版本，出错时返回 NULL 而不是中断，适合批量处理。" },
      { h: "reduce() 累积操作", text: "将列表元素依次合并，常用于多个数据框的连续 join 操作。" }
    ],
    url: "1014-purrr.html" 
  },
  { 
    title: "ggplot2 配色方案", 
    sections: [
      { h: "ggsci 期刊配色", text: "scale_color_npg() Nature 风格，scale_color_lancet() 柳叶刀风格，学术论文首选。" },
      { h: "RColorBrewer 调色板", text: "display.brewer.all() 预览所有配色，Set1/Set2 适合分类，Blues/Reds 适合连续。" },
      { h: "自定义配色", text: "scale_color_manual(values=c()) 精确指定每个类别的颜色，保证图表一致性。" }
    ],
    url: "2011-viscolor.html" 
  },
  { 
    title: "patchwork 多图拼接", 
    sections: [
      { h: "基础拼接", text: "p1 + p2 水平排列，p1 / p2 垂直排列，(p1 + p2) / p3 组合布局。" },
      { h: "plot_layout()", text: "控制宽度比例 widths=c(2,1)，设置行列数 ncol=2，嵌套布局 design 参数。" },
      { h: "统一标注", text: "plot_annotation(tag_levels='A') 自动添加 A、B、C 子图标签。" }
    ],
    url: "2012-patchwork.html" 
  },
  { 
    title: "图例自定义技巧", 
    sections: [
      { h: "位置控制", text: "legend.position='bottom'/'right'/'none'，或用 c(0.8, 0.2) 精确坐标定位。" },
      { h: "guides() 精调", text: "guide_legend(nrow=2) 设置行数，override.aes=list(size=4) 修改图例符号大小。" },
      { h: "合并图例", text: "多个图层共享图例时，确保 name 和 labels 参数完全一致即可自动合并。" }
    ],
    url: "2013-legend.html" 
  },
  { 
    title: "ComplexHeatmap 热图", 
    sections: [
      { h: "基础热图", text: "Heatmap(mat) 创建热图，col 参数设置配色，name 参数设置图例标题。" },
      { h: "行列注释", text: "rowAnnotation() 和 HeatmapAnnotation() 添加分组、条形图等注释信息。" },
      { h: "多热图组合", text: "ht1 + ht2 水平拼接，ht1 %v% ht2 垂直拼接，共享行名或列名自动对齐。" }
    ],
    url: "2020-heatmap.html" 
  },
  { 
    title: "cowplot 图形组合", 
    sections: [
      { h: "plot_grid()", text: "labels='AUTO' 自动标注，rel_widths 控制相对宽度，align='hv' 对齐坐标轴。" },
      { h: "嵌入小图", text: "ggdraw() + draw_plot() 在任意位置插入子图，适合添加放大细节或缩略图。" },
      { h: "save_plot()", text: "自动计算合适的图片尺寸，base_height/base_width 按比例缩放。" }
    ],
    url: "2021-cowplot.html" 
  },
  { 
    title: "卫生经济学分析", 
    sections: [
      { h: "ICER 计算", text: "增量成本效果比 = ΔCost / ΔEffect，判断新干预是否具有成本效果优势。" },
      { h: "成本效果平面", text: "散点图展示增量成本和效果的不确定性，四个象限代表不同决策结论。" },
      { h: "可接受曲线 CEAC", text: "不同支付意愿阈值下，干预措施具有成本效果的概率曲线。" }
    ],
    url: "1015-health-economics.html" 
  },
  { 
    title: "mlr3 机器学习框架", 
    sections: [
      { h: "Task 定义任务", text: "TaskClassif$new() 分类任务，TaskRegr$new() 回归任务，指定目标变量和特征。" },
      { h: "Learner 选择模型", text: "lrn('classif.ranger') 随机森林，lrn('classif.xgboost') XGBoost，统一接口。" },
      { h: "Resampling 验证", text: "rsmp('cv', folds=5) 交叉验证，rsmp('holdout') 留出法，评估模型泛化能力。" }
    ],
    url: "1016-mlr3.html" 
  },
  { 
    title: "时间序列分析", 
    sections: [
      { h: "平稳性检验", text: "adf.test() ADF 检验，kpss.test() KPSS 检验，非平稳序列需要差分处理。" },
      { h: "ARIMA 建模", text: "auto.arima() 自动选择 p、d、q 参数，也可手动指定 arima(order=c(p,d,q))。" },
      { h: "预测与可视化", text: "forecast(model, h=12) 预测未来值，autoplot() 绑制预测区间图。" }
    ],
    url: "1017-timeseries.html" 
  },
  { 
    title: "数据导入导出", 
    sections: [
      { h: "rio 包万能导入", text: "import('file.xlsx') 自动识别格式，支持 csv、xlsx、sav、dta 等几十种格式。" },
      { h: "处理大文件", text: "data.table::fread() 速度最快，vroom::vroom() 延迟加载节省内存。" },
      { h: "中文编码", text: "read.csv(fileEncoding='GBK') 处理中文乱码，locale() 设置区域参数。" }
    ],
    url: "3001-imports.html" 
  }
];

document.addEventListener('DOMContentLoaded', function() {
  const tip = tips[Math.floor(Math.random() * tips.length)];
  const randomSection = tip.sections[Math.floor(Math.random() * tip.sections.length)];
  
  const tocNav = document.querySelector('#TOC') || document.querySelector('.toc');
  if (tocNav) {
    let sectionsHtml = tip.sections.map(s => 
      `<div class="tip-section">
        <div class="tip-section-title">${s.h}</div>
        <div class="tip-section-text">${s.text}</div>
      </div>`
    ).join('');
    
    tocNav.innerHTML = `
      <div class="random-tip-sidebar">
        <div class="tip-title">${tip.title}</div>
        ${sectionsHtml}
        <a href="${tip.url}" class="tip-link">阅读完整教程 →</a>
        <div class="tip-refresh" onclick="location.reload()">换一篇</div>
      </div>
    `;
  }
});
</script>

<style>
.random-tip-sidebar {
  padding: 0.5rem 0;
}

.random-tip-sidebar .tip-title {
  font-size: 1.05rem;
  font-weight: 700;
  color: #1e40af;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 2px solid #3b82f6;
  line-height: 1.4;
}

.random-tip-sidebar .tip-section {
  margin-bottom: 0.9rem;
}

.random-tip-sidebar .tip-section-title {
  font-size: 0.85rem;
  font-weight: 600;
  color: #334155;
  margin-bottom: 0.25rem;
}

.random-tip-sidebar .tip-section-text {
  font-size: 0.8rem;
  color: #64748b;
  line-height: 1.6;
}

.random-tip-sidebar .tip-link {
  display: inline-block;
  font-size: 0.85rem;
  color: #2563eb !important;
  text-decoration: none !important;
  font-weight: 500;
  margin-top: 0.5rem;
}

.random-tip-sidebar .tip-link:hover {
  color: #1d4ed8 !important;
  text-decoration: underline !important;
}

.random-tip-sidebar .tip-refresh {
  margin-top: 0.8rem;
  padding-top: 0.6rem;
  border-top: 1px solid #e2e8f0;
  font-size: 0.75rem;
  color: #94a3b8;
  cursor: pointer;
  transition: color 0.2s;
}

.random-tip-sidebar .tip-refresh:hover {
  color: #2563eb;
}
</style>
