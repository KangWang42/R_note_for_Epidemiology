---
title: 伞状综述 (Umbrella Review) 完全指南
date: '2026-01-13'
categories:
- 统计分析方法
- 综述方法
- R包
- Meta分析
image: images/1029_cover.svg
description: 从数据准备到证据分级，使用 R 语言 metaumbrella 包进行伞状综述的全流程教学。
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    warning = FALSE,
    message = FALSE,
    fig.width = 10,
    fig.height = 8,
    dpi = 300
)
```

##  什么是伞状综述？

**伞状综述 (Umbrella Review)**，也称为系统评价的系统评价 (Review of Reviews)，处于循证医学证据金字塔的顶端。

传统的 **Meta 分析** 整合了多个独立研究的结果，而 **伞状综述** 则整合了针对同一主题（或广泛主题）的多个 Meta 分析结果。

### 为什么需要它？
-   **解决矛盾**：当不同的 Meta 分析得出不一致的结论时。
-   **全面概览**：提供比单一 Meta 分析更广阔的视野（例如，“体育锻炼对**所有**健康结局的影响”）。
-   **证据分级**：不仅关注是否显著，更关注证据的**可信度**和**强度**。

##  工具介绍：metaumbrella

在 R 语言中，`metaumbrella` 是目前最全面的伞状综述自动化工具。它能够：
-   自动计算效应量（OR, RR, HR, Mean Difference 等）。
-   进行异质性检验 (I^2^)。
-   检测小样本效应 (Egger's test)。
-   计算超额显著性偏差 (Excess Significance Bias)。
-   **基于 Ioannidis 等标准自动进行证据分级**。

### 安装

```{r eval=FALSE}
install.packages("metaumbrella")
install.packages("ggplot2")
```

```{r}
library(metaumbrella)
library(ggplot2)
```

## 3. 数据准备

进行伞状综述，数据通常来源于已发表的 Meta 分析文章。我们需要整理出一个标准的数据框。

我们使用包中自带的数据集 `df.OR` 作为示例。这是一个关于**基因多态性与疾病风险**的 Meta 分析集合。

```{r}
data("df.OR")
# 查看数据结构的前几行
head(df.OR)
```

### 数据字段说明
通常需要以下关键列：
-   `meta_review`:  所属的 Meta 分析或因素名称（如 "Gene A vs Disease"）。
-   `author`: 纳入的原始研究第一作者。
-   `year`: 发表年份。
-   `n_cases_exp`, `n_cases_nexp`: 病例组的暴露/非暴露人数。
-   `n_controls_exp`, `n_controls_nexp`: 对照组的暴露/非暴露人数。

> [!TIP]
> 如果你的数据是连续变量（均值差），则需要 `n_group1`, `mean_group1`, `sd_group1` 等列。

##  核心分析：umbrella()

`umbrella()` 函数是该包的核心，它一次性完成所有统计工作。

```{r}
# 执行伞状综述分析
# method.var = "REML" 推荐使用限制性极大似然法估计异质性
umb.results <- umbrella(df.OR, method.var = "REML")
```

这个对象包含了大量信息，包括每个因素的汇总效应量、95% 置信区间、p 值、I2 统计量、Egger 检验结果等。

##  证据分级 (Evidence Stratification)

这是伞状综述最关键的一步。我们不仅仅看 P 值是否小于 0.05，还要看证据是否“稳健”。通常使用 Ioannidis (2011) 的标准。

**Ioannidis 分级标准通常包括：**
-   **Class I (Convincing)**: P < 10^-6^, I2 < 50%, 无小样本效应, 样本量充足 (>1000例或>10%研究), 95%预测区间不包含无效值。
-   **Class II (Highly Suggestive)**: P < 10^-6^, 最大研究显著, 但可能存在一定异质性。
-   **Class III (Suggestive)**: P < 10^-3^.
-   **Class IV (Weak)**: P < 0.05.
-   **ns**: P > 0.05.

```{r}
# 依据 "Ioannidis" 标准进行分级
evid.res <- add.evidence(umb.results, criteria = "Ioannidis")

# 查看针对每个因素的分级结果
summary(evid.res)
```

##  结果可视化

一张清晰的森林图可以展示所有因素的证据等级。

```{r fig.height=12, fig.width=10}
# 绘制分层证据图
# print_score = TRUE 显示具体证据得分（可选）
chart <- forest(evid.res,
    print_score = FALSE,
    layout = "JAMA"
) # 使用 JAMA 风格布局
```

**图形解读：**
-   纵轴列出了所有分析的因素。
-   点的颜色或形状代表了证据等级（Class I - IV）。
-   横轴通常是效应量（如 OR 值）。
-   你可以一眼看出哪些因素具有**确凿 (Convincing)** 的证据支持。

##  导出结果

分析完成后，我们通常需要将详细的统计指标导出到 Excel 或 CSV 中制作表格。

```{r}
# 提取汇总表
results_table <- summary(evid.res)

# 仅展示前几列重要信息
knitr::kable(head(results_table[, c("Factor", "Class", "eOR", "p_value", "egger_p", "I2")]))
```

##  总结

通过 `metaumbrella`，我们可以快速完成复杂的证据整合工作。一个高质量的伞状综述应该：
1.  **全面检索**：确保没有遗漏重要的 Meta 分析。
2.  **严格清洗**：数据提取必须准确。
3.  **多维评估**：不仅看效应量，更要看异质性和发表偏倚。
4.  **清晰呈现**：使用分级图展示证据强度。

## 参考文献

-   Ioannidis, J. P. (2009). Integration of evidence from multiple meta-analyses: a primer on umbrella reviews, treatment networks and multiple treatments meta-analyses. *CMAJ*.
-   Balduzzi, S., et al. (2023). metaumbrella: An R Package for Conducting Umbrella Reviews.
