---
title: 'é˜Ÿåˆ—ç ”ç©¶è®¾è®¡ä¸åˆ†æå®Œæ•´æ•™ç¨‹'
date: '2026-01-25'
categories:
- ç»Ÿè®¡åˆ†ææ–¹æ³•
- æµè¡Œç—…å­¦ç ”ç©¶è®¾è®¡
image: images/cohort-design-cover.svg
description: é˜Ÿåˆ—ç ”ç©¶çš„è®¾è®¡åŸç†ã€å‘ç—…ç‡è®¡ç®—ã€RR/HRä¼°è®¡ä¸STROBEæŠ¥å‘ŠæŒ‡å—
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  fig.width = 8,
  fig.height = 5,
  fig.retina = 2,
  out.width = "100%",
  dpi = 150
)
```

## æ–¹æ³•èƒŒæ™¯ä¸é€‚ç”¨åœºæ™¯

é˜Ÿåˆ—ç ”ç©¶(Cohort Study)æ˜¯æµè¡Œç—…å­¦ä¸­æœ€é‡è¦çš„è§‚å¯Ÿæ€§ç ”ç©¶è®¾è®¡ä¹‹ä¸€,é€šè¿‡å‰ç»æ€§æˆ–å›é¡¾æ€§è¿½è¸ªä¸€ç»„åˆå§‹æœªæ‚£ç—…çš„äººç¾¤,æ¯”è¾ƒæš´éœ²ç»„ä¸éæš´éœ²ç»„çš„ç–¾ç—…å‘ç”Ÿæƒ…å†µ,ä»è€Œè¯„ä¼°æš´éœ²å› ç´ ä¸ç–¾ç—…ä¹‹é—´çš„å› æœå…³è”ã€‚

**é€‚ç”¨åœºæ™¯**

- **è¯„ä¼°å±é™©å› ç´ **:å¸çƒŸä¸è‚ºç™Œã€é«˜è¡€å‹ä¸å¿ƒè¡€ç®¡ç—…
- **ä¼°è®¡å‘ç—…ç‡**:æ–°å‘ç—…ä¾‹éšæ—¶é—´çš„ç´¯ç§¯
- **å› æœæ¨æ–­**:å…·æœ‰æ˜ç¡®çš„æ—¶é—´é¡ºåº
- **ç½•è§æš´éœ²**:èŒä¸šæš´éœ²ã€é—ä¼ å› ç´ 
- **å¤šç§ç»“å±€**:åŒæ—¶ç ”ç©¶ä¸€ä¸ªæš´éœ²å¯¹å¤šç§ç–¾ç—…çš„å½±å“

**ä¸é€‚ç”¨åœºæ™¯**

- **ç½•è§ç–¾ç—…**:éœ€è¦æå¤§æ ·æœ¬é‡å’Œé•¿æœŸéšè®¿
- **æˆæœ¬å—é™**:é˜Ÿåˆ—ç ”ç©¶æˆæœ¬é«˜ã€å‘¨æœŸé•¿
- **ä¼¦ç†é™åˆ¶**:æœ‰å®³æš´éœ²æ— æ³•äººä¸ºåˆ†é…

**ä¸å…¶ä»–ç ”ç©¶è®¾è®¡çš„å¯¹æ¯”**

| ç ”ç©¶è®¾è®¡ | æ—¶é—´ç»´åº¦ | å› æœæ¨æ–­ | ä¸»è¦æŒ‡æ ‡ | æˆæœ¬ | åå€šæ§åˆ¶ |
|---------|---------|---------|---------|------|---------|
| **é˜Ÿåˆ—ç ”ç©¶** | å‰ç»æ€§ | å¼º | å‘ç—…ç‡ã€RRã€HR | é«˜ | å¥½ |
| **æ¨ªæˆªé¢ç ”ç©¶** | å•æ—¶ç‚¹ | å¼± | æ‚£ç—…ç‡ã€PR | ä½ | å·® |
| **ç—…ä¾‹å¯¹ç…§ç ”ç©¶** | å›é¡¾æ€§ | ä¸­ç­‰ | OR | ä¸­ | ä¸­ |
| **RCT** | å‰ç»æ€§ | æœ€å¼º | RRã€RD | å¾ˆé«˜ | æœ€å¥½ |

## æ ¸å¿ƒæ¦‚å¿µä¸æ¨¡å‹å…¥é—¨

### é€šä¿—ç†è§£:ç”¨æ—¥å¸¸ä¾‹å­è§£é‡Šé˜Ÿåˆ—ç ”ç©¶

> ğŸ’¡ **æƒ³è±¡ä½ åœ¨è¿½è¸ªä¸€ç¾¤åˆšå…¥å­¦çš„å¤§å­¦ç”Ÿ**
> 
> é˜Ÿåˆ—ç ”ç©¶å°±åƒ"é•¿æœŸè§‚å¯Ÿæ—¥è®°":
> - åœ¨å…¥å­¦æ—¶(åŸºçº¿)è®°å½•è°å¸çƒŸã€è°ä¸å¸çƒŸ
> - è¿½è¸ª4å¹´,æ¯å¹´æ£€æŸ¥æ˜¯å¦å¾—äº†å‘¼å¸é“ç–¾ç—…
> - å‘ç°:å¸çƒŸç»„æ¯å¹´æœ‰10äººå¾—ç—…,ä¸å¸çƒŸç»„æ¯å¹´5äºº
> - å› ä¸ºå…ˆæœ‰å¸çƒŸ,åæœ‰ç–¾ç—…,æ‰€ä»¥å¯ä»¥æ¨æ–­å› æœå…³ç³»
> - è¿™å°±æ˜¯"æ—¶é—´é¡ºåºæ˜ç¡®"çš„ä¼˜åŠ¿
>
> **å›åˆ°ç»Ÿè®¡å­¦**:é˜Ÿåˆ—ç ”ç©¶ä»"å› "åˆ°"æœ",æš´éœ²åœ¨å‰,ç»“å±€åœ¨å,èƒ½è¾ƒå¥½åœ°æ¨æ–­å› æœå…³ç³»ã€‚

### æ ¸å¿ƒæœ¯è¯­å®šä¹‰

**é˜Ÿåˆ—(Cohort)**

ä¸€ç»„å…·æœ‰å…±åŒç‰¹å¾æˆ–ç»å†çš„äººç¾¤,åœ¨ç ”ç©¶å¼€å§‹æ—¶å‡æœªæ‚£æ‰€ç ”ç©¶çš„ç–¾ç—…ã€‚

**å‰ç»æ€§é˜Ÿåˆ— vs å›é¡¾æ€§é˜Ÿåˆ—**

| ç‰¹å¾ | å‰ç»æ€§é˜Ÿåˆ— | å›é¡¾æ€§é˜Ÿåˆ— |
|------|-----------|-----------|
| **æ•°æ®æ”¶é›†** | ä»ç°åœ¨å¼€å§‹å‘æœªæ¥éšè®¿ | åˆ©ç”¨å·²æœ‰è®°å½•å›é¡¾è¿‡å» |
| **ä¼˜ç‚¹** | æ•°æ®è´¨é‡é«˜ã€åå€šå° | å¿«é€Ÿã€æˆæœ¬ä½ |
| **ç¼ºç‚¹** | è€—æ—¶é•¿ã€æˆæœ¬é«˜ | æ•°æ®è´¨é‡å—é™ |
| **ç¤ºä¾‹** | Framinghamå¿ƒè„ç—…ç ”ç©¶ | æŠ¤å£«å¥åº·ç ”ç©¶(éƒ¨åˆ†) |

**å‘ç—…ç‡(Incidence)**

å•ä½æ—¶é—´å†…æ–°å‘ç—…ä¾‹çš„æ¯”ä¾‹:

$$\text{å‘ç—…ç‡} = \frac{\text{éšè®¿æœŸæ–°å‘ç—…ä¾‹æ•°}}{\text{æš´éœ²äººå¹´}} \times 1000$$

**äººå¹´(Person-Years)**

æ‰€æœ‰ç ”ç©¶å¯¹è±¡çš„éšè®¿æ—¶é—´æ€»å’Œ:

$$\text{äººå¹´} = \sum_{i=1}^{n} t_i$$

å…¶ä¸­ $t_i$ æ˜¯ç¬¬iä¸ªäººçš„éšè®¿æ—¶é—´ã€‚

**ç¤ºä¾‹**:
- 100äººéšè®¿1å¹´ = 100äººå¹´
- 50äººéšè®¿2å¹´ = 100äººå¹´
- 20äººéšè®¿5å¹´ = 100äººå¹´

**ç´¯ç§¯å‘ç—…ç‡(Cumulative Incidence, CI)**

åœ¨å›ºå®šéšè®¿æœŸå†…,æ–°å‘ç—…ä¾‹å åˆå§‹äººç¾¤çš„æ¯”ä¾‹:

$$CI = \frac{\text{æ–°å‘ç—…ä¾‹æ•°}}{\text{åˆå§‹æš´éœ²äººæ•°}} \times 100\%$$

**å‘ç—…å¯†åº¦(Incidence Density, ID)**

è€ƒè™‘ä¸åŒéšè®¿æ—¶é—´çš„å‘ç—…ç‡:

$$ID = \frac{\text{æ–°å‘ç—…ä¾‹æ•°}}{\text{æ€»äººå¹´}} \times 1000$$

**ç›¸å¯¹å±é™©åº¦(Relative Risk, RR)**

æš´éœ²ç»„ä¸éæš´éœ²ç»„å‘ç—…ç‡çš„æ¯”å€¼:

$$RR = \frac{I_{\text{exposed}}}{I_{\text{unexposed}}}$$

**é£é™©æ¯”(Hazard Ratio, HR)**

Coxå›å½’æ¨¡å‹ä¸­çš„æ•ˆåº”é‡,ç±»ä¼¼äºRRä½†è€ƒè™‘æ—¶é—´:

$$h(t|X) = h_0(t) \exp(\beta X)$$

å…¶ä¸­ $HR = \exp(\beta)$ã€‚

### é˜Ÿåˆ—ç ”ç©¶çš„æ ¸å¿ƒç‰¹å¾

**1. æ˜ç¡®çš„æ—¶é—´é¡ºåº**

```
æ—¶é—´è½´: 
åŸºçº¿      â”‚â”€â”€â”€â”€éšè®¿â”€â”€â”€â”€â”‚â”€â”€â”€â”€éšè®¿â”€â”€â”€â”€â”‚â”€â”€â”€â”€éšè®¿â”€â”€â”€â”€â”‚
æµ‹é‡E     â”‚  è§‚å¯ŸD    â”‚  è§‚å¯ŸD    â”‚  è§‚å¯ŸD    â”‚
t=0       t=1         t=2         t=3
```

**2. å¤±è®¿å¤„ç†**

å¤±è®¿(Lost to Follow-up)æ˜¯é˜Ÿåˆ—ç ”ç©¶çš„ä¸»è¦æŒ‘æˆ˜:

- **éšæœºå¤±è®¿**:ä¸å½±å“ç»“æœä¼°è®¡
- **ééšæœºå¤±è®¿**:å¯èƒ½å¯¼è‡´åå€š

**åº”å¯¹ç­–ç•¥**:
- æœ€å°åŒ–å¤±è®¿:ä¿æŒè”ç³»ã€æä¾›æ¿€åŠ±
- åˆ†ææ—¶æ•æ„Ÿæ€§åˆ†æ
- ä½¿ç”¨é€†æ¦‚ç‡åŠ æƒ(IPW)

**3. æ··æ‚æ§åˆ¶**

é˜Ÿåˆ—ç ”ç©¶çš„æ··æ‚æ§åˆ¶ç­–ç•¥:

- **è®¾è®¡é˜¶æ®µ**:é™åˆ¶ã€åŒ¹é…
- **åˆ†æé˜¶æ®µ**:åˆ†å±‚ã€å›å½’è°ƒæ•´ã€å€¾å‘è¯„åˆ†

## æ¨¡å‹å‡è®¾ä¸å‰ææ¡ä»¶

### å‡è®¾1:æš´éœ²æµ‹é‡å‡†ç¡®

**å«ä¹‰**:åŸºçº¿æš´éœ²æµ‹é‡æ— è¯¯

**è¿èƒŒåæœ**:
- æš´éœ²é”™åˆ†å¯¼è‡´æ•ˆåº”ä¼°è®¡æœ‰å
- éå·®å¼‚æ€§é”™åˆ†:ç¨€é‡Šå…³è”

**åº”å¯¹ç­–ç•¥**:
- ä½¿ç”¨å®¢è§‚æµ‹é‡(ç”Ÿç‰©æ ‡å¿—ç‰©)
- é‡å¤æµ‹é‡

### å‡è®¾2:ç»“å±€ç‹¬ç«‹äºå¤±è®¿

**å«ä¹‰**:å¤±è®¿ä¸ç»“å±€æ— å…³

**æ£€éªŒæ–¹æ³•**:
- æ¯”è¾ƒå¤±è®¿è€…ä¸å®Œæˆéšè®¿è€…çš„åŸºçº¿ç‰¹å¾
- æ•æ„Ÿæ€§åˆ†æ

**è¿èƒŒåæœ**:é€‰æ‹©åå€š

**åº”å¯¹ç­–ç•¥**:
- æé«˜éšè®¿å®Œæˆç‡(>80%)
- IPWåŠ æƒ

### å‡è®¾3:æ— ç«äº‰é£é™©

**å«ä¹‰**:å…¶ä»–äº‹ä»¶ä¸ä¼šé˜»æ­¢ç ”ç©¶ç»“å±€å‘ç”Ÿ

**è¿èƒŒåæœ**:é«˜ä¼°æˆ–ä½ä¼°å‘ç—…ç‡

**åº”å¯¹ç­–ç•¥**:ç«äº‰é£é™©åˆ†æ(Fine-Grayæ¨¡å‹)

## æ•°æ®å‡†å¤‡

### æ•°æ®ç»“æ„è¦æ±‚

é˜Ÿåˆ—ç ”ç©¶æ•°æ®é€šå¸¸åŒ…å«:

```
ID | Exposure | Start | Stop | Event | Age | Gender | ...
1  |    1     |   0   | 5.2  |   1   | 45  |   0    | ...
2  |    0     |   0   | 10.0 |   0   | 52  |   1    | ...
```

- `Start`:è¿›å…¥ç ”ç©¶æ—¶é—´
- `Stop`:ç»“å±€å‘ç”Ÿæˆ–åˆ å¤±æ—¶é—´
- `Event`:1=å‘ç”Ÿç»“å±€,0=åˆ å¤±

### æ¨¡æ‹Ÿé˜Ÿåˆ—æ•°æ®

```{r simulate-cohort}
set.seed(2026)
library(tidyverse)
library(survival)

n <- 500

# åŸºçº¿ç‰¹å¾
cohort_data <- data.frame(
  id = 1:n,
  age = rnorm(n, mean = 50, sd = 10),
  gender = rbinom(n, 1, 0.5),
  bmi = rnorm(n, mean = 24, sd = 3)
)

# æš´éœ²
prob_exposure <- plogis(-1 + 0.01 * cohort_data$age + 0.3 * cohort_data$gender)
cohort_data$exposure <- rbinom(n, 1, prob_exposure)

# ç”Ÿæˆç”Ÿå­˜æ—¶é—´(Weibullåˆ†å¸ƒ)
lambda <- exp(
  -3 +
  0.5 * cohort_data$exposure +      # æš´éœ²HR=1.65
  0.03 * cohort_data$age +          # å¹´é¾„HR=1.03
  0.2 * cohort_data$gender          # æ€§åˆ«HR=1.22
)

cohort_data$time <- rweibull(n, shape = 1.5, scale = 1 / lambda)

# åˆ å¤±(éšæœºåˆ å¤±,åˆ å¤±ç‡çº¦30%)
censoring_time <- runif(n, min = 5, max = 15)
cohort_data$event <- ifelse(cohort_data$time < censoring_time, 1, 0)
cohort_data$time <- pmin(cohort_data$time, censoring_time)

# è½¬æ¢ä¸ºå› å­
cohort_data <- cohort_data |>
  mutate(
    exposure_f = factor(exposure, levels = 0:1, labels = c("æœªæš´éœ²", "æš´éœ²")),
    gender_f = factor(gender, levels = 0:1, labels = c("å¥³", "ç”·")),
    event_f = factor(event, levels = 0:1, labels = c("åˆ å¤±", "äº‹ä»¶"))
  )

head(cohort_data)
```

## å®Œæ•´åˆ†ææµç¨‹

### æ­¥éª¤1:æè¿°æ€§ç»Ÿè®¡

```{r descriptive}
library(gtsummary)

cohort_data |>
  select(age, gender_f, bmi, exposure_f, event_f, time) |>
  tbl_summary(
    by = exposure_f,
    statistic = list(
      all_continuous() ~ "{mean} ({sd})",
      all_categorical() ~ "{n} ({p}%)"
    ),
    label = list(
      age ~ "å¹´é¾„",
      gender_f ~ "æ€§åˆ«",
      bmi ~ "BMI",
      event_f ~ "ç»“å±€",
      time ~ "éšè®¿æ—¶é—´(å¹´)"
    )
  ) |>
  add_p() |>
  add_overall()
```

### æ­¥éª¤2:è®¡ç®—å‘ç—…ç‡

```{r incidence-rate}
# è®¡ç®—äººå¹´å’Œå‘ç—…ç‡
incidence_summary <- cohort_data |>
  group_by(exposure_f) |>
  summarise(
    n = n(),
    events = sum(event),
    person_years = sum(time),
    incidence_rate = events / person_years * 1000,
    ci_lower = (qchisq(0.025, 2 * events) / 2) / person_years * 1000,
    ci_upper = (qchisq(0.975, 2 * (events + 1)) / 2) / person_years * 1000
  )

print(incidence_summary)
```

**å‘ç—…ç‡å¯è§†åŒ–**:

```{r incidence-plot}
ggplot(incidence_summary, aes(x = exposure_f, y = incidence_rate, fill = exposure_f)) +
  geom_col(width = 0.6) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
  geom_text(aes(label = round(incidence_rate, 1)), vjust = -0.5) +
  scale_fill_manual(values = c("#3b82f6", "#ef4444")) +
  labs(
    title = "æŒ‰æš´éœ²åˆ†å±‚çš„å‘ç—…ç‡",
    x = "æš´éœ²çŠ¶æ€",
    y = "å‘ç—…ç‡ (æ¯1000äººå¹´)"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
```

### æ­¥éª¤3:è®¡ç®—ç›¸å¯¹å±é™©åº¦(RR)

```{r rr-calculation}
# ç®€å•RRè®¡ç®—
rr <- incidence_summary$incidence_rate[2] / incidence_summary$incidence_rate[1]
cat("ç²—RR:", round(rr, 2))
```

### æ­¥éª¤4:Kaplan-Meierç”Ÿå­˜æ›²çº¿

```{r km-curve}
library(survminer)

# æ‹ŸåˆKMæ›²çº¿
km_fit <- survfit(Surv(time, event) ~ exposure_f, data = cohort_data)

# å¯è§†åŒ–
ggsurvplot(
  km_fit,
  data = cohort_data,
  pval = TRUE,
  risk.table = TRUE,
  conf.int = TRUE,
  palette = c("#3b82f6", "#ef4444"),
  title = "æŒ‰æš´éœ²åˆ†å±‚çš„Kaplan-Meierç”Ÿå­˜æ›²çº¿",
  xlab = "éšè®¿æ—¶é—´(å¹´)",
  ylab = "æ— äº‹ä»¶ç”Ÿå­˜æ¦‚ç‡",
  legend.title = "æš´éœ²çŠ¶æ€",
  legend.labs = c("æœªæš´éœ²", "æš´éœ²")
)
```

### æ­¥éª¤5:Coxæ¯”ä¾‹é£é™©å›å½’

```{r cox-regression}
# å•å› ç´ Coxå›å½’
cox_uni <- coxph(Surv(time, event) ~ exposure, data = cohort_data)
summary(cox_uni)

# å¤šå› ç´ Coxå›å½’
cox_multi <- coxph(
  Surv(time, event) ~ exposure + age + gender + bmi,
  data = cohort_data
)

# ä¸“ä¸šè¡¨æ ¼è¾“å‡º
tbl_regression(
  cox_multi,
  exponentiate = TRUE,
  label = list(
    exposure ~ "æš´éœ²",
    age ~ "å¹´é¾„",
    gender ~ "æ€§åˆ«(ç”·vså¥³)",
    bmi ~ "BMI"
  )
)
```

### æ­¥éª¤6:Coxå‡è®¾æ£€éªŒ

```{r cox-ph-test}
# æ£€éªŒæ¯”ä¾‹é£é™©å‡è®¾
ph_test <- cox.zph(cox_multi)
print(ph_test)

# å¯è§†åŒ–
plot(ph_test)
```

å¦‚æœp<0.05,è¯´æ˜è¿åPHå‡è®¾,éœ€è¦:
- åˆ†å±‚Coxæ¨¡å‹
- æ—¶é—´ä¾èµ–åå˜é‡

## ç»“æœè§£è¯»ä¸æŠ¥å‘Š

### STROBEæŠ¥å‘Šæ¸…å•(é˜Ÿåˆ—ç ”ç©¶)

- [ ] é¢˜ç›®/æ‘˜è¦ä¸­æ ‡æ˜"é˜Ÿåˆ—ç ”ç©¶"
- [ ] åŸºçº¿äººç¾¤ç‰¹å¾
- [ ] æš´éœ²å®šä¹‰å’Œæµ‹é‡æ–¹æ³•
- [ ] éšè®¿æ—¶é—´å’Œå¤±è®¿ç‡
- [ ] ä¸»è¦ç»“æœ:å‘ç—…ç‡ã€RR/HRåŠ95%CI
- [ ] è°ƒæ•´æ··æ‚å› ç´ çš„æ¨¡å‹
- [ ] æ•æ„Ÿæ€§åˆ†æ

### è®ºæ–‡æŠ¥å‘Šç¤ºä¾‹

> æœ¬å‰ç»æ€§é˜Ÿåˆ—ç ”ç©¶å…±çº³å…¥500åæˆå¹´äºº,å¹³å‡éšè®¿X.Xå¹´(IQR: X.X-X.X)ã€‚æš´éœ²ç»„å‘ç—…ç‡ä¸ºX.X/1000äººå¹´(95%CI: X.X-X.X),éæš´éœ²ç»„ä¸ºX.X/1000äººå¹´(95%CI: X.X-X.X)ã€‚
>
> å•å› ç´ åˆ†ææ˜¾ç¤º,æš´éœ²ä¸ç»“å±€é£é™©å‡é«˜ç›¸å…³(HR=X.XX, 95%CI: X.XX-X.XX)ã€‚è°ƒæ•´å¹´é¾„ã€æ€§åˆ«ã€BMIå,å…³è”ä»æ˜¾è‘—(è°ƒæ•´åHR=X.XX, 95%CI: X.XX-X.XX),è¡¨æ˜æš´éœ²è€…çš„é£é™©æ˜¯éæš´éœ²è€…çš„X.XXå€ã€‚

## å¸¸è§é”™è¯¯ä¸çº å

### é”™è¯¯1:å¿½è§†å¤±è®¿åå€š

**é”™è¯¯åšæ³•**:ç›´æ¥åˆ é™¤å¤±è®¿å¯¹è±¡

**æ­£ç¡®åšæ³•**:
- æŠ¥å‘Šå¤±è®¿ç‡
- æ¯”è¾ƒå¤±è®¿è€…ä¸å®Œæˆè€…çš„åŸºçº¿ç‰¹å¾
- æ•æ„Ÿæ€§åˆ†æ

### é”™è¯¯2:è¿åPHå‡è®¾

**é”™è¯¯åšæ³•**:å¿½è§†cox.zph()çš„è­¦å‘Š

**æ­£ç¡®åšæ³•**:
- ä½¿ç”¨åˆ†å±‚Coxæ¨¡å‹
- æ—¶é—´ä¾èµ–åå˜é‡

### é”™è¯¯3:æ··æ·†RRä¸HR

**RR**:ç´¯ç§¯å‘ç—…ç‡ä¹‹æ¯”
**HR**:ç¬æ—¶é£é™©ä¹‹æ¯”

å½“éšè®¿æ—¶é—´å›ºå®š,ä¸¤è€…æ¥è¿‘ã€‚

## è¿›é˜¶æ‰©å±•

### ç«äº‰é£é™©åˆ†æ

å½“å­˜åœ¨ç«äº‰äº‹ä»¶æ—¶:

```{r competing-risk, eval=FALSE}
library(cmprsk)

# Fine-Grayæ¨¡å‹
fg_fit <- crr(
  ftime = cohort_data$time,
  fstatus = cohort_data$event_type,  # 1=ç›®æ ‡äº‹ä»¶,2=ç«äº‰äº‹ä»¶
  cov1 = model.matrix(~ exposure + age + gender, data = cohort_data)[, -1]
)
```

### å€¾å‘è¯„åˆ†åŠ æƒ

```{r ps-weighting, eval=FALSE}
library(WeightIt)

ps_weights <- weightit(
  exposure ~ age + gender + bmi,
  data = cohort_data,
  method = "ps",
  estimand = "ATE"
)

# åŠ æƒCoxæ¨¡å‹
weighted_cox <- coxph(
  Surv(time, event) ~ exposure,
  data = cohort_data,
  weights = ps_weights$weights
)
```

## æ€»ç»“

**é˜Ÿåˆ—ç ”ç©¶çš„ä¼˜åŠ¿**:
1. æ—¶é—´é¡ºåºæ˜ç¡®,å› æœæ¨æ–­èƒ½åŠ›å¼º
2. å¯è®¡ç®—å‘ç—…ç‡å’ŒRR
3. å¯ç ”ç©¶å¤šç§ç»“å±€

**å±€é™æ€§**:
1. æˆæœ¬é«˜ã€å‘¨æœŸé•¿
2. å¤±è®¿åå€š
3. ä¸é€‚åˆç½•è§ç—…

**åˆ†æè¦ç‚¹**:
1. è®¡ç®—äººå¹´å’Œå‘ç—…ç‡
2. KMæ›²çº¿å¯è§†åŒ–
3. Coxå›å½’ä¼°è®¡HR
4. æ£€éªŒPHå‡è®¾

## å‚è€ƒæ–‡çŒ®

1. Rothman KJ, et al. *Modern Epidemiology*. 3rd ed. 2008.
2. Therneau TM, Grambsch PM. *Modeling Survival Data*. 2000.
3. Vandenbroucke JP, et al. STROBE Statement. *PLoS Med*. 2007.
4. Fine JP, Gray RJ. A Proportional Hazards Model for the Subdistribution of a Competing Risk. *JASA*. 1999.
