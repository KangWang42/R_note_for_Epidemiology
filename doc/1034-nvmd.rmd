---
title: "变分模态分解 (VMD) 信号处理指南"
date: "2026-01-13"
categories: [R包, 信号处理, 时间序列]

description: "处理非线性非平稳信号的利器：完全非递归的 VMD 分解算法 R 语言实现。"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    warning = FALSE,
    message = FALSE,
    fig.width = 10,
    fig.height = 7,
    dpi = 300
)
```

## 1. VMD vs EMD：为什么要用 VMD？

在处理生物医学信号（EEG, ECG）或金融时间序列时，我们经常遇到**非平稳**和**非线性**信号。

-   **EMD (经验模态分解)**：经典方法，但由递归筛选过程决定，容易受到噪声干扰（“模态混叠”）。
-   **VMD (变分模态分解)**：基于坚实的数学理论（维纳滤波、希尔伯特变换）。它将分解问题构建为一个约束变分问题，**完全非递归**，抗噪性强，能有效分离频率接近的成分。

## 2. 工具：VMDecomp

```{r eval=FALSE}
# 由于不在 CRAN，需从 GitHub 安装
install.packages("devtools")
devtools::install_github("lampros-mouselimis/VMDecomp")
```

```{r}
library(VMDecomp)
library(ggplot2)
```

## 3. 构造仿真信号

为了验证 VMD 的能力，我们构造一个已知成分的信号：
$$ S(t) = S_{low}(10Hz) + S_{mid}(50Hz) + S_{high}(100Hz) + Noise $$

```{r}
# 采样频率
fs <- 1000
t <- seq(0, 1, length.out = fs)

# 频率分量
f1 <- 10 # 低频
f2 <- 50 # 中频
f3 <- 100 # 高频

# 构造信号 (正弦波叠加 + 高斯白噪声)
set.seed(123)
sig <- 2 * sin(2 * pi * f1 * t) +
    1.5 * sin(2 * pi * f2 * t) +
    1 * sin(2 * pi * f3 * t) +
    rnorm(length(t), 0, 0.5) # 噪声

# 绘制原始信号
plot(t, sig,
    type = "l", col = "darkgrey",
    main = "Raw Synthetic Signal (with Noise)", xlab = "Time (s)", ylab = "Amplitude"
)
```

## 4. 参数设置与分解

VMD 需要预先设定几个关键参数，其中最重要的是 **K (模态数)** 和 **alpha (带宽限制)**。

-   **alpha**: 越小带宽越大，越大带宽越窄。
-   **K**: 预期的成分数量。

```{r}
# VMD 参数
alpha <- 2000 # 适中的带宽限制
tau <- 0 # 噪声容限 (0 表示无严格去噪，或依靠 alpha)
K <- 3 # 我们知道有 3 个主要成分
DC <- FALSE # 无直流偏移
init <- 1 # 初始化模式 (1 = 均匀分布)
tol <- 1e-6 # 收敛容差

# 执行分解
# 输出结果包含了分解出的模态 (u) 和中心频率 (omega) 等
vmd_res <- VMDecomp::vmd(sig, alpha, tau, K, DC, init, tol)

# 提取模态分量矩阵 (K 行 x N 列)
imfs <- vmd_res$u
```

## 5. 结果可视化与验证

我们将分解出的 3 个 IMF 分量与原始信号的真实成分进行对比。

```{r fig.height=10}
par(mfrow = c(4, 1), mar = c(2, 4, 2, 1))

# 原始信号
plot(t, sig, type = "l", main = "Original Noisy Signal", col = "gray")

# 分解出的 IMF 1 (对应低频 10Hz)
plot(t, imfs[, 1],
    type = "l", col = "blue", lwd = 1.5,
    main = "IMF 1 (Extracted Low Freq)"
)

# 分解出的 IMF 2 (对应中频 50Hz)
plot(t, imfs[, 2],
    type = "l", col = "green", lwd = 1.5,
    main = "IMF 2 (Extracted Mid Freq)"
)

# 分解出的 IMF 3 (对应高频 100Hz)
plot(t, imfs[, 3],
    type = "l", col = "red", lwd = 1.5,
    main = "IMF 3 (Extracted High Freq)"
)
```

**观察**:
即使存在噪声，VMD 也能非常干净地还原出原始的 10Hz, 50Hz, 100Hz 正弦波，表现优于许多传统滤波器。

## 参考文献

-   Dragomiretskiy, K., & Zosso, D. (2014). Variational Mode Decomposition. *IEEE Transactions on Signal Processing*, 62(3), 531-544.
